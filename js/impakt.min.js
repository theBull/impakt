var Common;!function(a){var b;!function(b){var c=function(){function b(){this.guid=a.Utilities.guid()}return b.prototype.toJson=function(){return{guid:this.guid}},b.prototype.fromJson=function(a){a&&(this.guid=a.guid)},b}();b.Storable=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},Common;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this.lastModified=Date.now(),this.modified=!1,this.checksum=null,this.original=null,this.listening=!0,this.callbacks=[],this.listeners={onready:[],onload:[]},this.isContextSet=!1}return __extends(c,b),c.prototype.checkContextSet=function(){if(!this.context||!this.isContextSet)throw new Error("Modifiable: context is not set. Call setContext(context) before using this class")},c.prototype.setContext=function(a){this.context=a,this.isContextSet=!0},c.prototype.listen=function(a){return this.listening=a,this},c.prototype.setListener=function(a,b,c){this.listeners.hasOwnProperty(a)||(this.listeners[a]=[]),this.listeners[a].push({callback:b,persist:c===!0})},c.prototype.hasListeners=function(){return a.Utilities.isNotNullOrUndefined(this.callbacks)&&this.callbacks.length>0},c.prototype.clearListeners=function(){this.callbacks=[]},c.prototype.invokeListener=function(a,b){if(this.listeners[a])for(var c=this.listeners[a],d=0;d<c.length;){var e=c[d];if(e){var f=e.callback;f&&(f(b,this.context),e.persist===!1?c.splice(d,1):d++)}}},c.prototype.onModified=function(a){this.listening&&this.callbacks.push(a)},c.prototype.isModified=function(){if(this.listening){this.modified=!0,this.lastModified=Date.now();for(var a=0;a<this.callbacks.length;a++){var b=this.callbacks[a];b(this.context)}}},c.prototype.setModified=function(a){if(!this.listening)return this.modified=!1,!1;var b=this.generateChecksum();return a||b!==this.checksum?this.isModified():this.modified=!1,this.checksum=b,this.modified},c.prototype.generateChecksum=function(){this.checkContextSet();var b=this.context.toJson();return a.Utilities.generateChecksum(b)},c.prototype.copy=function(a,b){this.checkContextSet();var c=b.toJson();return a.fromJson(c),a.setModified(!0),a},c.prototype.toJson=function(){return $.extend({lastModified:this.lastModified,checksum:this.checksum},b.prototype.toJson.call(this))},c.prototype.fromJson=function(c){for(var d=[],e=1;e<arguments.length;e++)d[e-1]=arguments[e];this.lastModified=c.lastModified,this.original=c.checksum,this.checksum=a.Utilities.generateChecksum(this.toJson()),b.prototype.fromJson.call(this,c)},c}(a.Models.Storable);b.Modifiable=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){if(a.Utilities.isNotNullOrUndefined(c)&&0>c)throw new Error("Collection constructor(): Cannot create a collection with size < 0");b.call(this),b.prototype.setContext.call(this,this),this._count=0,this._keys=new Array(c||0)}return __extends(c,b),c.prototype.copy=function(c){var d=c||new a.Models.Collection;return b.prototype.copy.call(this,d,this)},c.prototype._getKey=function(a){return a&&a.guid?a.guid:void console.error("Object does not have a guid")},c.prototype._ensureKeyType=function(a){if("string"==typeof a){var b=a.toString(),c=parseInt(b);a=isNaN(c)||b.indexOf("-")>-1?b:c}return a},c.prototype.size=function(){return this._count},c.prototype.isEmpty=function(){return 0==this.size()},c.prototype.hasElements=function(){return this.size()>0},c.prototype.exists=function(a){return this.contains(a)},c.prototype.first=function(){return this.getOne()},c.prototype.indexOf=function(a){return this._keys.indexOf(a)},c.prototype.isLast=function(a){return this.indexOf(a)==this.size()-1},c.prototype.isFirst=function(a){return 0==this.indexOf(a)},c.prototype.get=function(a){return a=this._ensureKeyType(a),this[a]},c.prototype.getNext=function(a){var b=null;return this.hasElements()&&(b=this.isLast(a)?this.getLast():this.getIndex(this.indexOf(a)+1)),b},c.prototype.getPrevious=function(a){var b=null;return this.hasElements()&&(this.isFirst(a)||(b=this.getIndex(this.indexOf(a)-1))),b},c.prototype.getOne=function(){return this[this._keys[0]]},c.prototype.getIndex=function(a){return this.get(this._keys[a])},c.prototype.getAll=function(){for(var a={},b=0;b<this._keys.length;b++){var c=this._keys[b];a[c]=this.get(c)}return a},c.prototype.getLast=function(){var a=this._keys[this._keys.length-1];return this.get(a)},c.prototype.set=function(a,b,c){if(!this.hasOwnProperty(a.toString()))throw Error("Object does not have key "+a+". Use the add(key) method.");this[a]=b;var d=this;b.onModified(function(){d.setModified(!0)}),c!==!1&&this.setModified(!0)},c.prototype.replace=function(a,b){var c=this._getKey(b);this._keys[this._keys.indexOf(a)]=c,this[c]=b,delete this[a];var d=this;b.onModified(function(){d.setModified(!0)}),this.setModified(!0)},c.prototype.setAtIndex=function(b,c){if(0>b||b>this._count-1)throw new Error("Collection setAtIndex(): index is out of bounds; "+b);var d=this._keys[b];return a.Utilities.isNullOrUndefined(d)?null:void this.set(d,c)},c.prototype.add=function(a,b){var c=this._getKey(a);if(this[c]&&this._keys.indexOf(c)>-1)this.set(c,a,b);else{this[c]=a,this._keys[this._count]=c,this._count++;var d=this;a.onModified(function(a){d.setModified(!0)}),b!==!1&&this.setModified(!0)}},c.prototype.addAll=function(a){if(a&&!(a.length<1)){for(var b=0;b<a.length;b++){var c=a[b];c&&this.add(c,!1)}this.setModified(!0)}},c.prototype.addAtIndex=function(a,b){var c=this._getKey(a),d=this._keys.indexOf(c)>-1;if(d&&this._keys.indexOf(c)!=b){var e=this._keys.indexOf(c);throw new Error(["The element you want to add at this"," index already exists at index (",e,"). Ignoring for now..."].join(""))}if(this[c]=a,this._keys[b]=c,!d){this._count++;var f=this;a.onModified(function(){f.setModified(!0)}),this.setModified(!0)}},c.prototype.only=function(a){this.removeAll(),this.add(a)},c.prototype.append=function(a){var b=this;a.forEach(function(a,c){if(!a||!a.guid)throw new Error("item is null or does not have guid");this.clearListeners&&a.clearListeners(),b.add(a)})},c.prototype.forEach=function(a){if(this._keys)for(var b=0;b<this._keys.length;b++){var c=this._keys[b];a(this[c],b)}},c.prototype.hasElementWhich=function(a){return null!=this.filterFirst(a)},c.prototype.filter=function(a){var b=[];return this.forEach(function(c,d){a(c)&&b.push(c)}),b},c.prototype.filterFirst=function(a){var b=this.filter(a);return b&&b.length>0?b[0]:null},c.prototype.filterCollection=function(b){if(!a.Utilities.isNullOrUndefined(b)){var c=new a.Models.Collection,d=[];if(this.forEach(function(a,c){for(var e in b){var f=!1;if(typeof a[e]==typeof b[e])switch(typeof a[e]){case"string":f=a[e].indexOf(b[e])>-1;break;case"number":f=a[e]===b[e]}if(f)return void d.push(a.guid)}}),a.Utilities.isNotNullOrUndefined(d)&&d.length>0)for(var e=0;e<d.length;e++)c.add(this.get(d[e]),!1);return c}},c.prototype.remove=function(a,b){if(!this[a])return void console.warn("Collection remove(): Tried to remove item, 					but item with guid does not exist: ",a);var c=this[a];return delete this[a],this._keys.splice(this._keys.indexOf(a),1),this._count--,b!==!1&&this.setModified(!0),c},c.prototype.pop=function(){var a=this._keys[this._count-1];return this.remove(a)},c.prototype.empty=function(a){this.removeAll(a)},c.prototype.removeAll=function(a){for(;this._count>0;){var b=this._keys[0];this.remove(b,a)}},c.prototype.removeEach=function(a,b){this.forEach(a),this.removeAll(b)},c.prototype.removeWhere=function(b,c){for(var d=this.filter(b),e=0;e<d.length;e++){var f=d[e];a.Utilities.isNotNullOrUndefined(f)&&f.guid&&this.remove(f.guid,c)}},c.prototype.contains=function(a){return null!=this[a]&&void 0!=this[a]},c.prototype.toArray=function(){for(var a=[],b=0;b<this._keys.length;b++)a.push(this.get(this._keys[b]));return a},c.prototype.toJson=function(){var a=[];return this.forEach(function(b,c){a.push(b?b.toJson():null)}),a},c.prototype.getGuids=function(){return this._keys},c}(a.Models.Modifiable);b.Collection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this.root=null,this.last=null,this._length=0,this._modifiable=new a.Models.Modifiable,this._modifiable.setContext(this),this.callbacks=this._modifiable.callbacks,this.modified=this._modifiable.modified,this.checksum=this._modifiable.checksum,this.original=this._modifiable.original,this.lastModified=this._modifiable.lastModified,this.context=this._modifiable.context,this.isContextSet=this._modifiable.isContextSet,this.listening=this._modifiable.listening}return __extends(c,b),c.prototype.setModified=function(a){var b=this._modifiable.setModified(a===!0);return this.modified=this._modifiable.modified,this.checksum=this._modifiable.checksum,this.lastModified=this._modifiable.lastModified,b},c.prototype.onModified=function(b){var c=this;this._modifiable.onModified(b),this.forEach(function(b,d){a.Utilities.isNullOrUndefined(b)||b.onModified(function(){c.setModified(!0)})})},c.prototype.isModified=function(){this._modifiable.isModified(),this.lastModified=this._modifiable.lastModified},c.prototype.listen=function(a){return this._modifiable.listening=a,this.listening=a,this},c.prototype.add=function(a,b){if(this.root){for(var c=this.root;null!=c.next;)c=c.next;a.prev=c,c.next=a}else this.root=a,this.root.prev=null;this.last=a,this._length++;var d=this;a.onModified(function(){d.setModified(!0)}),b!==!1&&this.setModified(!0)},c.prototype.getIndex=function(a){var b=0,c=this.root;if(!c)return null;for(;c;){if(b==a)return c;if(!c.next)return null;c=c.next,b++}},c.prototype.first=function(){return this.root},c.prototype.forEach=function(a){var b=0,c=this.root;if(a(c,b),c)for(;null!=c.next;)c=c.next,b++,a(c,b)},c.prototype.toJson=function(){var a=[];return this.forEach(function(b,c){b&&b.toJson&&a.push(b.toJson())}),a},c.prototype.toArray=function(){var a=Array();return this.forEach(function(b,c){a.push(b)}),a},c.prototype.getLast=function(){return this.last},c.prototype.getRoot=function(){return this.root},c.prototype.remove=function(a){},c.prototype.size=function(){return this._length},c.prototype.hasElements=function(){return this.size()>0},c.prototype.isEmpty=function(){return!this.hasElements()},c}(a.Models.Storable);b.LinkedList=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(){function b(b){this._modifiable=new a.Models.Modifiable,this._modifiable.setContext(this),this.callbacks=this._modifiable.callbacks,this.modified=this._modifiable.modified,this.lastModified=this._modifiable.lastModified,this.original=this._modifiable.original,this.checksum=this._modifiable.checksum,this.context=this._modifiable.context,this.isContextSet=this._modifiable.isContextSet,this.listening=this._modifiable.listening,this._collection=new a.Models.Collection(b),this.guid=this._modifiable.guid}return b.prototype.setModified=function(a){var b=this._modifiable.setModified(a===!0);return this.modified=this._modifiable.modified,this.checksum=this._modifiable.checksum,this.lastModified=this._modifiable.lastModified,b},b.prototype.onModified=function(b){var c=this;this._modifiable.onModified(b),this._collection.forEach(function(b,d){a.Utilities.isNullOrUndefined(b)||b.onModified(function(){c.isModified()})})},b.prototype.isModified=function(){this._modifiable.isModified(),this.lastModified=this._modifiable.lastModified},b.prototype.listen=function(a){return this._modifiable.listening=a,this.listening=a,this},b.prototype.size=function(){return this._collection.size()},b.prototype.isEmpty=function(){return this._collection.isEmpty()},b.prototype.hasElements=function(){return this._collection.hasElements()},b.prototype.exists=function(a){return this._collection.exists(a)},b.prototype.get=function(a){return this._collection.get(a)},b.prototype.first=function(){return this._collection.first()},b.prototype.getOne=function(){return this._collection.getOne()},b.prototype.getIndex=function(a){return this._collection.getIndex(a)},b.prototype.set=function(a,b){this._collection.set(a,b);var c=this;return b.onModified(function(){c.setModified(!0)}),this.setModified(!0),this},b.prototype.replace=function(a,b){this._collection.replace(a,b);var c=this;return b.onModified(function(){c.setModified(!0)}),this.setModified(!0),this},b.prototype.setAtIndex=function(a,b){this._collection.setAtIndex(a,b);var c=this;return b.onModified(function(){c.setModified(!0)}),this.setModified(!0),this},b.prototype.add=function(a){this._collection.add(a);var b=this;return a.onModified(function(){b.setModified(!0)}),this.setModified(!0),this},b.prototype.addAll=function(a){if(!a||0==a.length)return this;this._collection.addAll(a);for(var b=this,c=0;c<a.length;c++){var d=a[c];d.onModified(function(){b.setModified(!0)})}return this.setModified(!0),this},b.prototype.addAtIndex=function(a,b){this._collection.addAtIndex(a,b);var c=this;return a.onModified(function(){c.setModified(!0)}),this.setModified(!0),this},b.prototype.only=function(a){this._collection.only(a);var b=this;return a.onModified(function(){b.setModified(!0)}),this.setModified(!0),this},b.prototype.append=function(a,b){this._collection.append(a);var c=this;return a.forEach(function(a,d){b&&a.clearListeners(),a.onModified(function(){c.setModified(!0)})}),this.setModified(!0),this},b.prototype.forEach=function(a){this._collection.forEach(a)},b.prototype.hasElementWhich=function(a){return this._collection.hasElementWhich(a)},b.prototype.filter=function(a){return this._collection.filter(a)},b.prototype.filterFirst=function(a){return this._collection.filterFirst(a)},b.prototype.remove=function(a){var b=this._collection.remove(a);return this.setModified(!0),b},b.prototype.removeAll=function(){this._collection.removeAll(),this.setModified(!0)},b.prototype.empty=function(){this.removeAll()},b.prototype.removeEach=function(a){this._collection.removeEach(a),this.setModified(!0)},b.prototype.contains=function(a){return this._collection.contains(a)},b.prototype.getAll=function(){return this._collection.getAll()},b.prototype.getLast=function(){return this._collection.getLast()},b.prototype.toArray=function(){return this._collection.toArray()},b.prototype.toJson=function(){return this._collection.toJson()},b.prototype.fromJson=function(a){a&&this._collection.fromJson(a._collection)},b.prototype.copy=function(a,b){return console.error("ModifiableCollection copy() not implemented"),null},b.prototype.getGuids=function(){return this._collection.getGuids()},b}();b.ModifiableCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(a){var b=function(){function a(){this.date=new Date,this.time=null,this.options={startingDay:1,showWeeks:!0},this.popup={opened:!1},this.format="MM/DD/YYYY"}return a.prototype.toJson=function(){return{date:this.date,time:this.time,meridian:this.meridian,timezone:this.timezone,format:this.format}},a.prototype.fromJson=function(a){a&&(this.date=new Date(a.date),this.time=a.time,this.meridian=a.meridian,this.timezone=a.timezone,this.format=a.format)},a.prototype.openPopup=function(){this.popup.opened=!0},a.prototype.closePopup=function(){this.popup.opened=!1},a.prototype.togglePopup=function(a){this.popup.opened=this.popup.opened&&a!==!0?this.closePopup():this.openPopup()},a.prototype.getFormatted=function(){return moment(this.date).format(this.format)},a}();a.Datetime=b}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.toJson=function(){return $.extend({data:"Data not yet supported."},a.prototype.toJson.call(this))},b.prototype.fromJson=function(a){},b}(a.Models.Storable);b.NotImplementedClass=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(a){var b=function(){function a(){}return a}();a.APIOptions=b}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){if(b.call(this),b.prototype.setContext.call(this,this),this.listen(!1),a.Utilities.isNullOrUndefined(c))throw new Error("Expandable constructor(): $element is null or undefined");this.$element=c,this.direction,this.min=3,this.max=32,this.em=parseInt($("body").css("font-size")),this.collapsed=!0,this.ready=!1,this.url=null,this.handle=new a.Models.ExpandableHandle,this.expandable=!0,this.$element.removeClass("width3"),this.openCallbacks=[],this.closeCallbacks=[]}return __extends(c,b),c.prototype.setHandleClass=function(){this.handle["class"]=this.collapsed?this.handle.collapsed:this.handle.expanded},c.prototype.getWidth=function(a){return this.em*a},c.prototype.getInitialWidth=function(){return this.collapsed?this.getWidth(this.min):this.getWidth(this.max)},c.prototype.getInitialClass=function(){return this.collapsed?this.getMinClass():this.getMaxClass()},c.prototype.toggle=function(){this.collapsed?this.open():this.close()},c.prototype.open=function(){this.collapsed=!1,this.expandable&&this.$element.removeClass(this.getMinClass()).addClass(this.getMaxClass()),this.setHandleClass();for(var a=0;a<this.openCallbacks.length;a++)this.openCallbacks[0]()},c.prototype.onopen=function(a){this.openCallbacks.push(a)},c.prototype.close=function(){this.collapsed=!0,this.expandable&&this.$element.removeClass(this.getMaxClass()).addClass(this.getMinClass()),this.setHandleClass();for(var a=0;a<this.closeCallbacks.length;a++)this.closeCallbacks[0]()},c.prototype.onclose=function(a){this.closeCallbacks.push(a)},c.prototype.getMinClass=function(){return"width"+this.min},c.prototype.getMaxClass=function(){return"width"+this.max},c.prototype.setInitialClass=function(){this.$element.addClass(this.getInitialClass())},c.prototype.initializeToggleHandle=function(){switch(this.direction){case"left":this.handle.position="top0 left0",this.handle.expanded="glyphicon-chevron-right",this.handle.collapsed="glyphicon-chevron-left";break;case"right":this.handle.position="top0 right0",this.handle.expanded="glyphicon-chevron-left",this.handle.collapsed="glyphicon-chevron-right";break;case"top":case"down":this.handle.position="top0 left0",this.handle.expanded="glyphicon-chevron-up",this.handle.collapsed="glyphicon-chevron-down";break;case"bottom":case"up":this.handle.position="bottom0 left0",this.handle.expanded="glyphicon-chevron-down",this.handle.collapsed="glyphicon-chevron-up"}this.setHandleClass()},c}(a.Models.Modifiable);b.Expandable=c;var d=function(){function a(){this.position="",this.collapsed="",this.expanded="",this["class"]=""}return a}();b.ExpandableHandle=d}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d){this.data=a,this.url=a.contextmenuTemplateUrl,this.pageX=b,this.pageY=c,this.message=d||"Contextmenu opened"}return a}();a.ContextmenuData=b}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(a){var b=function(){function a(){}return a}();a.ActionRegistry=b}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this),b.prototype.setContext.call(this,this),this.impaktDataType=a,this.disabled=!1,this.selected=!1,this.clickable=!0,this.hoverable=!0,this.hovered=!1,this.dragging=!1,this.draggable=!0,this.selectable=!0,this.flipped=!1,this.flippable=!1,this.visible=!0}return __extends(c,b),c.prototype.toJson=function(){return $.extend({graphics:this.hasGraphics()?this.graphics.toJson():null,disabled:this.disabled,selected:!1,clickable:this.clickable,hoverable:this.hoverable,hovered:this.hovered,dragging:this.dragging,draggable:this.draggable,selectable:this.selectable,flipped:this.flipped,flippable:this.flippable,visible:this.visible},b.prototype.toJson.call(this))},c.prototype.fromJson=function(c){c&&(this.disabled=a.Utilities.isNullOrUndefined(c.disabled)?!1:c.disabled,this.selected=a.Utilities.isNullOrUndefined(c.selected)?!1:c.selected,this.clickable=a.Utilities.isNullOrUndefined(c.clickable)?!0:c.clickable,this.hoverable=a.Utilities.isNullOrUndefined(c.hoverable)?!0:c.hoverable,this.hovered=a.Utilities.isNullOrUndefined(c.hovered)?!1:c.hovered,this.dragging=a.Utilities.isNullOrUndefined(c.dragging)?!1:c.dragging,this.draggable=a.Utilities.isNullOrUndefined(c.draggable)?!0:c.draggable,this.selectable=a.Utilities.isNullOrUndefined(c.selectable)?!0:c.selectable,this.flipped=a.Utilities.isNullOrUndefined(c.flipped)?!1:c.flipped,this.flippable=a.Utilities.isNullOrUndefined(c.flippable)?!1:c.flippable,this.visible=a.Utilities.isNullOrUndefined(c.visible)?!0:c.visible,b.prototype.fromJson.call(this,c))},c.prototype.hasGraphics=function(){return a.Utilities.isNotNullOrUndefined(this.graphics)},c.prototype.toggleOpacity=function(){this.disabled||this.selected||!this.hoverable||this.graphics.toggleOpacity()},c.prototype.isSelectable=function(){return!this.disabled&&this.selectable},c.prototype.toggleSelect=function(a){a=a===!0,this.isSelectable()&&(this.selected?this.deselect():this.select())},c.prototype.select=function(){this.isSelectable()&&(this.selected=!0,this.hasGraphics()&&this.graphics.select())},c.prototype.deselect=function(){this.isSelectable()&&(this.selected=!1,this.hasGraphics()&&this.graphics.deselect())},c.prototype.disable=function(){this.disabled=!0,this.hasGraphics()&&this.graphics.disable()},c.prototype.enable=function(){this.disabled=!1,this.hasGraphics()&&this.graphics.enable()},c.prototype.show=function(){this.visible=!0,this.hasGraphics()&&this.graphics.show()},c.prototype.hide=function(){this.visible=!1,this.hasGraphics()&&this.graphics.hide()},c.prototype.toggleVisibility=function(){this.visible?this.hide():this.show()},c.prototype.getContextmenuUrl=function(){return this.contextmenuTemplateUrl},c.prototype.drop=function(){this.dragging=!1,this.hasGraphics()&&this.graphics.drop()},c.prototype.onhover=function(a,b,c){this.hasGraphics()&&this.graphics.onhover(a,b,c)},c.prototype.hoverIn=function(a){this.hovered=!0,this.hasGraphics()&&this.graphics.hoverIn(a)},c.prototype.hoverOut=function(a){this.hovered=!1,this.hasGraphics()&&this.graphics.hoverOut(a)},c.prototype.onclick=function(a,b){this.hasGraphics()&&this.graphics.onclick(a,b)},c.prototype.click=function(a){this.hasGraphics()&&this.graphics.click(a)},c.prototype.oncontextmenu=function(a,b){this.hasGraphics()&&this.graphics.oncontextmenu(a,b)},c.prototype.contextmenu=function(a){this.hasGraphics()&&this.graphics.contextmenu(a)},c.prototype.onmousedown=function(a,b){this.hasGraphics()&&this.graphics.onmousedown(a,b)},c.prototype.onmouseup=function(a,b){this.hasGraphics()&&this.graphics.onmouseup(a,b)},c.prototype.mousedown=function(a){this.hasGraphics()&&this.graphics.mousedown(a)},c.prototype.onmousemove=function(a,b){this.hasGraphics()&&this.graphics.onmousemove(a,b)},c.prototype.mousemove=function(a){this.hasGraphics()&&this.graphics.mousemove(a)},c.prototype.ondrag=function(a,b,c,d){this.hasGraphics()&&this.graphics.ondrag(a,b,c,d)},c}(a.Models.Modifiable);b.Actionable=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.toJson=function(){return b.prototype.toJson.call(this)},c.prototype.fromJson=function(a){b.prototype.fromJson.call(this,a)},c.prototype.deselectAll=function(){this.forEach(function(a,b){a.deselect()})},c.prototype.selectAll=function(){this.forEach(function(a,b){a.select()})},c.prototype.select=function(b){if(!a.Utilities.isNullOrUndefined(b)){this.deselectAll();var c=this.get(b.guid);a.Utilities.isNotNullOrUndefined(c)&&c.select()}},c.prototype.deselect=function(b){if(!a.Utilities.isNullOrUndefined(b)){var c=this.get(b.guid);a.Utilities.isNotNullOrUndefined(c)&&c.deselect()}},c.prototype.toggleSelect=function(b){a.Utilities.isNullOrUndefined(b)||(b.selected?this.deselect(b):this.select(b))},c.prototype.hoverIn=function(b){a.Utilities.isNullOrUndefined(b)||(this.hoverOutAll(),b.hoverIn(null))},c.prototype.hoverOut=function(b){a.Utilities.isNullOrUndefined(b)||b.hoverOut(null)},c.prototype.hoverOutAll=function(){this.forEach(function(a,b){a.hoverOut(null)})},c}(a.Models.Collection);b.ActionableCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(a){function b(b){a.call(this,b),this.key=0,this.impaktDataType=b,this.associationKey=null,this.name=null,this.associable=["playbooks","scenarios","plays","formations","personnel","assignmentGroups","leagues","conferences","divisions","locations","teams","seasons","games","plans","practicePlans","practiceSchedules","gamePlans","scoutCards","QBWristbands"]}return __extends(b,a),b.prototype.generateAssociationKey=function(){this.associationKey=[this.impaktDataType,"|",this.key,"|",this.guid].join("")},b.prototype.toJson=function(){return $.extend({key:this.key,impaktDataType:this.impaktDataType,associationKey:this.associationKey,name:this.name},a.prototype.toJson.call(this))},b.prototype.fromJson=function(b){if(!b)throw new Error("AssociableEntity fromJson(): json is null or undefined");this.key=b.key,this.impaktDataType=b.impaktDataType,this.name=b.name,a.prototype.fromJson.call(this,b),this.generateAssociationKey()},b}(a.Models.Actionable);b.AssociableEntity=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c,d){b.call(this,d),this._associableEntity=new a.Models.AssociableEntity(c)}return __extends(c,b),c.prototype.toJson=function(){return $.extend(this._associableEntity.toJson(),b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){if(!a)throw new Error("AssociableEntity fromJson(): json is null or undefined");this._associableEntity.fromJson(a),b.prototype.fromJson.call(this,a)},c}(a.Models.Collection);b.AssociableEntityCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this),b.prototype.setContext.call(this,this),this._data={},this._size=0,this.contextId=a}return __extends(c,b),c.prototype.size=function(){return this._size},c.prototype.isEmpty=function(){return 0==this.size()},c.prototype.hasElements=function(){return this.size()>0},c.prototype.add=function(b,c){var d=new a.Models.Association(b.key,b.impaktDataType,b.guid,c.key,c.impaktDataType,c.guid,this.contextId);this.addAssociation(d)},c.prototype.addAll=function(b,c){if(a.Utilities.isNullOrUndefined(c))throw new Error("AssociationCollection addAll(): entities[] is null or undefined");for(var d=0;d<c.length;d++){var e=c[d];if(!a.Utilities.isNullOrUndefined(e)){var f=new a.Models.Association(b.key,b.impaktDataType,b.guid,e.key,e.impaktDataType,e.guid,this.contextId);this.addAssociation(f)}}},c.prototype.addAssociation=function(b){var c=new a.Models.Association(b.toKey,b.toType,b.toGuid,b.fromKey,b.fromType,b.fromGuid,this.contextId);this._data[b.internalKey]||(this._data[b.internalKey]=[],this._size++),this._data[b.internalKey].indexOf(c.internalKey)<0&&this._data[b.internalKey].push(c.internalKey),this._data[c.internalKey]||(this._data[c.internalKey]=[],this._size++),this._data[c.internalKey].indexOf(b.internalKey)<0&&this._data[c.internalKey].push(b.internalKey)},c.prototype.addInternalKey=function(b,c){if(a.Utilities.isNullOrUndefined(b)||a.Utilities.isNullOrUndefined(c))throw new Error("AssociationCollection addInternalKey(): 					internalKey or associations[] is null or undefined");this.exists(b)?this._data[b]=a.Utilities.uniqueArray(this._data[b].concat(c)):(this._data[b]=c,this._size++)},c.prototype.merge=function(b){if(a.Utilities.isNullOrUndefined(b))throw new Error("AssignmentCollection merge(): associationCollection to 					merge is null or undefined");if(!b.isEmpty()){var c=this;b.forEach(function(a,b){var d=a.getByInternalKey(b);c.addInternalKey(b,d)})}},c.prototype.getByInternalKey=function(b){if(a.Utilities.isNullOrUndefined(b))throw new Error("AssociationCollection get(): internalKey is null or undefined");return this._data[b]},c.prototype.hasAssociations=function(b){if(a.Utilities.isNullOrUndefined(b))throw new Error("AssociationCollection hasAssociations(): internalKey is null or undefined");if(!this.exists(b))return!1;var c=this._data[b];return a.Utilities.isNullOrUndefined(c)&&(this._data[b]=[]),c.length>0},c.prototype.empty=function(){this._data={},this._size=0},c.prototype["delete"]=function(b){if(a.Utilities.isNullOrUndefined(b))throw new Error("AssociationCollection remove(): internalKey is null or undefined");var c=new a.Models.AssociationCollection(this.contextId);if(this.exists(b)){for(var d=a.Models.Association.parse(b),e=this._data[b],f=0;f<e.length;f++)if(!a.Utilities.isNullOrUndefined(e[f])){var g=a.Models.Association.parse(e[f]),h=new a.Models.Association(d.entityKey,d.entityType,d.entityGuid,g.entityKey,g.entityType,g.entityGuid,this.contextId);c.addAssociation(h)}delete this._data[b],this._size--,this.forEach(function(a,c){var d=a._data[c].associations;if(!d||0==d.length)return delete a._data[c],void a._size--;if(d.length>0){var e=d.indexOf(b);e>=0&&(d.splice(e,1),0==d.length&&(delete a._data[c],a._size--))}})}return c},c.prototype.disassociate=function(b,c){if(a.Utilities.isNullOrUndefined(b)||a.Utilities.isNullOrUndefined(c))throw new Error("AssociationCollection disassociate(): from or to entity is null or undefined");var d=new a.Models.Association(b.key,b.impaktDataType,b.guid,c.key,c.impaktDataType,c.guid,this.contextId),e=new a.Models.Association(c.key,c.impaktDataType,c.guid,b.key,b.impaktDataType,b.guid,this.contextId),f=this._data[d.internalKey];if(!a.Utilities.isNotNullOrUndefined(f))throw new Error("AssociationCollection disassociate(): No from association found");if(f.length>1){var g=f.indexOf(e.internalKey);g>=0&&f.splice(g,1)}else delete this._data[d.internalKey],this._size--;var h=this._data[e.internalKey];if(!a.Utilities.isNotNullOrUndefined(h))throw new Error("AssociationCollection disassociate(): No to association found");if(h.length>1){var g=h.indexOf(d.internalKey);g>=0&&h.splice(g,1)}else delete this._data[e.internalKey],this._size--},c.prototype.exists=function(b){return a.Utilities.isNotNullOrUndefined(this._data[b])},c.prototype.associationExists=function(a,b){if(this.exists(a)){var c=this.getByInternalKey(a);return c.indexOf(b)>=0}return!1},c.prototype.replace=function(a,b){},c.prototype.forEach=function(a){for(var b in this._data)a(this,b)},c.prototype.toArray=function(b){b=b===!0;var c=[];for(var d in this._data)for(var e=a.Models.Association.parse(d),f=this._data[d],g=0;g<f.length;g++){var h=f[g],i=a.Models.Association.parse(h),j=new a.Models.Association(e.entityKey,e.entityType,e.entityGuid,i.entityKey,i.entityType,i.entityGuid,this.contextId);b?c.push(j.toJson()):c.push(j)}return c},c.prototype.toJson=function(){return this.toArray(!0)},c.prototype.fromJson=function(b){if(b)for(var c=0;c<b.length;c++){var d=b[c];if(a.Utilities.isNullOrUndefined(d))throw new Error("AssociationCollection fromJson(): an association result						is null or undefined");if(a.Utilities.isNullOrUndefined(d.data))throw new Error("AssociationCollection fromJson(): the data property of						an association result is null or undefined");var e=new a.Models.Association(d.fromKey,d.fromType,d.data.fromGuid,d.toKey,d.toType,d.data.toGuid,d.contextID);this.addAssociation(e)}},c.prototype.getInternalKeys=function(){var a=[];for(var b in this._data)a.push(b);return a},c}(a.Models.Modifiable);b.AssociationCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c,d,e,f,g,h,i){b.call(this),b.prototype.setContext.call(this,this),
this.fromKey=c,this.fromType=d,this.fromGuid=e,this.toKey=f,this.toType=g,this.toGuid=h,this.data={guid:this.guid,fromGuid:this.fromGuid,toGuid:this.toGuid},this.version=1,this.contextId=i,this.internalKey=a.Models.Association.buildKey(this),this.associationType=a.Enums.AssociationTypes.Peer}return __extends(c,b),c.buildKey=function(a){return[a.fromType,"|",a.fromKey,"|",a.fromGuid].join("")},c.parse=function(b){if(a.Utilities.isNullOrUndefined(b))throw new Error("Association parse(): internalKey is null or undefined");var c=b.split("|");if(c.length<=0)throw new Error('Association parse(): internalKey is invalid; missing "|" separator');if(c.length!=a.Models.Association.KEY_PART_LENGTH)throw new Error("Association parse(): internalKey is invalid; invalid number of parts");if(a.Utilities.isNullOrUndefined(c[0]))throw new Error("Association parse(): internalKey is invalid; entityType is null or undefined");var d=parseInt(c[0]);if(a.Utilities.isNullOrUndefined(a.Enums.ImpaktDataTypes[d]))throw new Error("Association parse(): internalKey is invalid; entityType is not valid ImpaktDataType");if(a.Utilities.isNullOrUndefined(c[1])||parseInt(c[1])<=0)throw new Error("Association parse(): internalKey is invalid; entityKey is invalid");var e=parseInt(c[1]);if(a.Utilities.isNullOrUndefined(c[2]))throw new Error("Association parse(): internalKey is invalid; entity guid is null or undefined");var f=c[2];return new a.Models.AssociationParts(d,e,f)},c.prototype.toJson=function(){return{fromKey:this.fromKey,fromType:this.fromType,toKey:this.toKey,toType:this.toType,contextID:this.contextId+"",data:this.data,version:this.version,associationType:this.associationType}},c.prototype.fromJson=function(a){if(a){if(!a.data)throw new Error("Association fromJson(): data is null or undefined");this.guid=a.data.guid,this.fromGuid=a.data.fromGuid,this.toGuid=a.data.toGuid,this.fromKey=a.fromKey,this.fromType=a.fromType,this.toKey=a.toKey,this.toType=a.toType,this.contextId=a.contextID,this.data=a.data,this.associationType=a.associationType,this.version=a.version}},c.KEY_PART_LENGTH=3,c}(a.Models.Modifiable);b.Association=c;var d=function(){function a(a,b,c){this.entityType=a,this.entityKey=b,this.entityGuid=c}return a}();b.AssociationParts=d}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(){function b(){this.playbooks=new a.Models.PlaybookModelCollection(Team.Enums.UnitTypes.Mixed),this.scenarios=new a.Models.ScenarioCollection(Team.Enums.UnitTypes.Mixed),this.plays=new a.Models.PlayCollection(Team.Enums.UnitTypes.Mixed),this.formations=new a.Models.FormationCollection(Team.Enums.UnitTypes.Mixed),this.personnel=new Team.Models.PersonnelCollection(Team.Enums.UnitTypes.Mixed),this.assignmentGroups=new a.Models.AssignmentGroupCollection(Team.Enums.UnitTypes.Mixed),this.leagues=new League.Models.LeagueModelCollection,this.conferences=new League.Models.ConferenceCollection,this.divisions=new League.Models.DivisionCollection,this.locations=new League.Models.LocationCollection,this.teams=new Team.Models.TeamModelCollection,this.seasons=new Season.Models.SeasonModelCollection,this.games=new Season.Models.GameCollection,this.plans=new Planning.Models.PlanCollection,this.practicePlans=new Planning.Models.PracticePlanCollection,this.practiceSchedules=new Planning.Models.PracticeScheduleCollection,this.gamePlans=new Planning.Models.GamePlanCollection,this.scoutCards=new Planning.Models.ScoutCardCollection,this.QBWristbands=new Planning.Models.QBWristbandCollection}return b.prototype.count=function(){var a=0;return a+=this.playbooks.size(),a+=this.scenarios.size(),a+=this.plays.size(),a+=this.formations.size(),a+=this.personnel.size(),a+=this.assignmentGroups.size(),a+=this.leagues.size(),a+=this.conferences.size(),a+=this.divisions.size(),a+=this.locations.size(),a+=this.teams.size(),a+=this.seasons.size(),a+=this.games.size(),a+=this.plans.size(),a+=this.practicePlans.size(),a+=this.practiceSchedules.size(),a+=this.gamePlans.size(),a+=this.scoutCards.size(),a+=this.QBWristbands.size()},b.prototype.hasAssociations=function(){return this.count()>0},b.prototype.isEmpty=function(){return 0==this.count()},b.prototype.getPopulatedAssociationKeys=function(){var a=[];return this.playbooks.hasElements()&&a.push("playbooks"),this.scenarios.hasElements()&&a.push("scenarios"),this.plays.hasElements()&&a.push("plays"),this.formations.hasElements()&&a.push("formations"),this.personnel.hasElements()&&a.push("personnel"),this.assignmentGroups.hasElements()&&a.push("assignmentGroups"),this.leagues.hasElements()&&a.push("leagues"),this.conferences.hasElements()&&a.push("conferences"),this.divisions.hasElements()&&a.push("divisions"),this.locations.hasElements()&&a.push("locations"),this.teams.hasElements()&&a.push("teams"),this.seasons.hasElements()&&a.push("seasons"),this.games.hasElements()&&a.push("games"),this.plans.hasElements()&&a.push("plans"),this.practicePlans.hasElements()&&a.push("practicePlans"),this.practiceSchedules.hasElements()&&a.push("practiceSchedules"),this.gamePlans.hasElements()&&a.push("gamePlans"),this.scoutCards.hasElements()&&a.push("scoutCards"),this.QBWristbands.hasElements()&&a.push("QBWristbands"),a},b}();b.AssociationResults=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a,c){b.call(this),b.prototype.setContext.call(this,this),this.message=a,this.type=c}return __extends(c,b),c.prototype.update=function(a,b){return this.message=a,this.type=b,this},c.prototype.success=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return this.update(this._concat(b),a.Models.NotificationType.Success)},c.prototype.error=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return this.update(this._concat(b),a.Models.NotificationType.Error)},c.prototype.warning=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return this.update(this._concat(b),a.Models.NotificationType.Warning)},c.prototype.info=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return this.update(this._concat(b),a.Models.NotificationType.Info)},c.prototype.pending=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return this.update(this._concat(b),a.Models.NotificationType.Pending)},c.prototype._concat=function(a){return!a||!a.length||a.length<=0?"":a.join("")},c}(a.Models.Modifiable);b.Notification=c,function(a){a[a.None=0]="None",a[a.Success=1]="Success",a[a.Error=2]="Error",a[a.Warning=3]="Warning",a[a.Info=4]="Info",a[a.Pending=5]="Pending"}(b.NotificationType||(b.NotificationType={}));b.NotificationType}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(a){function b(){a.call(this)}return __extends(b,a),b}(a.Models.Collection);b.NotificationCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(a){var b=function(){function a(a){this.prefix="glyphicon glyphicon-",this.icon="asterisk",this.icon=a||this.icon}return Object.defineProperty(a.prototype,"name",{get:function(){return this.prefix+this.icon},set:function(a){this.name=a},enumerable:!0,configurable:!0}),a}();a.Glyphicon=b}(b=a.Icons||(a.Icons={}))}(Common||(Common={}));var Common;!function(a){var b;!function(a){var b=function(){function a(){}return a}();a.Situation=b}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){b.call(this,a.Enums.ImpaktDataTypes.Assignment),this.unitType=c,this.routes=new a.Models.RouteCollection,this.routeArray=[],this.positionIndex=-1,this.setType=a.Enums.SetTypes.Assignment,this.layer=new a.Models.Layer(this,a.Enums.LayerTypes.Assignment);var d=this;this.routes.onModified(function(){d.setModified(!0)}),this.layer.onModified(function(){d.setModified(!0)})}return __extends(c,b),c.prototype.toJson=function(){return $.extend({routes:this.routes.toJson(),positionIndex:this.positionIndex,unitType:this.unitType},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.routeArray=a.routes,this.positionIndex=a.positionIndex,this.unitType=a.unitType,b.prototype.fromJson.call(this,a))},c.prototype.copy=function(c){var d=c||new a.Models.Assignment(this.unitType),e=b.prototype.copy.call(this,d,this);return e.routeArray=this.routeArray,e},c.prototype.remove=function(){this.layer.remove()},c.prototype.setContext=function(a){this.routes.forEach(function(b,c){b.setContext(a)})},c.prototype.draw=function(){this.routes.forEach(function(a,b){a.draw()})},c.prototype.drop=function(){this.routes.forEach(function(b,c){a.Utilities.isNotNullOrUndefined(b)&&(b.dragInitialized&&(b.dragInitialized=!1),b.drop(),b.draw())})},c.prototype.addRoute=function(b){a.Utilities.isNullOrUndefined(b)||(this.routes.add(b),this.routeArray=this.routes.toJson())},c.prototype.setRoutes=function(b,c){if(this.listen(!1),this.hasRouteArray()||!this.routes.isEmpty()){this.routes.hasElements()&&(this.routeArray=this.routes.toJson());for(var d=[],e=0;e<this.routeArray.length;e++){var f=this.routeArray[e];if(a.Utilities.isNotNullOrUndefined(f)){var g=null;switch(c){case a.Enums.RenderTypes.Preview:g=new Playbook.Models.PreviewRoute;break;case a.Enums.RenderTypes.Editor:g=new Playbook.Models.EditorRoute}if(a.Utilities.isNullOrUndefined(g))throw new Error("Assignment setRoutes(): converted route is null or undefined");g.setPlayer(b),g.fromJson(f),d.push(g)}}d.length>0&&this.routes.addAll(d),this.listen(!0)}},c.prototype.hasRouteArray=function(){return this.routeArray&&this.routeArray.length>0},c.prototype.updateRouteArray=function(){this.routeArray=this.routes.toJson()},c.prototype.flip=function(){a.Utilities.isNotNullOrUndefined(this.routes)&&(this.routes.forEach(function(b,c){a.Utilities.isNotNullOrUndefined(b)&&b.flip()}),this.flipped=!this.flipped)},c.prototype.moveByDelta=function(b,c){this.routes.forEach(function(d,e){a.Utilities.isNotNullOrUndefined(d)&&d.layer.moveByDelta(b,c)})},c.prototype.refresh=function(){this.routes.forEach(function(a,b){a.refresh()})},c}(a.Models.AssociableEntity);b.Assignment=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c,d){if(b.call(this,a.Enums.ImpaktDataTypes.AssignmentGroup),this.unitType=c,this.assignments=new a.Models.Collection(11),d)for(var e=0;d>e;e++){var f=new a.Models.Assignment(this.unitType);f.positionIndex=e,this.assignments.add(f)}this.name="Untitled",this.key=-1,this.flipped=!1,this.onModified(function(){}),this.associable=["playbooks","scenarios","plays","formations","personnel","assignmentGroups","teams"]}return __extends(c,b),c.prototype.copy=function(c){var d=c||new a.Models.AssignmentGroup(this.unitType);d.assignments=new a.Models.Collection;var e=b.prototype.copy.call(this,d,this);return this.assignments.forEach(function(b,c){a.Utilities.isNotNullOrUndefined(b)&&e.assignments.add(b.copy())}),e},c.prototype.toJson=function(){return $.extend({unitType:this.unitType,name:this.name,assignments:this.assignments.toJson()},b.prototype.toJson.call(this))},c.prototype.fromJson=function(c){if(c){this.unitType=c.unitType,this.name=c.name;for(var d=c.assignments||[],e=0;e<d.length;e++){var f=d[e];if(!a.Utilities.isNullOrUndefined(f)){f.unitType=a.Utilities.isNotNullOrUndefined(f.unitType)&&f.unitType>=0?f.unitTpe:Team.Enums.UnitTypes.Other;var g=new a.Models.Assignment(f.unitType);g.fromJson(f),this.assignments.addAtIndex(g,e)}}b.prototype.fromJson.call(this,c)}},c.prototype.getAssignmentByPositionIndex=function(a){var b=null;return this.assignments.hasElements()&&(b=this.assignments.filterFirst(function(b){return b.positionIndex==a})),b},c.prototype.flip=function(){a.Utilities.isNotNullOrUndefined(this.assignments)&&(this.assignments.forEach(function(b,c){a.Utilities.isNotNullOrUndefined(b)&&b.flip()}),this.flipped=!this.flipped)},c}(a.Models.AssociableEntity);b.AssignmentGroup=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this),this.unitType=a,this.onModified(function(){})}return __extends(c,b),c.prototype.toJson=function(){return{unitType:this.unitType,assignmentCollections:b.prototype.toJson.call(this)}},c.prototype.fromJson=function(b){if(b){this.unitType=b.unitType;for(var c=b.assignmentCollections||[],d=0;d<c.length;d++){var e=c[d];if(!a.Utilities.isNullOrUndefined(e)){e.unitType=a.Utilities.isNotNullOrUndefined(e.unitType)&&e.unitType>=0?e.unitTpe:Team.Enums.UnitTypes.Other;var f=new a.Models.AssignmentGroup(e.unitType);f.fromJson(e),this.add(f)}}}},c}(a.Models.ActionableCollection);b.AssignmentGroupCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){b.call(this,a.Enums.ImpaktDataTypes.Formation),this.unitType=c,this.parentRK=1,this.editorType=Playbook.Enums.EditorTypes.Formation,this.name="",this.placements=new a.Models.PlacementCollection,this.png=null;var d=this;this.onModified(function(){}),this.placements.onModified(function(){d.setModified(!0)}),this.associable=["playbooks","scenarios","plays","formations","personnel","assignmentGroups","teams"]}return __extends(c,b),c.prototype.copy=function(c){var d=c||new a.Models.Formation(this.unitType);return b.prototype.copy.call(this,d,this)},c.prototype.toJson=function(){return $.extend({name:this.name,parentRK:this.parentRK,unitType:this.unitType,editorType:this.editorType,placements:this.placements.toJson(),png:this.png},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){if(a){var c=this;this.parentRK=a.parentRK,this.editorType=Playbook.Enums.EditorTypes.Formation,this.name=a.name,this.unitType=a.unitType,this.placements.fromJson(a.placements),this.png=a.png,b.prototype.fromJson.call(this,a),this.placements.onModified(function(){c.setModified(!0)}),this.onModified(function(){})}},c.prototype.setDefault=function(b){if(!b)throw new Error("Formation setDefault(): 					Field reference is null or undefined");this.placements.removeAll(),this.placements.addAll([new a.Models.Placement(0,-1,b,0),new a.Models.Placement(1.5,-1,b,1),new a.Models.Placement(-1.5,-1,b,2),new a.Models.Placement(-3,-1,b,3),new a.Models.Placement(3,-1,b,4),new a.Models.Placement(0,-2,b,5),new a.Models.Placement(-4,-2,b,6),new a.Models.Placement(-16,-1,b,7),new a.Models.Placement(14,-1,b,8),new a.Models.Placement(0,-4,b,9),new a.Models.Placement(0,-6,b,10)])},c.prototype.isValid=function(){return 11==this.placements.size()},c.prototype.setPlacements=function(a){this.placements=a,this.setModified(!0)},c.prototype.setUnitType=function(a){this.unitType=a,this.setModified(!0)},c.prototype.flip=function(){a.Utilities.isNotNullOrUndefined(this.placements)&&(this.placements.flip(),this.flipped=this.placements.flipped)},c}(a.Models.AssociableEntity);b.Formation=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this),this.parentRK=-1,this.unitType=a,this.onModified(function(){})}return __extends(c,b),c.prototype.toJson=function(){return{formations:b.prototype.toJson.call(this),unitType:this.unitType,guid:this.guid}},c.prototype.fromJson=function(b){if(b){for(var c=this,d=b||[],e=0;e<d.length;e++){var f=d[e];if(!a.Utilities.isNullOrUndefined(f)){f.unitType=a.Utilities.isNotNullOrUndefined(f.unitType)&&f.unitType>=0?f.unitType:Team.Enums.UnitTypes.Other;var g=new a.Models.Formation(f.unitType);g.fromJson(f),this.add(g)}}this.forEach(function(a,b){a.onModified(function(){console.log("formation collection modified: formation"),c.setModified(!0)})})}},c}(a.Models.ActionableCollection);b.FormationCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){b.call(this,a.Enums.ImpaktDataTypes.Play),this.field=null,this.name="",this.unitType=c,this.assignmentGroup=null,this.formation=null,this.personnel=null,this.png=null,this.contextmenuTemplateUrl=a.Constants.PLAY_CONTEXTMENU_TEMPLATE_URL,this.playType=Playbook.Enums.PlayTypes.Unknown,this.flipped=!1,this.associable=["playbooks","scenarios","plays","formations","personnel","assignmentGroups","teams"]}return __extends(c,b),c.prototype.copy=function(a){return a.formation=this.formation&&this.formation.copy(),a.personnel=this.personnel&&this.personnel.copy(),a.assignmentGroup=this.assignmentGroup&&this.assignmentGroup.copy(),b.prototype.copy.call(this,a,this)},c.prototype.toJson=function(){return $.extend({name:this.name,unitType:this.unitType,png:this.png,playType:this.playType},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){this.name=a.name,this.unitType=a.unitType,this.png=a.png,this.playType=a.playType||this.playType,b.prototype.fromJson.call(this,a)},c.prototype.setPlaybook=function(a){this.setModified(!0)},c.prototype.setFormation=function(b){return a.Utilities.isNullOrUndefined(b)?(this.setAssignmentGroup(null),void this.setPersonnel(null)):(b.unitType!=this.unitType,this.formation=b,this.unitType=b.unitType,void this.setModified(!0))},c.prototype.setAssignmentGroup=function(b){a.Utilities.isNotNullOrUndefined(b)&&b.unitType!=this.unitType,this.assignmentGroup=b,this.setModified(!0)},c.prototype.setPersonnel=function(b){a.Utilities.isNotNullOrUndefined(b)&&b.unitType!=this.unitType,this.personnel=b,this.setModified(!0)},c.prototype.setUnitType=function(a){this.isFieldSet(this.field),this.isBallSet(this.field.ball),a!=this.unitType&&(this.unitType=a,this.formation&&this.formation.setUnitType(a),this.personnel&&this.personnel.unitType!=a&&(this.personnel.unitType=a,this.personnel.setDefault()),this.assignmentGroup&&this.assignmentGroup.unitType!=this.unitType&&(this.assignmentGroup=null),this.setModified(!0))},c.prototype.hasAssignments=function(){return this.assignmentGroup&&this.assignmentGroup.assignments.size()>0},c.prototype.setDefault=function(b){this.isFieldSet(b),this.field=b,this.personnel||(this.personnel=new Team.Models.Personnel(this.unitType)),this.formation||(this.formation=new a.Models.Formation(this.unitType)),this.personnel.setDefault(),this.formation.setDefault(this.field.ball)},c.prototype.getOpposingUnitType=function(){var a=Team.Enums.UnitTypes.Other;switch(this.unitType){case Team.Enums.UnitTypes.Offense:a=Team.Enums.UnitTypes.Defense;break;case Team.Enums.UnitTypes.Defense:a=Team.Enums.UnitTypes.Offense}return a},c.prototype.isFieldSet=function(a){if(!a)throw new Error("Play draw(): Field is null or undefined");return!0},c.prototype.isBallSet=function(a){if(!a)throw new Error("Play draw(): Ball is null or undefined");return!0},c.prototype.setField=function(a){this.isFieldSet(a),this.isBallSet(a.ball),this.field=a},c.toPrimary=function(b){if(b.playType==Playbook.Enums.PlayTypes.Primary)return b;var c=new a.Models.PlayPrimary(b.unitType);return c.fromJson(b.toJson()),c.playType=Playbook.Enums.PlayTypes.Primary,c.assignmentGroup=b.assignmentGroup,c.formation=b.formation,c.personnel=b.personnel,c},c.toOpponent=function(b){if(b.playType==Playbook.Enums.PlayTypes.Opponent)return b;var c=new a.Models.PlayOpponent(b.unitType);return c.fromJson(b.toJson()),c.playType=Playbook.Enums.PlayTypes.Opponent,c.assignmentGroup=b.assignmentGroup,c.formation=b.formation,c.personnel=b.personnel,c},c.prototype.flip=function(){a.Utilities.isNotNullOrUndefined(this.formation)&&this.formation.flip(),a.Utilities.isNotNullOrUndefined(this.assignmentGroup),this.flipped=!this.flipped},c}(a.Models.AssociableEntity);b.Play=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this,a),this.playType=Playbook.Enums.PlayTypes.Primary}return __extends(c,b),c.prototype.copy=function(c){var d=c||new a.Models.PlayPrimary(this.unitType);return b.prototype.copy.call(this,d)},c.prototype.draw=function(c){b.prototype.setField.call(this,c),this.field.clearPrimaryPlayers();var d=this;this.personnel||(this.personnel=new Team.Models.Personnel(this.unitType)),this.personnel.positions||this.personnel.setDefault(),this.assignmentGroup||(this.assignmentGroup=new a.Models.AssignmentGroup(this.unitType)),this.formation||(this.formation=new a.Models.Formation(this.unitType)),this.formation.placements&&!this.formation.placements.isEmpty()||this.formation.setDefault(this.field.ball),this.field.primaryPlayers.listen(!1),this.formation.placements.forEach(function(a,b){var c=d.personnel.positions.getIndex(b),e=d.assignmentGroup.assignments.getIndex(b);d.field.addPrimaryPlayer(a,c,e)}),this.field.primaryPlayers.listen(!0),this.field.primaryPlayers.setModified(!0)},c}(a.Models.Play);b.PlayPrimary=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this,a),this.playType=Playbook.Enums.PlayTypes.Opponent}return __extends(c,b),c.prototype.copy=function(c){var d=c||new a.Models.PlayOpponent(this.unitType);return b.prototype.copy.call(this,d)},c.prototype.draw=function(c){b.prototype.setField.call(this,c),this.field.clearOpponentPlayers();var d=this;this.personnel||(this.personnel=new Team.Models.Personnel(this.unitType)),this.personnel.positions||this.personnel.setDefault(),this.assignmentGroup||(this.assignmentGroup=new a.Models.AssignmentGroup(this.unitType)),this.formation||(this.formation=new a.Models.Formation(this.unitType)),this.formation.placements&&!this.formation.placements.isEmpty()||this.formation.setDefault(this.field.ball),this.field.opponentPlayers.listen(!1),this.formation.placements.forEach(function(a,b){var c=d.personnel.positions.getIndex(b),e=d.assignmentGroup.assignments.getIndex(b);d.field.addOpponentPlayer(a,c,e)}),a.Utilities.isNotNullOrUndefined(this.field.opponentPlayers)&&!this.flipped&&(this.field.opponentPlayers.forEach(function(b,c){a.Utilities.isNotNullOrUndefined(b)&&!b.flipped&&b.flip()}),this.flipped=!this.flipped),this.field.opponentPlayers.listen(!0),this.field.opponentPlayers.setModified(!0)},c}(a.Models.Play);b.PlayOpponent=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this),this.unitType=a}return __extends(c,b),c.prototype.toJson=function(){var a=this;return $.extend(b.prototype.toJson.call(this),{unitType:a.unitType})},c.prototype.fromJson=function(b){if(b){this.unitType=b.unitType;var c=b.plays;c||(c=[]);for(var d=0;d<c.length;d++){var e=c[d],f=e.data.play;if(!a.Utilities.isNullOrUndefined(f)){f.unitType=a.Utilities.isNullOrUndefined(f.unitType)&&f.unitType>=0?f.unitType:Team.Enums.UnitTypes.Other,f.key=e.key;var g=new a.Models.PlayPrimary(f.unitType);g.fromJson(f),this.add(g)}}}},c}(a.Models.ActionableCollection);b.PlayCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){b.call(this,a.Enums.ImpaktDataTypes.Playbook),this.name="",this.unitType=c,this.associable=["scenarios","plays","formations","assignmentGroups","teams","games"]}return __extends(c,b),c.prototype.toJson=function(){return $.extend({name:this.name,unitType:this.unitType},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.name=a.name,this.unitType=a.unitType,b.prototype.fromJson.call(this,a))},c}(a.Models.AssociableEntity);b.PlaybookModel=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this),this.unitType=a}return __extends(c,b),c.prototype.toJson=function(){return{guid:this.guid,playbooks:b.prototype.toJson.call(this),unitType:this.unitType}},c.prototype.fromJson=function(b){if(b){this.guid=b.guid||this.guid,this.unitType=b.unitType;for(var c=b.playbooks||[],d=0;d<c.length;d++){var e=c[d];if(!a.Utilities.isNullOrUndefined(e)){e.unitType=a.Utilities.isNotNullOrUndefined(e.unitType)&&e.unitType>=0?e.unitType:Team.Enums.UnitTypes.Mixed,e.unitType!=this.unitType&&(this.unitType=Team.Enums.UnitTypes.Mixed);var f=new a.Models.PlaybookModel(e.unitType);f.fromJson(e),this.add(f)}}}},c}(a.Models.ActionableCollection);b.PlaybookModelCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this,a.Enums.ImpaktDataTypes.Scenario),this.playPrimary=new a.Models.PlayPrimary(Team.Enums.UnitTypes.Other),this.playPrimaryGuid=this.playPrimary.guid,this.playOpponent=new a.Models.PlayOpponent(Team.Enums.UnitTypes.Other),this.playOpponentGuid=this.playOpponent.guid,this.unitType=this.playPrimary.unitType,this.editorType=Playbook.Enums.EditorTypes.Play,this.name="",this.associable=["playbooks","scenarios","plays","formations","personnel","assignmentGroups","teams"]}return __extends(c,b),c.prototype.copy=function(c){var d=c||new a.Models.Scenario;return a.Utilities.isNotNullOrUndefined(this.playPrimary)&&(d.playPrimary=this.playPrimary.copy()),a.Utilities.isNotNullOrUndefined(this.playOpponent)&&(d.playOpponent=this.playOpponent.copy()),b.prototype.copy.call(this,d,this)},c.prototype.toJson=function(){return $.extend({name:this.name,png:this.png,unitType:this.unitType,editorType:this.editorType,playPrimaryGuid:this.playPrimaryGuid,playOpponentGuid:this.playOpponentGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.name=a.name,this.unitType=a.unitType,this.png=a.png,this.editorType=a.editorType,this.playPrimaryGuid=a.playPrimaryGuid,this.playOpponentGuid=a.playOpponentGuid,b.prototype.fromJson.call(this,a))},c.prototype.setPlayPrimary=function(b){return a.Utilities.isNullOrUndefined(b)?void(this.playPrimary=null):(this.playPrimary=a.Models.Play.toPrimary(b),this.playPrimaryGuid=this.playPrimary.guid,this.unitType=this.playPrimary.unitType,void this.setModified(!0))},c.prototype.setPlayOpponent=function(b){return a.Utilities.isNullOrUndefined(b)?void(this.playOpponent=null):(this.playOpponent=a.Models.Play.toOpponent(b),this.playOpponentGuid=this.playOpponent.guid,void this.setModified(!0))},c.prototype.clear=function(){this.playPrimary=null,this.playPrimaryGuid=null,this.playOpponent=null,this.playOpponentGuid=null},c.prototype.draw=function(b){a.Utilities.isNotNullOrUndefined(this.playPrimary)&&this.playPrimary.draw(b),a.Utilities.isNotNullOrUndefined(this.playOpponent)&&this.playOpponent.draw(b)},c}(a.Models.AssociableEntity);b.Scenario=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this),this.unitType=a}return __extends(c,b),c.prototype.toJson=function(){var a=this;return $.extend(b.prototype.toJson.call(this),{unitType:a.unitType})},c.prototype.fromJson=function(b){if(b){this.unitType=b.unitType,b.scenarios||(b.scenarios=[]);for(var c=0;c<b.scenarios.length;c++){var d=b.scenarios[c],e=d.data.scenario;if(!a.Utilities.isNullOrUndefined(e)){e.unitType=a.Utilities.isNullOrUndefined(e.unitType)&&e.unitType>=0?e.unitType:Team.Enums.UnitTypes.Other,e.key=d.key;var f=new a.Models.Scenario;f.fromJson(e),this.add(f)}}}},c}(a.Models.ActionableCollection);b.ScenarioCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){if(b.call(this),this.title="Untitled",this.active=!0,b.prototype.setContext.call(this,this),a.Utilities.isNullOrUndefined(c))throw new Error("Tab constructor(): scenario is null or undefined");switch(this.scenario=c,this.scenario.editorType){case Playbook.Enums.EditorTypes.Formation:if(a.Utilities.isNullOrUndefined(this.scenario.playPrimary)||a.Utilities.isNullOrUndefined(this.scenario.playPrimary.formation))throw new Error("Tab constructor(): scenario formation is null or undefined");this.title=this.scenario.playPrimary.formation.name;break;case Playbook.Enums.EditorTypes.Play:if(a.Utilities.isNullOrUndefined(this.scenario.playPrimary))throw new Error("Tab constructor(): scenario primary play is null or undefined");this.title=this.scenario.playPrimary.name;break;case Playbook.Enums.EditorTypes.Scenario:this.title=this.scenario.name}this._closeCallbacks=[function(){console.log("tab closed",this.guid)}]}return __extends(c,b),c.prototype.onclose=function(a){this._closeCallbacks.push(a)},c.prototype.close=function(){for(var a=0;a<this._closeCallbacks.length;a++)this._closeCallbacks[a]()},c}(a.Models.Modifiable);b.Tab=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.getByPlayGuid=function(a){return this.filterFirst(function(b,c){return b.play.guid==a})},b.prototype.close=function(a){this.remove(a.guid),a.close()},b}(a.Models.Collection);b.TabCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(a){function b(b,c){a.call(this),a.prototype.setContext.call(this,this),this.name=b,this.url=c,this.data={}}return __extends(b,a),b}(a.Models.Modifiable);b.Template=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(a){function b(b){a.call(this),this.name=b}return __extends(b,a),b}(a.Models.Collection);b.TemplateCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(a){var b=function(){function a(){}return a.prototype.shiftPressed=function(){},a.prototype.ctrlPressed=function(){},a.prototype.altPressed=function(){},a.prototype.metaPressed=function(){},a}();a.KeyboardInputListener=b;var c=function(){function a(){}return a}();a.MouseInputListener=c,function(a){a[a.LeftClick=1]="LeftClick",a[a.RightClick=3]="RightClick",a[a.Backspace=8]="Backspace",a[a.Enter=13]="Enter",a[a.Esc=27]="Esc",a[a.Left=37]="Left",a[a.Up=38]="Up",a[a.Right=39]="Right",a[a.Down=40]="Down",a[a.A=65]="A",a[a.B=66]="B",a[a.C=67]="C",a[a.D=68]="D",a[a.E=69]="E",a[a.F=70]="F",a[a.G=71]="G",a[a.H=72]="H",a[a.I=73]="I",a[a.J=74]="J",a[a.K=75]="K",a[a.L=76]="L",a[a.M=77]="M",a[a.N=78]="N",a[a.O=79]="O",a[a.P=80]="P",a[a.Q=81]="Q",a[a.R=82]="R",a[a.S=83]="S",a[a.T=84]="T",a[a.U=85]="U",a[a.V=86]="V",a[a.W=87]="W",a[a.X=88]="X",a[a.Y=89]="Y",a[a.Z=90]="Z",a[a.a=97]="a",a[a.b=98]="b",a[a.c=99]="c",a[a.d=100]="d",a[a.e=101]="e",a[a.f=102]="f",a[a.g=103]="g",a[a.h=104]="h",a[a.i=105]="i",a[a.j=106]="j",a[a.k=107]="k",a[a.l=108]="l",a[a.m=109]="m",a[a.n=110]="n",a[a.o=111]="o",a[a.p=112]="p",a[a.q=113]="q",a[a.r=114]="r",a[a.s=115]="s",a[a.t=116]="t",a[a.u=117]="u",a[a.v=118]="v",a[a.w=119]="w",a[a.x=120]="x",a[a.y=121]="y",a[a.z=122]="z"}(a.Which||(a.Which={}));a.Which}(b=a.Input||(a.Input={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c,d){b.call(this),b.prototype.setContext.call(this,this),this.sizingMode=this.sizingMode||a.Enums.CanvasSizingModes.MaxContainerWidth,this.x=0,this.y=0,this.dimensions=new a.Models.Dimensions,this.dimensions.setMinWidth(500),this.dimensions.setMinHeight(400),this.widthChangeInterval=null,this.readyCallbacks=[],this.listener=new a.Models.CanvasListener(this)}return __extends(c,b),c.prototype.clear=function(){this.clearListeners(),this.field.clearScenario(),this.setModified(!0)},c.prototype.exportToPng=function(){if(!this.$container)throw new Error("Canvas exportToPng(): Cannot export to png;                 SVG parent $container is null or undefined");var b=this.$container.find("svg")[0];if(!b)throw new Error("Canvas exportToPng(): Cannot export to png;                 Could not find SVG element inside of canvas $container");return a.Utilities.exportToPng(this,b)},c.prototype.getSvg=function(){var a=$("svg"),b=new XMLSerializer,c=b.serializeToString(a[0]);return c},c.prototype.refresh=function(){this.field.draw()},c.prototype.resize=function(){this.dimensions.width=this.$container.width(),this.dimensions.height=this.$container.height(),this.grid.resize(this.sizingMode),this.setViewBox();
},c.prototype.getWidth=function(){return this.grid.dimensions.width},c.prototype.getHeight=function(){return this.grid.dimensions.height},c.prototype.getXOffset=function(){return-Math.round((this.dimensions.width-this.grid.dimensions.width)/2)},c.prototype.setViewBox=function(a){a=a===!0,this.drawing.setAttribute("width",this.grid.dimensions.width);this.drawing.setViewBox(this.x,this.y,this.grid.dimensions.width,this.grid.dimensions.height,!0)},c}(a.Models.Modifiable);b.Canvas=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(){function b(a,b){this.grid=b,this.canvas=a,this.Raphael=this.Raphael||new Raphael(this.canvas.container,this.grid.dimensions.width,this.grid.dimensions.height)}return b.prototype.clear=function(){this.Raphael.clear()},b.prototype.setAttribute=function(a,b){this.Raphael.canvas.setAttribute(a,b)},b.prototype.setViewBox=function(a,b,c,d,e){this.Raphael.setViewBox(a,b,c,d,e)},b.prototype.alignToGrid=function(b,c,d){var e=new a.Models.Coordinates(b,c);return d?e:this.grid.getAbsoluteFromCoordinates(e.x,e.y)},b.prototype.path=function(a){return this.Raphael.path(a)},b.prototype.rect=function(a,b,c,d,e,f,g){var h=this.alignToGrid(a,b,e);f=f||0,g=g||0;var i=this.Raphael.rect(h.x+f,h.y+g,c,d).attr({x:h.x+f,y:h.y+g});return i},b.prototype.rhombus=function(a,b,c,d,e,f,g){var h=this.rect(a,b,c,d,e,f,g);return h.transform("r-45"),h},b.prototype.ellipse=function(a,b,c,d,e,f,g){var h=this.alignToGrid(a,b,e);f=f||0,g=g||0;var i=this.Raphael.ellipse(h.x+f,h.y+g,c,d).attr({cx:h.x+f,cy:h.y+g});return i},b.prototype.circle=function(a,b,c,d,e,f){var g=this.alignToGrid(a,b,d);e=e||0,f=f||0;var h=this.Raphael.circle(g.x+e,g.y+f,c).attr({cx:g.x+e,cy:g.y+f});return h},b.prototype.triangle=function(b,c,d,e,f,g){var h=this.alignToGrid(b,c,e);f=f||0,g=g||0;var i=d/2,j=2*d/Math.sqrt(3),k=a.Drawing.Utilities.getClosedPathString(!0,[h.x+f-j/2,h.y+g+i,h.x+f,h.y+g-i,h.x+f+j/2,h.y+g+i]),l=this.Raphael.path(k);return l.data("element-type","triangle"),l},b.prototype.text=function(a,b,c,d,e,f){var g=this.alignToGrid(a,b,d);return e=e||0,f=f||0,this.Raphael.text(g.x+e,g.y+f,c).attr({x:g.x+e,y:g.y+f})},b.prototype.print=function(a,b,c,d,e,f,g,h,i){var j=this.alignToGrid(a,b,!1);return h=h||0,i=i||0,this.Raphael.print(j.x+h,j.y+i,c,d,e,f,g).attr({x:j.x+h,y:j.y+i})},b.prototype.getFont=function(a,b,c,d){var e=b||100,f=c||"normal",g=d||null;return this.Raphael.getFont(a,e,f,g)},b.prototype.set=function(){return this.Raphael.set()},b.pathMoveTo=function(a,b){return["M",a," ",b].join("")},b.getPathString=function(b,c){if(c&&!(c.length<4)&&c.length%2==0){for(var d=b?a.Drawing.Utilities.pathMoveTo(c[0],c[1]):"",e=2;e<c.length;e+=2)d+=a.Drawing.Utilities.pathLineTo(c[e],c[e+1]);return d}},b.pathLineTo=function(a,b){return["L",a," ",b].join("")},b.getClosedPathString=function(b,c){return a.Drawing.Utilities.getPathString(b,c)+" Z"},b.getCurveString=function(b,c){if(!c||c.length%2!=0)throw new Error(["You must pass an even number"," of coords to getCurveString()"].join(""));var d="";if(b){if(6!=c.length)throw new Error(["You must pass at least 6 coords to initialize"," a curved path"].join(""));var e=c.splice(0,2);d=a.Drawing.Utilities.pathMoveTo(e[0],e[1])}if(c.length<4)throw new Error(["There must be 4 coords to create a curved path:"," control -> (x, y); end -> (x, y);"," [control.x, control.y, end.x, end.y]"].join(""));for(var f=0;f<c.length;f+=4)d+=a.Drawing.Utilities.quadraticCurveTo(c[f],c[f+1],c[f+2],c[f+3]);return d},b.quadraticCurveTo=function(a,b,c,d){return["Q",a,",",b," ",c,",",d].join("")},b.buildPath=function(b,c,d){var e=this.distance(b.x,b.y,c.x,c.y),f=this.theta(b.x,b.y,c.x,c.y),g={x:Math.cos(f+Math.PI/2)*(d/2)+b.x,y:Math.sin(f+Math.PI/2)*(d/2)+b.y},h={x:Math.cos(f)*e+g.x,y:Math.sin(f)*e+g.y},i={x:Math.cos(f+1.5*Math.PI)*d+h.x,y:Math.sin(f+1.5*Math.PI)*d+h.y},j={x:Math.cos(f+Math.PI)*e+i.x,y:Math.sin(f+Math.PI)*e+i.y},k=a.Drawing.Utilities.getClosedPathString(!0,[g.x,g.y,h.x,h.y,i.x,i.y,j.x,j.y]);return console.log(k),k},b.distance=function(a,b,c,d){return Math.sqrt(Math.pow(c-a,2)+Math.pow(d-b,2))},b.theta=function(a,b,c,d){var e=Math.atan2(d-b,c-a);return e==Math.PI?0:e},b.toDegrees=function(a){return a*(180/Math.PI)},b.toRadians=function(a){return a*(Math.PI/180)},b}();b.Utilities=c}(b=a.Drawing||(a.Drawing={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c,d){if(a.Utilities.isNullOrUndefined(c))throw new Error("Layer constructor(): actionable is null or undefined");b.call(this),b.prototype.setContext.call(this,this),this.actionable=c,this.type=d,this.visible=!0,this.name="",this.layers=new a.Models.LayerCollection;var e=this;this.onModified(function(){e.setModified(!0)})}return __extends(c,b),c.prototype.containsLayer=function(a){if(!this.hasLayers())return!1;var b=this;return this.guid==a.guid||this.layers.hasElementWhich(function(a,c){return b.guid==a.guid})},c.prototype.containsLayerType=function(a){if(!this.hasLayers())return!1;var b=this;return this.type==a||this.layers.hasElementWhich(function(a,c){return b.type==a.type})},c.prototype.addLayer=function(a,b){this.layers.listen(!1),this.hasLayers()&&this.layers.add(a),this.hasGraphics()&&this.actionable.graphics.set.push(a.actionable.graphics),this.layers.listen(!0)},c.prototype.removeLayer=function(a){a.guid==this.guid?this.remove():this.hasLayers()&&this.layers.forEach(function(b,c){b.removeLayer(a)})},c.prototype.removeLayerByType=function(a){a==this.type?this.remove():this.hasLayers()&&(this.layers.forEach(function(b,c){b.removeLayerByType(a)}),this.layers.removeWhere(function(b){return b.type==a}))},c.prototype.removeAllLayers=function(){this.hasLayers()&&this.layers.removeAll()},c.prototype.toFront=function(){this.hasGraphics()&&this.actionable.graphics.toFront(),this.hasLayers()&&this.layers.forEach(function(a,b){a&&a.actionable.graphics&&a.actionable.graphics.toFront()})},c.prototype.toBack=function(){this.hasLayers()&&this.layers.forEach(function(a,b){a&&a.actionable.graphics&&a.actionable.graphics.toBack()})},c.prototype.show=function(){this.visible=!0,this.hasGraphics()&&this.actionable.graphics.show(),this.showLayers()},c.prototype.showLayers=function(){this.visible=!0,this.hasLayers()&&this.layers.forEach(function(a,b){a.show()})},c.prototype.hide=function(){this.visible=!1,this.hasGraphics()&&this.actionable.graphics.hide(),this.hideLayers()},c.prototype.hideLayers=function(){this.hasLayers()&&this.layers.forEach(function(a,b){a.hide()})},c.prototype.remove=function(){this.removeGraphics(),this.removeAllLayers()},c.prototype.removeGraphics=function(){this.hasGraphics()&&this.actionable.graphics.remove()},c.prototype.moveByDelta=function(a,b){this.hasGraphics()&&this.actionable.graphics.moveByDelta(a,b),this.hasLayers()&&this.layers.forEach(function(c,d){c.moveByDelta(a,b)})},c.prototype.drop=function(){this.hasGraphics()&&this.actionable.graphics.drop(),this.hasLayers()&&this.layers.forEach(function(a,b){a.drop()})},c.prototype.hasLayers=function(){return null!=this.layers&&void 0!=this.layers},c.prototype.hasGraphics=function(){return a.Utilities.isNotNullOrUndefined(this.actionable)&&a.Utilities.isNotNullOrUndefined(this.actionable.graphics)},c.prototype.hasPlacement=function(){return this.hasGraphics()&&this.actionable.graphics.hasPlacement()},c.prototype.draw=function(){this.hasGraphics()&&this.actionable.graphics.draw(),this.hasLayers()&&this.layers.hasElements()&&this.layers.forEach(function(a,b){a.draw()})},c.prototype.flip=function(){this.hasGraphics()&&this.actionable.graphics.flip(this.actionable.flippable),this.hasLayers()&&this.layers.forEach(function(a,b){a.flip()})},c}(a.Models.Modifiable);b.Layer=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(a){function b(){a.call(this),this.onModified(function(){})}return __extends(b,a),b.prototype.dragAll=function(a,b){},b.prototype.removeAll=function(){this.forEach(function(a,b){a.remove()}),a.prototype.removeAll.call(this)},b.prototype.drop=function(){this.forEach(function(a,b){a.hasGraphics()&&a.actionable.drop()})},b.prototype.hide=function(){this.forEach(function(a,b){a.hasGraphics()&&(a.actionable.graphics.hide(),a.actionable.graphics.hasSet()&&a.actionable.graphics.set.hide())})},b}(a.Models.Collection);b.LayerCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(a){var b=function(){function a(a){this.context=a,this.actions={}}return a.prototype.listen=function(a,b){this.actions.hasOwnProperty[a]||(this.actions[a]=[]),this.actions[a].push(b)},a.prototype.invoke=function(a,b){if(this.actions[a])for(var c=0;c<this.actions[a].length;c++)this.actions[a][c](b,this.context)},a}();a.CanvasListener=b}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(){function b(b,c,d){this.canvas=b,this.cols=c,this.rows=d,this.dimensions=new a.Models.Dimensions,this.dimensions.offset.x=0,this.size=this.resize(this.canvas.sizingMode),this.base=Playbook.Constants.GRID_BASE,this.divisor=2,this.dashArray=["- "],this.verticalStrokeOpacity=.2,this.horizontalStrokeOpacity=.25,this.strokeWidth=.5,this.color="#000000",this.snapping=!0}return b.prototype.getSize=function(){return this.size},b.prototype.getWidth=function(){return this.dimensions.width},b.prototype.getHeight=function(){return this.dimensions.height},b.prototype.setSnapping=function(a){this.snapping=a},b.prototype.toggleSnapping=function(){this.snapping=!this.snapping},b.prototype.draw=function(){for(var b=this.cols,c=this.rows,d=1;b>=d;d++){var e=d*this.size,f=a.Drawing.Utilities.getPathString(!0,[e,0,e,c*this.size]);this.canvas.drawing.path(f).attr({"stroke-dasharray":this.dashArray,"stroke-opacity":this.verticalStrokeOpacity,"stroke-width":this.strokeWidth,stroke:this.color,"class":"pointer-events-none"})}for(var g=1;c>=g;g++){var h,i=g*this.size,f=a.Drawing.Utilities.getPathString(!0,[this.getSize(),i,this.dimensions.width,i]);if(g%10==0){if(g>10&&100>g){var j=g-10;j>50&&(j-=2*(j-50));var k=j.toString();this.canvas.drawing.text(2,g,k,!1).transform("r-90").attr({"class":"no-highlight"}),this.canvas.drawing.text(50,g,k,!1).transform("r90").attr({"class":"no-highlight"})}h=1,this.canvas.drawing.path(f).attr({"stroke-opacity":this.horizontalStrokeOpacity,"stroke-width":3,stroke:"#ffffff","class":"pointer-events-none"})}else this.canvas.drawing.path(f).attr({"stroke-dasharray":this.dashArray,"stroke-opacity":this.horizontalStrokeOpacity,"stroke-width":this.strokeWidth,stroke:this.color,"class":"pointer-events-none"})}},b.prototype.resize=function(b){if(this.cols<=0)throw new Error("Grid cols must be defined and greater than 0");var c=this.canvas.dimensions.width;if(0==c)throw new Error("Grid canvas width must be greater than 0");switch(this.canvas.sizingMode){case a.Enums.CanvasSizingModes.TargetGridWidth:this.size=Playbook.Constants.GRID_SIZE;break;case a.Enums.CanvasSizingModes.MaxContainerWidth:this.size=Math.floor(this.canvas.dimensions.width/this.cols);break;case a.Enums.CanvasSizingModes.PreviewWidth:this.size=this.canvas.dimensions.width/this.cols}return this.dimensions.width=this.cols*this.size,this.dimensions.height=this.rows*this.size,this.size},b.prototype.bottom=function(){return this.rows},b.prototype.right=function(){return this.cols},b.prototype.getCenter=function(){return new a.Models.Coordinates(Math.round(this.cols/2)+this.dimensions.offset.x,Math.round(this.rows/2))},b.prototype.getCenterInPixels=function(){var a=this.getCenter();return this.getAbsoluteFromCoordinates(a.x,a.y)},b.prototype.getCursorOffset=function(b,c){var d=b+this.canvas.x-this.getSize(),e=c+this.canvas.y-10*this.getSize();return new a.Models.Coordinates(d,e)},b.prototype.getCursorPositionAbsolute=function(a,b){return this.getCursorOffset(a,b)},b.prototype.getCursorPositionCoordinates=function(a,b){var c=this.getCursorOffset(a,b);return this.getCoordinatesFromAbsolute(c.x,c.y)},b.prototype.getCoordinates=function(){return new a.Models.Coordinates(-1,-1)},b.prototype.getDimensions=function(){return this.dimensions},b.prototype.gridProportion=function(){return this.size/this.base},b.prototype.computeGridZoom=function(a){return a*this.gridProportion()},b.prototype.getAbsoluteFromCoordinate=function(a){return a*this.size},b.prototype.getAbsoluteFromCoordinates=function(b,c){var d=new a.Models.Coordinates(b,c),e=new a.Models.Coordinates(this.getAbsoluteFromCoordinate(d.x+this.dimensions.offset.x),this.getAbsoluteFromCoordinate(d.y));return e},b.prototype.getCoordinatesFromAbsolute=function(b,c){var d=Math.round(b/this.size*this.divisor)/this.divisor,e=Math.round(c/this.size*this.divisor)/this.divisor;return new a.Models.Coordinates(d+this.dimensions.offset.x,e)},b.prototype.getRelativeFromAbsolute=function(a,b,c){throw new Error("grid getRelativeFromAbsolute(): not implemented")},b.prototype.snapToNearest=function(a,b){return this.getCoordinatesFromAbsolute(a,b)},b.prototype.snap=function(b,c){var d=new a.Models.Coordinates(b,c),e=this.snapPixel(d.x),f=this.snapPixel(d.y);return new a.Models.Coordinates(e,f)},b.prototype.snapPixel=function(a){return Math.round(a/(this.size/this.divisor))*(this.size/this.divisor)+this.dimensions.offset.x},b.prototype.isDivisible=function(a){return a%(this.size/this.divisor)==0},b}();b.Grid=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){b.call(this,a.Enums.ImpaktDataTypes.Unknown),b.prototype.setContext.call(this,this),this.canvas=c,this.grid=this.canvas.grid,this.scenario=null,this.primaryPlayers=new a.Models.PlayerCollection,this.opponentPlayers=new a.Models.PlayerCollection,this.selectedElements=new a.Models.Collection,this.layer=new a.Models.Layer(this,a.Enums.LayerTypes.Field),this.cursorCoordinates=new a.Models.Coordinates(0,0);var d=this;this.selectedElements.onModified(function(){d.setModified(!0)}),this.primaryPlayers.onModified(function(){d.setModified(!0)}),this.opponentPlayers.onModified(function(){d.setModified(!0)})}return __extends(c,b),c.prototype.draw=function(){this.ground.draw(),this.grid.draw(),this.los.draw(),this.ball.draw()},c.prototype.clearPlayers=function(){this.clearPrimaryPlayers(),this.clearOpponentPlayers()},c.prototype.clearPrimaryPlayers=function(){this.primaryPlayers.listen(!1);this.layer.removeLayerByType(a.Enums.LayerTypes.PrimaryPlayer),this.primaryPlayers.removeAll(),this.primaryPlayers.listen(!0)},c.prototype.clearOpponentPlayers=function(){this.opponentPlayers.listen(!1),this.layer.removeLayerByType(a.Enums.LayerTypes.OpponentPlayer),this.opponentPlayers.removeAll(),this.opponentPlayers.listen(!0)},c.prototype.clearScenario=function(){this.clearPrimaryPlay(),this.clearOpponentPlay(),this.invokeListener("onclear")},c.prototype.clearPrimaryPlay=function(){this.clearPrimaryPlayers()},c.prototype.clearOpponentPlay=function(){this.clearOpponentPlayers()},c.prototype.drawScenario=function(){this.scenario.draw(this)},c.prototype.updateScenario=function(b){this.state=a.Enums.State.Updating,this.clearScenario(),this.scenario=b,this.drawScenario(),this.state=a.Enums.State.Ready,this.invokeListener("onload"),this.setModified(!0)},c.prototype.updatePlacements=function(){var b=this;if(a.Utilities.isNotNullOrUndefined(this.scenario)){if(a.Utilities.isNotNullOrUndefined(this.scenario.playPrimary)){var c=new a.Models.PlacementCollection;this.primaryPlayers.forEach(function(a,b){c.add(a.graphics.placement)}),b.scenario.playPrimary.formation.setPlacements(c)}if(a.Utilities.isNotNullOrUndefined(this.scenario.playOpponent)){var d=new a.Models.PlacementCollection;this.opponentPlayers.forEach(function(a,b){d.add(a.graphics.placement)}),b.scenario.playOpponent.formation.setPlacements(d)}}},c.prototype.setCursorCoordinates=function(a,b){this.cursorCoordinates=this.grid.getCursorPositionCoordinates(a,b),this.setModified(!0)},c.prototype.getPrimaryPlayerWithPositionIndex=function(a){var b=this.primaryPlayers.filterFirst(function(b){return b.hasPosition()&&b.position.index==a});return b},c.prototype.getOpponentPlayerWithPositionIndex=function(a){var b=this.opponentPlayers.filterFirst(function(b){return b.hasPosition()&&b.position.index==a});return b},c.prototype.applyPrimaryPlay=function(a){throw new Error("field applyPrimaryPlay() not implemented")},c.prototype.applyFormation=function(b,c){if(!a.Utilities.isNullOrUndefined(b)&&!a.Utilities.isNullOrUndefined(this.scenario)){var d=b.copy(),e=null,f=null;switch(c){case Playbook.Enums.PlayTypes.Primary:e=this.primaryPlayers,f=this.scenario.playPrimary;break;case Playbook.Enums.PlayTypes.Opponent:e=this.opponentPlayers,f=this.scenario.playOpponent}if(e&&f){e.forEach(function(a,b){var c=a.position.index;if(0>c)throw new Error("Player must have a position index");var e=d.placements.getIndex(c);if(!e)throw new Error("Updated player placement is invalid");a.setPlacement(e),a.draw()}),c==Playbook.Enums.PlayTypes.Opponent&&d.placements.flip(),f.setFormation(d)}}},c.prototype.applyAssignmentGroup=function(b,c){if(!a.Utilities.isNullOrUndefined(b)&&!a.Utilities.isNullOrUndefined(this.scenario)){var d=null;switch(c){case Playbook.Enums.PlayTypes.Primary:d=this.scenario.playPrimary;break;case Playbook.Enums.PlayTypes.Opponent:d=this.scenario.playOpponent}if(d){var e=this;b.assignments.hasElements()&&(b.assignments.forEach(function(b,d){if(!a.Utilities.isNullOrUndefined(b)){var f=null;switch(c){case Playbook.Enums.PlayTypes.Primary:f=e.getPrimaryPlayerWithPositionIndex(b.positionIndex);break;case Playbook.Enums.PlayTypes.Opponent:f=e.getOpponentPlayerWithPositionIndex(b.positionIndex)}f&&(f.setAssignment(b),f.draw())}}),d.setAssignmentGroup(b))}}},c.prototype.applyPersonnel=function(b,c){if(!a.Utilities.isNullOrUndefined(b)&&!a.Utilities.isNullOrUndefined(this.scenario)){var d=null,e=null;switch(c){case Playbook.Enums.PlayTypes.Primary:d=this.primaryPlayers,e=this.scenario.playPrimary;break;case Playbook.Enums.PlayTypes.Opponent:d=this.opponentPlayers,e=this.scenario.playOpponent}if(d&&e){if(b&&b.hasPositions())d.forEach(function(a,c){var d=b.positions.getIndex(c);e.personnel&&e.personnel.hasPositions()&&e.personnel.positions.getIndex(c).fromJson(d.toJson()),a.position.fromJson(d.toJson()),a.draw()}),e.setPersonnel(b);else{var f=b?"# positions: "+b.positions.size():"Personnel is undefined.";alert(["There was an error applying this personnel group. ","Please inspect it in the Team Management module. \n\n",f].join(""))}}}},c.prototype.deselectAll=function(){this.selectedElements.isEmpty()||(this.selectedElements.forEach(function(a,b){a.deselect()}),this.selectedElements.removeAll())},c.prototype.getSelectedByLayerType=function(b){var c=new a.Models.Collection;return this.selectedElements.forEach(function(a,d){a.layer.type==b&&c.add(a)}),c},c.prototype.toggleSelectionByLayerType=function(a){var b=this.selectedElements.filter(function(b,c){return b.layer.type==a});if(b&&b.length>0)for(var c=0;c<b.length;c++){var d=b[c];d&&this.toggleSelection(d)}},c.prototype.setSelection=function(a){this.selectedElements.forEach(function(a,b){a.deselect()}),this.selectedElements.removeAll(),a.select(),this.selectedElements.add(a)},c.prototype.toggleSelection=function(a){this.selectedElements.contains(a.guid)?(this.selectedElements.remove(a.guid),a.deselect()):(this.selectedElements.add(a),a.select())},c.prototype.getLOSAbsolute=function(){if(!this.los)throw new Error("Field getLOSAbsolute(): los is null or undefined");return this.los.graphics.location.ay},c}(a.Models.Actionable);b.Field=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this,a.Enums.ImpaktDataTypes.Unknown),this.contextmenuTemplateUrl=a.Constants.DEFAULT_CONTEXTMENU_TEMPLATE_URL}return __extends(c,b),c.prototype.initialize=function(b,c){this.field=b,this.ball=this.field.ball,this.relativeElement=c,this.canvas=this.field.canvas,this.grid=this.canvas.grid,this.graphics=new a.Models.Graphics(this.canvas),this.layer=new a.Models.Layer(this,a.Enums.LayerTypes.FieldElement),this._originalScreenPositionX=null,this._originalScreenPositionY=null;var d=this;this.onModified(function(){d.field.setModified(!0)})},c.prototype.getContextmenuUrl=function(){return this.contextmenuTemplateUrl},c.prototype.hasLayer=function(){return null!=this.layer&&void 0!=this.layer},c.prototype.getLayer=function(){return this.layer},c.prototype.getGraphics=function(){return this.hasGraphics()?this.graphics:null},c.prototype.hasPlacement=function(){return this.layer.hasPlacement()},c.prototype.hoverIn=function(a){},c.prototype.hoverOut=function(a){},c.prototype.click=function(a){console.log("fieldelement click"),this.disabled||this.toggleSelect(a.metaKey)},c.prototype.toggleSelect=function(a){a=a===!0,b.prototype.toggleSelect.call(this),a?this.field.toggleSelection(this):this.field.setSelection(this)},c.prototype.mousedown=function(b){b.keyCode==a.Input.Which.RightClick&&this.contextmenu(b)},c.prototype.dragMove=function(a,b,c,d,e){},c.prototype.dragStart=function(a,b,c){this.setOriginalDragPosition(a,b)},c.prototype.dragEnd=function(a){this.setOriginalDragPosition(null,null),this.dragging=!1},c.prototype.drop=function(){this.layer.drop()},c.prototype.getOriginalScreenPosition=function(){return{x:this._originalScreenPositionX,y:this._originalScreenPositionY}},c.prototype.setOriginalDragPosition=function(a,b){this._originalScreenPositionX=a,this._originalScreenPositionY=b},c.prototype.isOriginalDragPositionSet=function(){return!a.Utilities.isNull(this._originalScreenPositionX)&&!a.Utilities.isNull(this._originalScreenPositionY)},c.prototype.isOverDragThreshold=function(a,b){return Math.abs(a)>Playbook.Constants.DRAG_THRESHOLD_X||Math.abs(b)>Playbook.Constants.DRAG_THRESHOLD_Y},c}(a.Models.Actionable);b.FieldElement=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.initialize=function(c){b.prototype.initialize.call(this,c,null),this.layer.type=a.Enums.LayerTypes.Ball,this.graphics.fill="brown",this.graphics.dimensions.setWidth(.15*this.grid.getSize()),this.graphics.dimensions.setHeight(.25*this.grid.getSize()),this.graphics.initializePlacement(new a.Models.Placement(Playbook.Constants.BALL_DEFAULT_PLACEMENT_X,Playbook.Constants.BALL_DEFAULT_PLACEMENT_Y,null))},c.prototype.draw=function(){this.graphics.ellipse()},c}(a.Models.FieldElement);b.Ball=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.initialize=function(c,d){b.prototype.initialize.call(this,c,null),this.selectable=!1,this.graphics.initializePlacement(new a.Models.Placement(this.canvas.x,this.canvas.y,null)),this.graphics.dimensions.setWidth(this.grid.dimensions.width+2),this.graphics.dimensions.setHeight(this.grid.dimensions.height+2),this.graphics.setOriginalOpacity(1),this.graphics.setOriginalStrokeWidth(0),this.graphics.setOriginalFill(Playbook.Constants.FIELD_COLOR)},c.prototype.draw=function(){this.graphics.rect(),this.graphics.onclick(this.click,this)},c.prototype.click=function(a){console.log("ground clicked")},c.prototype.getClickCoordinates=function(a,b){var c=this.getClickAbsolute(a,b);return this.grid.getCoordinatesFromAbsolute(c.x,c.y)},c.prototype.getClickAbsolute=function(b,c){return new a.Models.Coordinates(b+this.graphics.dimensions.offset.x-Math.abs(this.canvas.x),c+Math.abs(this.canvas.y)+this.graphics.dimensions.offset.y)},c}(a.Models.FieldElement);b.Ground=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.initialize=function(c){b.prototype.initialize.call(this,c,null),this.layer.type=a.Enums.LayerTypes.LineOfScrimmage,this.graphics.setOriginalFill("yellow"),this.graphics.setOriginalStrokeWidth(0),this.graphics.setOriginalOpacity(1),this.graphics.dimensions.width=this.grid.dimensions.width-2*this.grid.getSize(),this.graphics.dimensions.height=1,this.graphics.initializePlacement(new a.Models.Placement(1,this.field.ball.graphics.placement.coordinates.y,null))},c}(a.Models.FieldElement);b.LineOfScrimmage=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this),this.offsetY=a}return __extends(c,b),c.prototype.initialize=function(c){b.prototype.initialize.call(this,c,null),this.layer.type=a.Enums.LayerTypes.Endzone,this.graphics.fill="black",this.graphics.setOpacity(.25),this.graphics.initializePlacement(new a.Models.Placement(1,this.offsetY,null)),this.graphics.dimensions.setWidth(this.canvas.getWidth()-2*this.grid.getSize()),this.graphics.dimensions.setHeight(10*this.grid.getSize())},c.prototype.draw=function(){this.graphics.rect()},c}(a.Models.FieldElement);b.Endzone=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this),this.offsetX=a}return __extends(c,b),c.prototype.initialize=function(c){b.prototype.initialize.call(this,c,null),this.layer.type=a.Enums.LayerTypes.Hashmark,this.graphics.dimensions.offset.x=-.25*this.grid.getSize(),this.graphics.dimensions.offset.y=0,this.graphics.initializePlacement(new a.Models.Placement(this.offsetX,0,null)),this.start=11,this.yards=110},c.prototype.draw=function(){for(var a=this.grid.getSize()/2,b=this.start;b<this.yards;b++){this.canvas.drawing.rect(this.graphics.placement.coordinates.x,b,a,1,!1,this.graphics.dimensions.offset.x,0).attr({fill:"white","stroke-width":0})}},c}(a.Models.FieldElement);b.Hashmark=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this),this.offsetX=a}return __extends(c,b),c.prototype.initialize=function(c){b.prototype.initialize.call(this,c,null),this.graphics.fill="white",this.graphics.strokeWidth=0,this.graphics.initializePlacement(new a.Models.Placement(this.offsetX,0,null)),this.graphics.dimensions.width=this.grid.getSize(),this.graphics.dimensions.height=this.grid.getHeight()},c.prototype.draw=function(){this.graphics.rect()},c}(a.Models.FieldElement);b.Sideline=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.initialize=function(c,d){b.prototype.initialize.call(this,c,null),this.graphics.setOriginalFill("#1752FA"),this.graphics.setOriginalStroke("#202BA2"),this.graphics.setOriginalFillOpacity(.3),this.graphics.setOriginalStrokeWidth(1),this.graphics.dimensions.setHeight(0),this.graphics.dimensions.setWidth(0),this.graphics.initializePlacement(new a.Models.Placement(0,0,null))},c.prototype.draw=function(){this.graphics.rect()},c}(a.Models.FieldElement);b.FieldSelectionBox=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c,d,e){b.call(this),this.placement=c,this.position=d,this.unitType=this.position?this.position.unitType:Team.Enums.UnitTypes.Other,this.assignment=e||new a.Models.Assignment(this.unitType),this.flippable=!0,a.Utilities.isNotNullOrUndefined(this.assignment)&&a.Utilities.isNotNullOrUndefined(this.position)&&(this.assignment.positionIndex=this.position.index)}return __extends(c,b),c.prototype.initialize=function(c){b.prototype.initialize.call(this,c,c.ball),this.layer.type=a.Enums.LayerTypes.Player,this.graphics.initializePlacement(this.placement),this.placement.setRelativeElement(this.field.ball),this.graphics.dimensions.setWidth(this.grid.getSize()),this.graphics.dimensions.setHeight(this.grid.getSize()),this.layer.addLayer(this.assignment.layer);var d=this;this.layer.onModified(function(){d.setModified(!0)}),this.field.layer.addLayer(this.layer)},c.prototype.flip=function(){this.layer.flip(),a.Utilities.isNotNullOrUndefined(this.assignment)&&this.assignment.flip(),this.flipped=!this.flipped},c.prototype.remove=function(){this.layer.remove()},c.prototype.drop=function(){b.prototype.drop.call(this),a.Utilities.isNotNullOrUndefined(this.assignment)&&this.assignment.drop()},c.prototype.getPositionRelativeToBall=function(){return this.graphics.placement.relative},c.prototype.getCoordinatesFromAbsolute=function(){return this.graphics.placement.coordinates},c.prototype.hasAssignment=function(){return a.Utilities.isNullOrUndefined(this.assignment)},c.prototype.getAssignment=function(){return this.assignment},c.prototype.setAssignment=function(b){a.Utilities.isNotNullOrUndefined(this.assignment)&&this.layer.removeLayer(this.assignment.layer),this.assignment=b,this.layer.addLayer(this.assignment.layer)},c.prototype.hasPosition=function(){return a.Utilities.isNullOrUndefined(this.position)},c.prototype.getPosition=function(){return this.position},c.prototype.setPosition=function(a){this.position=a,this.setModified(!0)},c.prototype.hasPlacement=function(){return a.Utilities.isNullOrUndefined(this.graphics.placement)},c.prototype.getPlacement=function(){return this.graphics.placement},c.prototype.setPlacement=function(a){this.graphics.initializePlacement(a),this.assignment.refresh(),this.setModified(!0)},c}(a.Models.FieldElement);b.Player=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(a){function b(){a.call(this),this.onModified(function(){})}return __extends(b,a),b}(a.Models.Collection);b.PlayerCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){b.call(this),this.player=c,this.initialize(this.player.field,this.player),this.layer.type=a.Enums.LayerTypes.PlayerSelectionBox,this.selectable=!1,this.graphics.setOriginalOpacity(1),this.graphics.setOriginalFill(""),this.graphics.setOriginalStroke("blue"),this.graphics.setOriginalStrokeWidth(1),this.graphics.dimensions.width=this.player.graphics.dimensions.getWidth(),this.graphics.dimensions.height=this.player.graphics.dimensions.getHeight(),this.graphics.setOffsetXY(-this.player.graphics.dimensions.getWidth()/2,-this.player.graphics.dimensions.getHeight()/2),this.graphics.initializePlacement(new a.Models.Placement(0,0,this.player))}return __extends(c,b),c.prototype.draw=function(){this.graphics.initializePlacement(new a.Models.Placement(0,0,this.player)),this.graphics.rect(),this.graphics.hide()},c}(a.Models.FieldElement);b.PlayerSelectionBox=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){b.call(this),this.player=c,this.initialize(this.player.field,this.player),this.layer.type=a.Enums.LayerTypes.PlayerIcon,this.graphics.dimensions.setRadius(this.grid.getSize()/2),this.graphics.dimensions.setWidth(this.player.graphics.dimensions.getWidth()),this.graphics.dimensions.setHeight(this.player.graphics.dimensions.getHeight()),this.graphics.initializePlacement(new a.Models.Placement(0,0,this.player)),this.flippable=!0}return __extends(c,b),c.prototype.draw=function(){switch(this.player.unitType){case Team.Enums.UnitTypes.Offense:this.graphics.setOffsetXY(0,0),this.graphics.initializePlacement(new a.Models.Placement(0,0,this.player)),this.graphics.circle();break;case Team.Enums.UnitTypes.Defense:this.graphics.setOffsetXY(0,0),this.graphics.initializePlacement(new a.Models.Placement(0,0,this.player)),this.graphics.triangle();break;case Team.Enums.UnitTypes.SpecialTeams:this.graphics.setOffsetXY(-(this.graphics.dimensions.getWidth()/2),-(this.graphics.dimensions.getHeight()/2)),this.graphics.initializePlacement(new a.Models.Placement(0,0,this.player)),this.graphics.rect();break;case Team.Enums.UnitTypes.Other:this.graphics.setOffsetXY(-(this.graphics.dimensions.getWidth()/2),-(this.graphics.dimensions.getHeight()/2)),
this.graphics.initializePlacement(new a.Models.Placement(0,0,this.player)),this.graphics.rhombus()}},c}(a.Models.FieldElement);b.PlayerIcon=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){b.call(this),this.player=c,this.initialize(this.player.field,this.player),this.layer.type=a.Enums.LayerTypes.PlayerRelativeCoordinatesLabel,this.selectable=!1,this.graphics.snapping=!1,this.graphics.setOffsetXY(0,this.grid.getSize()),this.graphics.initializePlacement(new a.Models.Placement(0,0,this.player))}return __extends(c,b),c.prototype.draw=function(){this.graphics.initializePlacement(new a.Models.Placement(0,0,this.player)),this.graphics.text([this.player.graphics.placement.relative.rx,", ",this.player.graphics.placement.relative.ry].join("")),this.graphics.setAttribute("class","no-highlight"),this.layer.hide()},c}(a.Models.FieldElement);b.PlayerRelativeCoordinatesLabel=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){b.call(this),this.player=c,this.initialize(this.player.field,this.player),this.layer.type=a.Enums.LayerTypes.PlayerPersonnelLabel,this.selectable=!1,this.graphics.snapping=!1,this.graphics.setOffsetXY(0,.1*-(this.player.graphics.dimensions.getHeight()/2)),this.graphics.initializePlacement(new a.Models.Placement(0,0,this.player))}return __extends(c,b),c.prototype.draw=function(){this.graphics.initializePlacement(new a.Models.Placement(0,0,this.player)),this.graphics.text(this.player.position.label),this.graphics.setAttribute("class","no-highlight")},c}(a.Models.FieldElement);b.PlayerPersonnelLabel=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){b.call(this),this.player=c,this.initialize(this.player.field,this.player),this.layer.type=a.Enums.LayerTypes.PlayerIndexLabel,this.selectable=!1,this.graphics.snapping=!1,this.graphics.setOffsetXY(0,this.player.graphics.dimensions.getHeight()/2*.6),this.graphics.initializePlacement(new a.Models.Placement(0,0,this.player))}return __extends(c,b),c.prototype.draw=function(){this.graphics.initializePlacement(new a.Models.Placement(0,0,this.player)),this.graphics.text(this.player.position.index.toString()),this.graphics.setAttribute("class","no-highlight")},c}(a.Models.FieldElement);b.PlayerIndexLabel=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){b.call(this),this.dragInitialized=c===!0,this.type=a.Enums.RouteTypes.Generic,this.flippable=!0,this.unitType=Team.Enums.UnitTypes.Other}return __extends(c,b),c.prototype.toJson=function(){return{nodes:this.nodes.toJson(),type:this.type,guid:this.guid,unitType:this.unitType}},c.prototype.fromJson=function(b){if(a.Utilities.isNullOrUndefined(this.player))throw new Error("Route fromJson(): setPlayer() must be called before serializing from json");if(this.guid=b.guid,this.type=b.type,this.unitType=b.unitType,b.nodes){this.nodes.listen(!1);for(var c=0;c<b.nodes.length;c++){var d=b.nodes[c],e=new a.Models.RelativeCoordinates(0,0,this.player);a.Utilities.isNotNullOrUndefined(d.relative)&&e.fromJson(d.relative);var f=null;switch(d.renderType){case a.Enums.RenderTypes.Preview:f=new Playbook.Models.PreviewRouteNode(e,d.type);break;case a.Enums.RenderTypes.Editor:f=new Playbook.Models.EditorRouteNode(e,d.type)}f.initialize(this.field,this),f.fromJson(d),0==c&&(f.layer.toBack(),f.disable()),this.addNode(f,!1)}this.nodes.listen(!0)}},c.prototype.setPlayer=function(b){if(this.player=b,this.unitType=this.player.unitType,this.initialize(this.player.field,this.player),this.graphics.initializePlacement(this.player.graphics.placement),this.player){this.nodes=new a.Models.LinkedList;var c=this;this.nodes.onModified(function(){c.setModified(!0)})}this.layer.type=a.Enums.LayerTypes.PlayerRoute,a.Utilities.isNotNullOrUndefined(this.player)&&a.Utilities.isNotNullOrUndefined(this.player.assignment)&&this.player.assignment.layer.addLayer(this.layer)},c.prototype.setPlacement=function(a){this.nodes.forEach(function(b,c){b.setPlacement(a)})},c.prototype.refresh=function(){this.nodes.forEach(function(a,b){a.refresh()})},c.prototype.remove=function(){this.routePath.remove(),this.nodes.forEach(function(a,b){a.layer.remove()})},c.prototype.draw=function(){if(!this.player)throw new Error("Route player is not set");this.routePath.pathString=this.getMixedStringFromNodes(this.nodes.toArray()),this.routePath.draw(),this.bringNodesToFront(),this.player.assignment.updateRouteArray()},c.prototype.drawCurve=function(a){if(!this.player)throw new Error("Route player is not set");this.routePath.pathString=this.getCurveStringFromNodes(!0,this.nodes.toArray()),this.routePath.draw(),this.bringNodesToFront()},c.prototype.drawLine=function(){if(!this.player)throw new Error("Route player is not set");this.routePath.pathString=this.getPathStringFromNodes(!0,this.nodes.toArray()),this.routePath.draw(),this.bringNodesToFront()},c.prototype.bringNodesToFront=function(){this.nodes.forEach(function(a){a.layer.toFront()}),this.player.layer.toFront(),this.routePath.layer.toBack()},c.prototype.addNode=function(b,c){if(this.nodes.isEmpty()&&b.type!=a.Enums.RouteNodeTypes.Root&&b.type!=a.Enums.RouteNodeTypes.CurveStart)throw new Error("Route addNode(): first route node must be of type Root or CurveStart");return this.nodes.add(b),b.draw(),b.type==a.Enums.RouteNodeTypes.Root&&this.disableRootNode(b),this.draw(),b},c.prototype.disableRootNode=function(a){a.layer.toBack(),a.layer.hide(),a.disable()},c.prototype.getLastNode=function(){return null},c.prototype.flip=function(){this.nodes.forEach(function(a){a.flip()}),this.flipped=!this.flipped,this.draw()},c.prototype.getMixedStringFromNodes=function(b){if(!b||b.length<=1)return"";for(var c="",d=0;d<b.length;d++){var e=b[d];if(!a.Utilities.isNullOrUndefined(e)){if(!e.next)break;var f=e.type,g=e.next.type;if(f==a.Enums.RouteNodeTypes.CurveStart){if(g!=a.Enums.RouteNodeTypes.CurveControl)throw new Error("A curve start node must be followed by a curve control node");if(!e.next.next)throw new Error("a curve must have a control and end node");var h=e.next.next.type;if(h!=a.Enums.RouteNodeTypes.CurveEnd)throw new Error("A curve must end with a curve end node");c+=this.getCurveStringFromNodes(!0,[e,e.next,e.next.next]),d++}else if(f==a.Enums.RouteNodeTypes.CurveEnd){if(0==d)throw new Error("curveEnd node cannot be the first node");if(g==a.Enums.RouteNodeTypes.CurveControl){if(!e.next.next)throw new Error("a curve must have a control and end node");var h=e.next.next.type;if(h!=a.Enums.RouteNodeTypes.CurveEnd)throw new Error("A curve must end with a curve end node");c+=this.getCurveStringFromNodes(!1,[e,e.next,e.next.next]),d++}else c+=this.getPathStringFromNodes(!1,[e,e.next])}else c+=this.getPathStringFromNodes(0==d,[e,e.next])}}return c},c.prototype.getPathStringFromNodes=function(b,c){return a.Drawing.Utilities.getPathString(b,this._prepareNodesForPath(c))},c.prototype.getCurveStringFromNodes=function(b,c){return a.Drawing.Utilities.getCurveString(b,this._prepareNodesForPath(c))},c.prototype._prepareNodesForPath=function(b){for(var c=[],d=0;d<b.length;d++){var e=b[d];a.Utilities.isNullOrUndefined(e)||c.push(e.graphics.location.ax,e.graphics.location.ay)}return c},c}(a.Models.FieldElement);b.Route=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this),this.action=a}return __extends(c,b),c.prototype.initialize=function(c,d){b.prototype.initialize.call(this,c,d),this.routeNode=d,this.disabled=this.routeNode.type==a.Enums.RouteNodeTypes.CurveControl,this.layer.type=a.Enums.LayerTypes.PlayerRouteAction,this.graphics.setOffsetXY(.5,.5),this.graphics.initializePlacement(new a.Models.Placement(0,0,this.routeNode))},c.prototype.draw=function(){a.Factories.RouteActionFactory.draw(this)},c.prototype.toJson=function(){return $.extend({action:this.action},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.action=a.action,b.prototype.fromJson.call(this,a))},c}(a.Models.FieldElement);b.RouteAction=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.toJson=function(){return a.prototype.toJson.call(this)},b.prototype.fromJson=function(a){},b}(a.Models.Collection);b.RouteCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.initialize=function(c,d){b.prototype.initialize.call(this,c,d),this.routeNode=d,this.layer.type=a.Enums.LayerTypes.PlayerRouteControlPath,this.graphics.setStroke("grey"),this.graphics.setStrokeWidth(1),this.graphics.setOpacity(.2),this.graphics.initializePlacement(new a.Models.Placement(0,0,this.routeNode))},c.prototype.toJson=function(){return{pathString:this.pathString}},c.prototype.fromJson=function(a){a&&(this.pathString=a.pathString)},c.prototype.draw=function(){},c}(a.Models.FieldElement);b.RouteControlPath=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c,d){if(b.call(this),a.Utilities.isNullOrUndefined(c))throw new Error("RouteNode constructor(): RelativeCoordinates is null or undefined");this.relativeCoordinates=c,this.type=d,this.flippable=!0}return __extends(c,b),c.prototype.initialize=function(c,d){b.prototype.initialize.call(this,c,this.relativeCoordinates.relativeElement),this.route=d,this.graphics.initializePlacement(new a.Models.Placement(this.relativeCoordinates.rx,this.relativeCoordinates.ry,this.relativeElement)),this.graphics.dimensions.radius=this.grid.getSize()/3.5,this.graphics.dimensions.width=2*this.graphics.dimensions.radius,this.graphics.dimensions.height=2*this.graphics.dimensions.radius,this.layer.type=a.Enums.LayerTypes.PlayerRouteNode,this.route.layer.addLayer(this.layer)},c.prototype.draw=function(){this.graphics.circle()},c.prototype.fromJson=function(a){a&&(this.routeAction.fromJson(a.routeAction),this.type=a.type,this.renderType=a.renderType,this.relativeCoordinates.fromJson(a.relative))},c.prototype.toJson=function(){return{relative:this.graphics.placement.relative.toJson(),type:this.type,routeAction:this.routeAction.toJson(),renderType:this.renderType,guid:this.guid}},c.prototype.isCurveNode=function(){return this.type==a.Enums.RouteNodeTypes.CurveControl||this.type==a.Enums.RouteNodeTypes.CurveEnd||this.type==a.Enums.RouteNodeTypes.CurveStart},c.prototype.setPlacement=function(a){this.graphics.initializePlacement(a)},c.prototype.refresh=function(){this.graphics.updatePlacement()},c.prototype.setAction=function(a){this.routeAction.action=a,this.routeAction.draw(),this.setModified()},c.prototype.flip=function(){this.graphics.flip(!0),this.flipped=!this.flipped},c}(a.Models.FieldElement);b.RouteNode=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.initialize=function(c,d){switch(b.prototype.initialize.call(this,c,d),this.route=d,this.unitType=this.route.unitType,this.graphics.setOriginalFill(null),this.graphics.setOriginalOpacity(1),this.unitType){case Team.Enums.UnitTypes.Offense:this.graphics.setOriginalStroke("#001199");break;case Team.Enums.UnitTypes.Defense:this.graphics.setOriginalStroke("#0063FF");break;case Team.Enums.UnitTypes.SpecialTeams:this.graphics.setOriginalStroke("black");break;case Team.Enums.UnitTypes.Other:this.graphics.setOriginalStroke("#333333");break;default:this.graphics.setOriginalStroke("#22B98F")}this.graphics.setOriginalStrokeWidth(3),this.graphics.initializePlacement(this.route.graphics.placement),this.layer.type=a.Enums.LayerTypes.PlayerRoutePath},c.prototype.toJson=function(){return{pathString:this.pathString}},c.prototype.remove=function(){this.layer.remove()},c.prototype.fromJson=function(a){a&&(this.pathString=a.pathString)},c.prototype.draw=function(){this.graphics.path(this.pathString),this.graphics.setAttribute("class","painted-fill")},c}(a.Models.FieldElement);b.RoutePath=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a,c,d,e){b.call(this),b.prototype.setContext.call(this,this),this.updateFromRelative(a,c,d),this.flipped=!1,this.index=e>=0?e:-1}return __extends(c,b),c.prototype.copy=function(c){var d=c||new a.Models.Placement(this.relative.rx,this.relative.ry,this.relativeElement);return b.prototype.copy.call(this,d,this)},c.prototype.toJson=function(){return{relative:this.relative.toJson(),coordinates:this.coordinates.toJson(),index:this.index,guid:this.guid}},c.prototype.fromJson=function(a){this.relative.fromJson(a.relative),this.coordinates.fromJson(a.coordinates),this.index=a.index,this.guid=a.guid},c.prototype.refresh=function(){var a=this.relative.getCoordinates();this.coordinates.update(a.x,a.y)},c.prototype.setRelativeElement=function(b){a.Utilities.isNotNullOrUndefined(b)&&(this.relative.relativeElement=b,this.relativeElement=b,this.grid=this.relativeElement.grid)},c.prototype.update=function(b){a.Utilities.isNullOrUndefined(b)||(this.setRelativeElement(b.relativeElement),this.fromJson(b.toJson()))},c.prototype.updateFromAbsolute=function(b,c){if(a.Utilities.isNullOrUndefined(this.grid))throw new Error("Placement updateFromAbsolute(): grid is null or undefined");var d=this.grid.getCoordinatesFromAbsolute(b,c);this.relative.updateFromGridCoordinates(d.x,d.y),this.coordinates.update(d.x,d.y)},c.prototype.updateFromCoordinates=function(a,b){this.coordinates.update(a,b),this.relative.updateFromGridCoordinates(this.coordinates.x,this.coordinates.y)},c.prototype.updateFromRelative=function(b,c,d){d?(this.relativeElement=d,this.grid=this.relativeElement.grid,this.relative=new a.Models.RelativeCoordinates(b,c,this.relativeElement),this.coordinates=this.relative.getCoordinates()):(this.coordinates=new a.Models.Coordinates(b,c),this.relative=new a.Models.RelativeCoordinates(0,0,null),this.relativeElement=null,this.grid=null)},c.prototype.flip=function(){this.updateFromRelative(-1*this.relative.rx,-1*this.relative.ry,this.relativeElement),this.flipped=!this.flipped},c}(a.Models.Modifiable);b.Placement=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this.flipped=!1}return __extends(c,b),c.prototype.fromJson=function(b){if(b){var c=this;this.empty();for(var d=0;d<b.length;d++){var e=b[d],f=new a.Models.Placement(0,0,null);f.fromJson(e),this.add(f)}this.forEach(function(a,b){a.onModified(function(){console.log("placement collection modified: placement:",a.guid),c.setModified(!0)})}),this.setModified(!0)}},c.prototype.toJson=function(){return b.prototype.toJson.call(this)},c.prototype.flip=function(){this.hasElements()&&(this.forEach(function(a,b){a.flip()}),this.flipped=!this.flipped)},c}(a.Models.Collection);b.PlacementCollection=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a,c){b.call(this),b.prototype.setContext.call(this,this),this.x=a,this.y=c}return __extends(c,b),c.prototype.toJson=function(){return{x:this.x,y:this.y}},c.prototype.fromJson=function(a){a&&(this.x=a.x,this.y=a.y)},c.prototype.update=function(a,b){this.x=a,this.y=b},c.prototype.getRelativeTo=function(b,c){return new a.Models.RelativeCoordinates(b.x-this.x,this.y-b.y,c)},c}(a.Models.Modifiable);b.Coordinates=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a,c,d){b.call(this),this.rx=a,this.ry=c,d?(this.relativeElement=d,this.distance=this.getDistance(),this.theta=this.getTheta()):(this.relativeElement=null,this.distance=0,this.theta=0)}return __extends(c,b),c.prototype.drop=function(){},c.prototype.toJson=function(){return{rx:this.rx,ry:this.ry}},c.prototype.fromJson=function(a){a&&(this.rx=a.rx,this.ry=a.ry)},c.prototype.getDistance=function(){return a.Utilities.isNullOrUndefined(this.relativeElement)?null:this.relativeElement?a.Drawing.Utilities.distance(this.rx,this.ry,this.relativeElement.graphics.placement.coordinates.x,this.relativeElement.graphics.placement.coordinates.y):null},c.prototype.getTheta=function(){return a.Utilities.isNullOrUndefined(this.relativeElement)?null:this.relativeElement?a.Drawing.Utilities.theta(this.rx,this.ry,this.relativeElement.graphics.placement.coordinates.x,this.relativeElement.graphics.placement.coordinates.y):null},c.prototype.updateFromGridCoordinates=function(b,c){a.Utilities.isNullOrUndefined(this.relativeElement)||(this.rx=b-this.relativeElement.graphics.placement.coordinates.x,this.ry=this.relativeElement.graphics.placement.coordinates.y-c)},c.prototype.updateFromAbsoluteCoordinates=function(a,b){var c=this.relativeElement.grid.getCoordinatesFromAbsolute(a,b);this.updateFromGridCoordinates(c.x,c.y)},c.prototype.getCoordinatesFromRelative=function(b,c){return a.Utilities.isNullOrUndefined(this.relativeElement)?null:new a.Models.Coordinates(this.relativeElement.graphics.placement.coordinates.x+b,this.relativeElement.graphics.placement.coordinates.y-c)},c.prototype.getCoordinates=function(){var b=this;return new a.Models.Coordinates(this.relativeElement.graphics.placement.coordinates.x+b.rx,this.relativeElement.graphics.placement.coordinates.y-b.ry)},c}(a.Models.Storable);b.RelativeCoordinates=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a,c){b.call(this),b.prototype.setContext.call(this,this),this.ax=a,this.ay=c,this.ox=this.ax,this.oy=this.ay,this.dx=0,this.dy=0}return __extends(c,b),c.prototype.toJson=function(){return{ax:this.ax,ay:this.ay,ox:this.ox,oy:this.oy,dx:this.dx,dy:this.dy}},c.prototype.fromJson=function(a){a&&(this.ax=a.ax,this.ay=a.ay,this.ox=a.ox,this.oy=a.oy,this.dx=a.dx,this.dy=a.dy)},c.prototype.drop=function(){this.ox=this.ax,this.oy=this.ay,this.dx=0,this.dy=0},c.prototype.moveByDelta=function(a,b){this.dx=a,this.dy=b,this.ax=this.ox+this.dx,this.ay=this.oy+this.dy},c.prototype.updateFromAbsolute=function(b,c){this.ax=a.Utilities.isNullOrUndefined(b)?this.ax:b,this.ay=a.Utilities.isNullOrUndefined(c)?this.ay:c,this.dx=0,this.dy=0,this.ox=this.ax,this.oy=this.ay},c.prototype.hasChanged=function(){return Math.abs(this.dx)>0||Math.abs(this.dy)>0},c}(a.Models.Modifiable);b.Location=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(c){b.call(this),b.prototype.setContext.call(this,this),this.canvas=c,this.grid=c.grid,this.placement=null,this.location=new a.Models.Location(0,0),this.dimensions=new a.Models.Dimensions,this.containment=new a.Models.Containment(0,this.grid.getWidth(),0,this.grid.getHeight()),this.originalFill="white",this.originalStroke="black",this.originalOpacity=1,this.originalFillOpacity=1,this.originalStrokeWidth=1,this.fill=this.originalFill,this.fillOpacity=this.originalFillOpacity,this.stroke=this.originalStroke,this.opacity=this.originalOpacity,this.strokeWidth=this.originalStrokeWidth,this.selectedFill="white",this.selectedFillOpacity=1,this.selectedStroke="red",this.selectedOpacity=1,this.disabledFill="#aaaaaa",this.disabledFillOpacity=1,this.disabledStroke="#777777",this.disabledOpacity=.5,this.hoverOpacity=.4,this.hoverFillOpacity=.4,this.font=this.canvas.drawing.getFont("Arial"),this.drawingHandler=new a.Models.DrawingHandler(this),this.set=new a.Models.GraphicsSet(this),this.snapping=!0}return __extends(c,b),c.prototype.toJson=function(){return{dimensions:this.dimensions.toJson(),opacity:this.opacity,fill:this.fill,fillOpacity:this.fillOpacity,stroke:this.stroke,strokeWidth:this.strokeWidth,originalOpacity:this.originalOpacity,originalFill:this.originalFill,originalFillOpacity:this.originalFillOpacity,originalStroke:this.originalStroke,originalStrokeWidth:this.originalStrokeWidth,selectedFill:this.selectedFill,selectedFillOpacity:this.selectedFillOpacity,selectedStroke:this.selectedStroke,selectedOpacity:this.selectedOpacity,disabledFillOpacity:this.disabledFillOpacity,disabledStroke:this.disabledStroke,disabledOpacity:this.disabledOpacity,hoverOpacity:this.hoverOpacity,hoverFillOpacity:this.hoverFillOpacity,placement:this.placement?this.placement.toJson():null,location:this.location?this.location.toJson():null}},c.prototype.fromJson=function(a){a&&(this.dimensions.fromJson(a.dimensions),this.opacity=a.opacity,this.fill=a.fill,this.fillOpacity=a.fillOpacity,this.stroke=a.stroke,this.strokeWidth=a.strokeWidth,this.placement.fromJson(a.placement),this.location.fromJson(a.location),this.originalOpacity=a.originalOpacity,this.originalFill=a.originalFill,this.originalFillOpacity=a.originalFillOpacity,this.originalStroke=a.originalStroke,this.originalStrokeWidth=a.originalStrokeWidth,this.selectedFill=a.selectedFill,this.selectedFillOpacity=a.selectedFillOpacity,this.selectedStroke=a.selectedStroke,this.selectedOpacity=a.selectedOpacity,this.disabledFill=a.disabledFill,this.disabledFillOpacity=a.disabledFillOpacity,this.disabledStroke=a.disabledStroke,this.disabledOpacity=a.disabledOpacity,this.hoverOpacity=a.hoverOpacity,this.hoverFillOpacity=a.hoverFillOpacity)},c.prototype.hasGraphics=function(){return this.hasRaphael()},c.prototype.hasRaphael=function(){return null!=this.raphael&&void 0!=this.raphael},c.prototype.hasSet=function(){return a.Utilities.isNotNullOrUndefined(this.set)},c.prototype.getFill=function(){return this.fill},c.prototype.setFill=function(a){return this.fill=a,this.attr({fill:this.fill})},c.prototype.setOriginalFill=function(a){return this.setFill(a),this.originalFill=a,this},c.prototype.getFillOpacity=function(){return this.fillOpacity},c.prototype.setFillOpacity=function(a){if(a>1||0>a)throw new Error("Graphics setFillOpacity(): opacity must be between 0 and 1");return this.fillOpacity=a,this.attr({"fill-opacity":this.fillOpacity})},c.prototype.setOriginalFillOpacity=function(a){return this.setFillOpacity(a),this.originalFillOpacity=a,this},c.prototype.getSelectedFill=function(){return this.selectedFill},c.prototype.setSelectedFill=function(a){return this.selectedFill=a,this},c.prototype.getSelectedFillOpacity=function(){return this.selectedFillOpacity},c.prototype.setSelectedFillOpacity=function(a){return this.selectedFillOpacity=a,this},c.prototype.getStroke=function(){return this.stroke},c.prototype.setStroke=function(a){return this.stroke=a,this.attr({stroke:this.stroke})},c.prototype.setOriginalStroke=function(a){return this.setStroke(a),this.originalStroke=a,this},c.prototype.setSelectedStroke=function(a){return this.setStroke(a),this.selectedStroke=a,this},c.prototype.getStrokeWidth=function(){return this.strokeWidth},c.prototype.setStrokeWidth=function(a){return this.strokeWidth=a,this.attr({"stroke-width":this.strokeWidth})},c.prototype.setOriginalStrokeWidth=function(a){return this.setStrokeWidth(a),this.originalStrokeWidth=a,this},c.prototype.setHoverOpacity=function(a){if(0>a||a>1)throw new Error("Graphics setHoverOpacity(): opacity must be between 0 and 1, inclusive");return this.hoverOpacity=a,this},c.prototype.setHoverFillOpacity=function(a){if(0>a||a>1)throw new Error("Graphics setHoverFillOpacity(): opacity must be between 0 and 1, inclusive");return this.hoverFillOpacity=a,this},c.prototype.setHeight=function(a){return this.dimensions.setHeight(a),this.attr({height:a})},c.prototype.getOpacity=function(){return this.opacity},c.prototype.setOpacity=function(a){if(a>1||0>a)throw new Error("Graphics setOpacity(): opacity must be between 0 and 1");return this.opacity=a,this.attr({opacity:a})},c.prototype.setOriginalOpacity=function(a){return this.setOpacity(a),this.originalOpacity=a,this},c.prototype.toggleOpacity=function(){this.setOpacity(this.opacity==this.originalOpacity?this.hoverOpacity:this.originalOpacity),this.setFillOpacity(this.fillOpacity==this.originalFillOpacity?this.hoverFillOpacity:this.originalFillOpacity)},c.prototype.select=function(){this.fill=this.selectedFill,this.stroke=this.selectedStroke,this.opacity=this.selectedOpacity,this.fillOpacity=this.selectedFillOpacity;var a=this;this.attr({fill:a.fill,"fill-opacity":a.fillOpacity,stroke:a.stroke,opacity:a.opacity})},c.prototype.deselect=function(){this.fill=this.originalFill,this.stroke=this.originalStroke,this.opacity=this.originalOpacity,this.fillOpacity=this.originalFillOpacity;var a=this;this.attr({fill:a.fill,"fill-opacity":a.fillOpacity,stroke:a.stroke,opacity:a.opacity})},c.prototype.disable=function(){this.fill=this.disabledFill,this.stroke=this.disabledStroke,this.opacity=this.disabledOpacity,this.fillOpacity=this.disabledFillOpacity;var a=this;this.attr({fill:a.fill,"fill-opacity":a.fillOpacity,stroke:a.stroke,opacity:a.opacity})},c.prototype.enable=function(){this.fill=this.originalFill,this.stroke=this.originalStroke,this.opacity=this.originalOpacity,this.fillOpacity=this.originalFillOpacity;var a=this;this.attr({fill:a.fill,"fill-opacity":a.fillOpacity,stroke:a.stroke,opacity:a.opacity})},c.prototype.setContainment=function(a,b,c,d){this.containment.left=a,this.containment.right=b,this.containment.top=c,this.containment.bottom=d},c.prototype.getCoordinates=function(){return this.placement.coordinates},c.prototype.canMoveByDelta=function(a,b){return this.canMoveByDeltaX(a)&&this.canMoveByDeltaY(b)},c.prototype.canMoveByDeltaX=function(a){return this.containment.isContainedX(a+this.dimensions.offset.x)},c.prototype.canMoveByDeltaY=function(a){return this.containment.isContainedY(a+this.dimensions.offset.y)},c.prototype.moveByDelta=function(b,c){if(a.Utilities.isNotNullOrUndefined(this.location)){this.location.moveByDelta(b,c);var d=this.grid.getCoordinatesFromAbsolute(this.location.ax,this.location.ay);a.Utilities.isNotNullOrUndefined(this.placement)&&this.placement.updateFromCoordinates(d.x,d.y),this.transform(this.location.dx,this.location.dy)}},c.prototype.moveByDeltaX=function(a){this.canMoveByDeltaX(a)&&this.moveByDelta(a,0)},c.prototype.moveByDeltaY=function(a){this.canMoveByDeltaY(a)&&this.moveByDelta(0,a)},c.prototype.hasLocation=function(){return a.Utilities.isNotNullOrUndefined(this.location)},c.prototype.hasPlacement=function(){return a.Utilities.isNotNullOrUndefined(this.placement)},c.prototype.setOffsetXY=function(a,b){this.dimensions.setOffsetXY(a,b)},c.prototype.initializePlacement=function(b){if(a.Utilities.isNullOrUndefined(b))throw new Error("Graphics initializePlacement(): placement is null or undefined");a.Utilities.isNullOrUndefined(this.placement)?this.placement=b:this.placement.update(b),a.Utilities.isNullOrUndefined(this.placement.grid)&&(this.placement.grid=this.grid);var c=this.grid.getAbsoluteFromCoordinates(this.placement.coordinates.x,this.placement.coordinates.y);this.location.updateFromAbsolute(c.x+this.dimensions.offset.x,c.y+this.dimensions.offset.y),this.refresh()},c.prototype.updatePlacement=function(){this.placement.refresh(),this.updateFromCoordinates(this.placement.coordinates.x,this.placement.coordinates.y)},c.prototype.updateFromAbsolute=function(a,b){this.placement.updateFromAbsolute(a,b),this.location.updateFromAbsolute(a,b),this.refresh()},c.prototype.updateFromRelative=function(a,b,c){this.placement.updateFromRelative(a,b,c);var d=this.grid.getAbsoluteFromCoordinates(this.placement.coordinates.x,this.placement.coordinates.y);this.location.updateFromAbsolute(d.x+this.dimensions.offset.x,d.y+this.dimensions.offset.y),this.refresh()},c.prototype.updateFromCoordinates=function(a,b){this.placement.updateFromCoordinates(a,b);var c=this.grid.getAbsoluteFromCoordinates(this.placement.coordinates.x,this.placement.coordinates.y);this.location.updateFromAbsolute(c.x,c.y),this.refresh()},c.prototype.path=function(a){return this.remove(),this.raphael=this.canvas.drawing.path(a),this.refresh(),this},c.prototype.rect=function(){return this.remove(),this.raphael=this.canvas.drawing.rect(this.placement.coordinates.x,this.placement.coordinates.y,this.dimensions.getWidth(),this.dimensions.getHeight(),!1,this.dimensions.getOffsetX(),this.dimensions.getOffsetY()),this.refresh(),this},c.prototype.rhombus=function(){return this.remove(),this.dimensions.rotation=-45,this.rect(),this},c.prototype.ellipse=function(){return this.remove(),this.raphael=this.canvas.drawing.ellipse(this.placement.coordinates.x,this.placement.coordinates.y,this.dimensions.getWidth(),this.dimensions.getHeight(),!1,this.dimensions.getOffsetX(),this.dimensions.getOffsetY()),this.refresh(),this},c.prototype.circle=function(){return this.remove(),this.raphael=this.canvas.drawing.circle(this.placement.coordinates.x,this.placement.coordinates.y,this.dimensions.getRadius(),!1,this.dimensions.getOffsetX(),this.dimensions.getOffsetY()),this.refresh(),this},c.prototype.triangle=function(){return this.remove(),this.raphael=this.canvas.drawing.triangle(this.placement.coordinates.x,this.placement.coordinates.y,this.dimensions.getHeight(),!1,this.dimensions.getOffsetX(),this.dimensions.getOffsetY()),this.refresh(),this},c.prototype.text=function(a){return this.remove(),this.raphael=this.canvas.drawing.text(this.placement.coordinates.x,this.placement.coordinates.y,a,!1,this.dimensions.getOffsetX(),this.dimensions.getOffsetY()),this},c.prototype.refresh=function(){if(this.hasRaphael()){var a={x:this.location.ax,y:this.location.ay};"circle"==this.getType()&&(a.cx=this.location.ax,a.cy=this.location.ay),"text"!=this.getType()&&(a.fill=this.fill,a["fill-opacity"]=this.fillOpacity,a.opacity=this.opacity,a.stroke=this.stroke,a["stroke-width"]=this.strokeWidth),this.attr(a)}},c.prototype.toFront=function(){return this.hasRaphael()?(this.raphael.toFront(),this):this},c.prototype.toBack=function(){return this.hasRaphael()?(this.raphael.toBack(),this):this},c.prototype.attr=function(a){return this.hasRaphael()?this.raphael.attr(a):void 0},c.prototype.attrKeyValue=function(a,b){return this.hasRaphael()?this.raphael.attr(a,b):void 0},c.prototype.setAttribute=function(a,b){this.hasRaphael()&&this.raphael.node.setAttribute(a,b)},c.prototype.getBBox=function(a){return this.hasRaphael()?this.raphael.getBBox(a===!0):void 0},c.prototype.transform=function(a,b){this.hasRaphael()&&this.raphael.transform(["t",a,", ",b," r",this.dimensions.rotation].join(""))},c.prototype.resetTransform=function(){this.hasRaphael()&&this.raphael.transform("t 0, 0 r",this.dimensions.rotation)},c.prototype.rotate=function(a){this.hasRaphael()&&(this.dimensions.rotation=a,this.raphael.rotate(a))},c.prototype.remove=function(){this.hasRaphael()&&(this.hasSet()&&this.set.empty(),this.raphael&&this.raphael[0]&&this.raphael[0].remove(),this.raphael=null)},c.prototype.show=function(){this.hasRaphael()&&(this.raphael.show(),this.hasSet()&&this.set.show())},c.prototype.hide=function(){this.hasRaphael()&&(this.raphael.hide(),this.hasSet()&&this.set.hide())},c.prototype.glow=function(){this.hasRaphael()&&this.raphael.glow()},c.prototype.getType=function(){return this.hasRaphael()?this.raphael.type:void 0},c.prototype.ondraw=function(a){this.drawingHandler.ondraw(a)},c.prototype.draw=function(){this.drawingHandler.draw()},c.prototype.onhover=function(a,b,c){if(this.hasRaphael()){this.raphael.hover(function(b){a.call(c,b)},function(a){b.call(c,a)})}},c.prototype.hoverIn=function(a){this.hasRaphael()&&(console.log("graphics hoverIn"),this.toggleOpacity())},c.prototype.hoverOut=function(a){this.hasRaphael()&&(console.log("graphics hoverOut"),this.toggleOpacity())},c.prototype.onclick=function(a,b){this.hasRaphael()&&this.raphael.click(function(c){a.call(b,c)})},c.prototype.click=function(a){},c.prototype.oncontextmenu=function(b,c){this.hasRaphael()&&this.raphael.mousedown(function(d){d.which==a.Input.Which.RightClick&&b.call(c,d)});
},c.prototype.contextmenu=function(a){},c.prototype.onmousedown=function(a,b){this.hasRaphael()&&this.raphael.mousedown(function(c){a.call(b,c)})},c.prototype.onmouseup=function(a,b){this.hasRaphael()&&this.raphael.mouseup(function(c){a.call(b,c)})},c.prototype.mousedown=function(a){!this.hasRaphael()},c.prototype.onmousemove=function(a,b){this.hasRaphael()&&this.raphael.mousemove(function(c){a.call(b,c)})},c.prototype.mousemove=function(a){!this.hasRaphael()},c.prototype.ondrag=function(a,b,c,d){this.hasRaphael()&&this.raphael.drag(a,b,c,d,d,d)},c.prototype.flip=function(a){this.placement.flip(),this.updateFromRelative(this.placement.relative.rx,this.placement.relative.ry,this.placement.relativeElement),this.hasRaphael()&&a===!0&&(this.rotate(180),this.resetTransform(),this.cleanTransform())},c.prototype.drop=function(){this.location.hasChanged()&&this.setModified(!0);var a=this.grid.snapPixel(this.location.ax),b=this.grid.snapPixel(this.location.ay);this.updateFromAbsolute(this.snapping?a:this.location.ax+(a-this.location.ax),this.snapping?b:this.location.ay+(b-this.location.ay)),this.hasRaphael()&&(this.resetTransform(),this.cleanTransform())},c.prototype.cleanTransform=function(){if("triangle"==this.raphael.data("element-type")){var a=this.canvas.drawing.triangle(this.placement.coordinates.x,this.placement.coordinates.y,this.dimensions.getHeight(),!1,this.dimensions.getOffsetX(),this.dimensions.getOffsetY()),b=a.attr("path").toString();this.raphael.attr({path:b}),a.remove()}else if("ellipse"==this.raphael.type){var c=this.canvas.drawing.ellipse(this.placement.coordinates.x,this.placement.coordinates.y,this.dimensions.getWidth(),this.dimensions.getHeight(),!1,this.dimensions.getOffsetX(),this.dimensions.getOffsetY());c.remove()}},c}(a.Models.Modifiable);b.Graphics=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(){function b(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];this.context=a,this.canvas=this.context.canvas,this.grid=this.canvas.grid,this.items=[],this.raphaelSet=this.canvas.drawing.set(),b&&b.length>0&&this.push.apply(this,b),this.length=this.items.length}return b.prototype.size=function(){return this.items.length},b.prototype.push=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];for(var d=0;d<b.length;d++){var e=b[d];a.Utilities.isNullOrUndefined(e)||(this.length++,this.raphaelSet.exclude(e.raphael),this.raphaelSet.push(e.raphael),this.items.push(e))}},b.prototype.empty=function(){for(;this.length>0;)this.pop()},b.prototype.pop=function(){return this.length--,this.raphaelSet.pop(),this.items.pop()},b.prototype.exclude=function(a){var b=this.getByGuid(a.guid);if(!b)throw new Error("GraphicsSet exclude(): no matching graphics found for exclusion");for(var c=0;c<this.items.length;c++){var d=this.items[c];if(d.guid==b.guid){this.splice(c,1),this.length--;break}}return this.raphaelSet.exclude(b.raphael)},b.prototype.forEach=function(a,b){return this.raphaelSet.forEach(a,b)},b.prototype.getByGuid=function(a){for(var b=0;b<this.items.length;b++){var c=this.items[b];if(c&&c.guid&&c.guid==a)return c}return null},b.prototype.splice=function(a,b){return this.length-=b,this.raphaelSet.splice(a,b),this.items.splice(a,b)},b.prototype.removeAll=function(){for(;this.raphaelSet.length>0;)this.pop();this.items=[],this.length=0},b.prototype.dragOne=function(a,b,c){var d=this.getByGuid(a);d.moveByDelta(b,c)},b.prototype.dragAll=function(a,b){for(var c=0;c<this.items.length;c++){var d=this.items[c];d.moveByDelta(a,b)}},b.prototype.show=function(){this.raphaelSet.show()},b.prototype.hide=function(){this.raphaelSet.hide()},b.prototype.drop=function(){for(var a=0;a<this.items.length;a++){var b=this.items[a];b.drop()}},b.prototype.setOriginalPositions=function(){for(var a=0;a<this.items.length;a++){var b=this.items[a];b.location.ax=b.location.ox,b.location.ay=b.location.oy}},b}();b.GraphicsSet=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),b.prototype.setContext.call(this,this),this.width=0,this.height=0,this.minWidth=0,this.minHeight=0,this.length=0,this.depth=0,this.radius=0,this.diameter=2*this.radius,this.perimeter=0,this.circumference=0,this.area=0,this.circularArea=0,this.offset=new a.Models.Offset(0,0),this.rotation=0}return __extends(c,b),c.prototype.toJson=function(){return{width:this.width,height:this.height,minWidth:this.minWidth,minHeight:this.minHeight,length:this.length,depth:this.depth,radius:this.radius,diameter:this.diameter,perimeter:this.perimeter,area:this.area,circumference:this.circumference,offset:this.offset.toJson(),rotation:this.rotation}},c.prototype.fromJson=function(a){a&&(this.width=a.width,this.height=a.height,this.minWidth=a.minWidth,this.minHeight=a.minHeight,this.length=a.length,this.depth=a.depth,this.radius=a.radius,this.diameter=a.diameter,this.perimeter=a.perimeter,this.area=a.area,this.circumference=a.circumference,this.offset.fromJson(a.offset),this.rotation=a.rotation)},c.prototype.calculateDimensions=function(){this._calculateDiameter(),this._calculateArea(),this._calculatePerimeter(),this._calculateCircumference(),this._calculateCircularArea()},c.prototype.getHeight=function(){return this.height},c.prototype.setHeight=function(a){if(0>a)throw new Error("Dimensions setHeight(): height cannot be less than zero. You passed: "+a);this.height=a,this.calculateDimensions()},c.prototype.getWidth=function(){return this.width},c.prototype.setWidth=function(a){this.width=a,this.calculateDimensions()},c.prototype.getMinWidth=function(){return this.minWidth},c.prototype.setMinWidth=function(a){this.minWidth=a,this.minWidth>this.width&&this.setWidth(this.minWidth)},c.prototype.getMinHeight=function(){return this.minHeight},c.prototype.setMinHeight=function(a){this.minHeight=a,this.minHeight>this.height&&this.setHeight(this.minHeight)},c.prototype.getLength=function(){return this.length},c.prototype.setLength=function(a){this.length=a},c.prototype.getDepth=function(){return this.depth},c.prototype.setDepth=function(a){this.depth=a},c.prototype.getRadius=function(){return this.radius},c.prototype.setRadius=function(a){this.radius=a,this.calculateDimensions()},c.prototype.getDiameter=function(){return this.diameter},c.prototype.setDiameter=function(a){this.diameter=a,this.radius=this.diameter/2},c.prototype._calculateDiameter=function(){return this.diameter=2*this.getRadius(),this.diameter},c.prototype.getPerimeter=function(){return this.perimeter},c.prototype._calculatePerimeter=function(){return this.perimeter=2*this.height+2*this.width,this.perimeter},c.prototype.getArea=function(){return this.area},c.prototype._calculateArea=function(){return this.area=this.height*this.width,this.area},c.prototype.getCircumference=function(){return this.circumference},c.prototype._calculateCircumference=function(){return this.circumference=2*Math.PI*this.getRadius(),this.circumference},c.prototype.getCircularArea=function(){return this.circularArea},c.prototype._calculateCircularArea=function(){return this.circularArea=Math.PI*Math.pow(this.getRadius(),2),this.circularArea},c.prototype.hasOffset=function(){return a.Utilities.isNotNullOrUndefined(this.offset)},c.prototype.getOffset=function(){return this.offset},c.prototype.setOffset=function(b){this.hasOffset()?this.offset=b:this.offset=new a.Models.Offset(b.x,b.y)},c.prototype.getOffsetX=function(){return this.hasOffset()?this.offset.getX():null},c.prototype.setOffsetX=function(b){this.hasOffset()?this.offset.x=b:this.offset=new a.Models.Offset(b,0)},c.prototype.getOffsetY=function(){return this.hasOffset()?this.offset.getY():null},c.prototype.setOffsetY=function(b){this.hasOffset()?this.offset.y=b:this.offset=new a.Models.Offset(0,b)},c.prototype.setOffsetXY=function(a,b){this.offset.setXY(a,b)},c}(a.Models.Modifiable);b.Dimensions=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(b){function c(a,c){b.call(this),b.prototype.setContext.call(this,this),this.x=a||0,this.y=c||0,this.onModified(function(){})}return __extends(c,b),c.prototype.toJson=function(){return{x:this.x,y:this.y}},c.prototype.fromJson=function(a){a&&(this.x=a.x,this.y=a.y)},c.prototype.set=function(a){this.x=a.x,this.y=a.y,this.setModified(!0)},c.prototype.hasXY=function(){return this.hasX()&&this.hasY()},c.prototype.hasX=function(){return a.Utilities.isNullOrUndefined(this.x)},c.prototype.getX=function(){return this.x},c.prototype.setX=function(a){this.x=a,this.setModified(!0)},c.prototype.hasY=function(){return a.Utilities.isNullOrUndefined(this.y)},c.prototype.getY=function(){return this.y},c.prototype.setY=function(a){this.y=a,this.setModified(!0)},c.prototype.setXY=function(a,b){this.x=a,this.y=b,this.setModified(!0)},c}(a.Models.Modifiable);b.Offset=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d){this.left=a,this.right=b,this.top=c,this.bottom=d}return a.prototype.isContained=function(a){return this.isContainedX(a.x)&&this.isContainedY(a.y)},a.prototype.isContainedX=function(a){return a>=this.left&&a<=this.right},a.prototype.isContainedY=function(a){return a<=this.top&&a>=this.bottom},a}();a.Containment=b}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(a){function b(b,c,d,e){a.call(this,b,c,d,e)}return __extends(b,a),b}(a.Models.Containment);b.RelativeContainment=c}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(a){var b=function(){function a(a){this.callbacks=[]}return a.prototype.ondraw=function(a){if(!this.callbacks)throw new Error("Drawable ondraw(): callbacks array is null or undefined");this.callbacks.push(a)},a.prototype.draw=function(){if(this.callbacks)for(var a=0;a<this.callbacks.length;a++){var b=this.callbacks[a];b&&"Function"==typeof b&&b(this.graphics)}},a}();a.DrawingHandler=b}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(a){var b=function(){function a(a,b){this.quote=a,this.author=b}return a}();a.Quote=b}(b=a.Models||(a.Models={}))}(Common||(Common={}));var Common;!function(a){var b;!function(a){!function(a){a[a.Unknown=0]="Unknown",a[a.PlaybookView=1]="PlaybookView",a[a.Playbook=2]="Playbook",a[a.Formation=3]="Formation",a[a.Set=4]="Set",a[a.Play=10]="Play",a[a.PlayTemplate=98]="PlayTemplate",a[a.Variant=99]="Variant",a[a.Team=200]="Team",a[a.GenericEntity=1e3]="GenericEntity",a[a.League=1010]="League",a[a.Season=1011]="Season",a[a.Opponent=1012]="Opponent",a[a.Game=1013]="Game",a[a.Position=1014]="Position",a[a.PersonnelGroup=1015]="PersonnelGroup",a[a.TeamMember=1016]="TeamMember",a[a.UnitType=1017]="UnitType",a[a.Conference=1018]="Conference",a[a.Division=1019]="Division",a[a.Scenario=1020]="Scenario",a[a.MatchupPlaybook=1021]="MatchupPlaybook",a[a.Situation=1022]="Situation",a[a.Assignment=1023]="Assignment",a[a.AssignmentGroup=1024]="AssignmentGroup",a[a.GamePlan=1030]="GamePlan",a[a.PracticePlan=1031]="PracticePlan",a[a.PracticeSchedule=1032]="PracticeSchedule",a[a.ScoutCard=1033]="ScoutCard",a[a.Drill=1034]="Drill",a[a.QBWristband=1035]="QBWristband",a[a.Plan=1039]="Plan",a[a.GameAnalysis=1050]="GameAnalysis",a[a.PlayByPlayAnalysis=1051]="PlayByPlayAnalysis",a[a.Location=1101]="Location",a[a.GenericSetting=2e3]="GenericSetting",a[a.User=2010]="User",a[a.SecureUser=2011]="SecureUser",a[a.Account=2020]="Account",a[a.Organization=2021]="Organization"}(a.ImpaktDataTypes||(a.ImpaktDataTypes={}));a.ImpaktDataTypes;!function(a){a[a.Unknown=0]="Unknown",a[a.Ready=1]="Ready",a[a.Loaded=2]="Loaded",a[a.Initialized=3]="Initialized",a[a.Constructed=4]="Constructed",a[a.Updating=5]="Updating"}(a.State||(a.State={}));a.State;!function(a){a[a.Any=-1]="Any",a[a.Unknown=0]="Unknown",a[a.Peer=1]="Peer",a[a.Dependency=2]="Dependency"}(a.AssociationTypes||(a.AssociationTypes={}));a.AssociationTypes;!function(a){a[a.Square=0]="Square",a[a.Circle=1]="Circle",a[a.Ellipse=2]="Ellipse"}(a.DimensionTypes||(a.DimensionTypes={}));a.DimensionTypes;!function(a){a[a.TargetGridWidth=0]="TargetGridWidth",a[a.MaxContainerWidth=1]="MaxContainerWidth",a[a.PreviewWidth=2]="PreviewWidth"}(a.CanvasSizingModes||(a.CanvasSizingModes={}));var b=(a.CanvasSizingModes,function(){function a(){}return a.pointer="pointer",a.crosshair="crosshair",a}());a.CursorTypes=b,function(a){a[a.None=0]="None",a[a.Personnel=1]="Personnel",a[a.Assignment=2]="Assignment",a[a.UnitType=3]="UnitType"}(a.SetTypes||(a.SetTypes={}));a.SetTypes;!function(a){a[a.Generic=0]="Generic",a[a.FieldElement=1]="FieldElement",a[a.Player=2]="Player",a[a.PlayerIcon=3]="PlayerIcon",a[a.PlayerPersonnelLabel=4]="PlayerPersonnelLabel",a[a.PlayerIndexLabel=5]="PlayerIndexLabel",a[a.PlayerCoordinates=6]="PlayerCoordinates",a[a.PlayerRelativeCoordinatesLabel=7]="PlayerRelativeCoordinatesLabel",a[a.PlayerSelectionBox=8]="PlayerSelectionBox",a[a.PlayerRoute=9]="PlayerRoute",a[a.PlayerSecondaryRoutes=10]="PlayerSecondaryRoutes",a[a.PlayerAlternateRoutes=11]="PlayerAlternateRoutes",a[a.PlayerRouteAction=12]="PlayerRouteAction",a[a.PlayerRouteNode=13]="PlayerRouteNode",a[a.PlayerRoutePath=14]="PlayerRoutePath",a[a.PlayerRouteControlPath=15]="PlayerRouteControlPath",a[a.PrimaryPlayer=16]="PrimaryPlayer",a[a.PrimaryPlayerIcon=17]="PrimaryPlayerIcon",a[a.PrimaryPlayerLabel=18]="PrimaryPlayerLabel",a[a.PrimaryPlayerCoordinates=19]="PrimaryPlayerCoordinates",a[a.PrimaryPlayerRelativeCoordinatesLabel=20]="PrimaryPlayerRelativeCoordinatesLabel",a[a.PrimaryPlayerSelectionBox=21]="PrimaryPlayerSelectionBox",a[a.PrimaryPlayerRoute=22]="PrimaryPlayerRoute",a[a.PrimaryPlayerSecondaryRoutes=23]="PrimaryPlayerSecondaryRoutes",a[a.PrimaryPlayerAlternateRoutes=24]="PrimaryPlayerAlternateRoutes",a[a.PrimaryPlayerRouteAction=25]="PrimaryPlayerRouteAction",a[a.PrimaryPlayerRouteNode=26]="PrimaryPlayerRouteNode",a[a.PrimaryPlayerRoutePath=27]="PrimaryPlayerRoutePath",a[a.PrimaryPlayerRouteControlPath=28]="PrimaryPlayerRouteControlPath",a[a.OpponentPlayer=29]="OpponentPlayer",a[a.OpponentPlayerIcon=30]="OpponentPlayerIcon",a[a.OpponentPlayerLabel=31]="OpponentPlayerLabel",a[a.OpponentPlayerCoordinates=32]="OpponentPlayerCoordinates",a[a.OpponentPlayerRelativeCoordinatesLabel=33]="OpponentPlayerRelativeCoordinatesLabel",a[a.OpponentPlayerSelectionBox=34]="OpponentPlayerSelectionBox",a[a.OpponentPlayerRoute=35]="OpponentPlayerRoute",a[a.OpponentPlayerSecondaryRoutes=36]="OpponentPlayerSecondaryRoutes",a[a.OpponentPlayerAlternateRoutes=37]="OpponentPlayerAlternateRoutes",a[a.OpponentPlayerRouteAction=38]="OpponentPlayerRouteAction",a[a.OpponentPlayerRouteNode=39]="OpponentPlayerRouteNode",a[a.OpponentPlayerRoutePath=40]="OpponentPlayerRoutePath",a[a.OpponentPlayerRouteControlPath=41]="OpponentPlayerRouteControlPath",a[a.Ball=42]="Ball",a[a.Field=43]="Field",a[a.Sideline=44]="Sideline",a[a.Hashmark=45]="Hashmark",a[a.SidelineHashmark=46]="SidelineHashmark",a[a.Endzone=47]="Endzone",a[a.LineOfScrimmage=48]="LineOfScrimmage",a[a.Assignment=49]="Assignment"}(a.LayerTypes||(a.LayerTypes={}));a.LayerTypes;!function(a){a[a.None=0]="None",a[a.Generic=1]="Generic",a[a.Block=2]="Block",a[a.Scan=3]="Scan",a[a.Run=4]="Run",a[a.Route=5]="Route",a[a.Cover=6]="Cover",a[a.Zone=7]="Zone",a[a.Spy=8]="Spy",a[a.Option=9]="Option",a[a.HandOff=10]="HandOff",a[a.Pitch=11]="Pitch"}(a.RouteTypes||(a.RouteTypes={}));a.RouteTypes;!function(a){a[a.Preview=0]="Preview",a[a.Editor=1]="Editor",a[a.Unknown=2]="Unknown"}(a.RenderTypes||(a.RenderTypes={}));a.RenderTypes;!function(a){a[a.None=0]="None",a[a.Normal=1]="Normal",a[a.Root=2]="Root",a[a.CurveStart=3]="CurveStart",a[a.CurveControl=4]="CurveControl",a[a.CurveEnd=5]="CurveEnd",a[a.End=6]="End"}(a.RouteNodeTypes||(a.RouteNodeTypes={}));a.RouteNodeTypes;!function(a){a[a.None=0]="None",a[a.Block=1]="Block",a[a.Delay=2]="Delay",a[a.Continue=3]="Continue",a[a.Juke=4]="Juke",a[a.ZigZag=5]="ZigZag"}(a.RouteNodeActions||(a.RouteNodeActions={}));a.RouteNodeActions;!function(a){a[a.None=0]="None",a[a.Create=1]="Create",a[a.Save=2]="Save",a[a.Overwrite=3]="Overwrite",a[a.Copy=4]="Copy",a[a.Edit=5]="Edit",a[a.Update=6]="Update",a[a.Delete=7]="Delete",a[a.View=8]="View",a[a.Details=9]="Details",a[a.Select=10]="Select"}(a.Actions||(a.Actions={}));a.Actions}(b=a.Enums||(a.Enums={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){b.DEFAULT_GRID_COLS=100,b.DEFAULT_GRID_ROWS=100,b.COMMON_URL="common/",b.MODULES_URL="modules/",b.PLAYBOOK_URL="playbook/",b.CONTEXTMENUS_URL="contextmenus/",b.DEFAULT_CONTEXTMENU_TEMPLATE_URL=[a.Constants.COMMON_URL,a.Constants.CONTEXTMENUS_URL,"default-contextmenu.tpl.html"].join(""),b.EDITOR_ROUTENODE_CONTEXTMENU_TEMPLATE_URL=[a.Constants.MODULES_URL,a.Constants.PLAYBOOK_URL,a.Constants.CONTEXTMENUS_URL,"routeNode/contextmenu-routeNode.tpl.html"].join(""),b.PLAY_CONTEXTMENU_TEMPLATE_URL=[a.Constants.MODULES_URL,a.Constants.PLAYBOOK_URL,a.Constants.CONTEXTMENUS_URL,"play/contextmenu-play.tpl.html"].join(""),b.PLAYER_CONTEXTMENU_TEMPLATE_URL=[a.Constants.MODULES_URL,a.Constants.PLAYBOOK_URL,a.Constants.CONTEXTMENUS_URL,"player/contextmenu-player.tpl.html"].join("")}(b=a.Constants||(a.Constants={}))}(Common||(Common={}));var Common;!function(a){var b;!function(a){var b=function(){function a(){}return a.getPlayerIcon=function(a){},a}();a.PlayerIconFactory=b}(b=a.Factories||(a.Factories={}))}(Common||(Common={}));var Common;!function(a){var b;!function(b){var c=function(){function b(){}return b.draw=function(b){if(a.Utilities.isNullOrUndefined(b))throw new Error("RouteActionFactory draw(): route action is null or undefined");switch(b.action){case a.Enums.RouteNodeActions.None:a.Factories.RouteActionFactory.none(b.getGraphics());break;case a.Enums.RouteNodeActions.Block:a.Factories.RouteActionFactory.block(b.routeNode.getGraphics(),b.getGraphics());break;case a.Enums.RouteNodeActions.Delay:a.Factories.RouteActionFactory.delay(b.routeNode.getGraphics(),b.getGraphics())}},b.none=function(b){if(a.Utilities.isNullOrUndefined(b))throw new Error("RouteActionFactory none(): route action graphics is null");return b.remove()},b.block=function(b,c){if(a.Utilities.isNullOrUndefined(c))throw new Error("RouteActionFactory block(): route action graphics is null");if(a.Utilities.isNullOrUndefined(b))throw new Error("RouteActionFactory block(): route node graphics is null");var d=a.Drawing.Utilities.theta(b.location.ax,b.location.ay,c.location.ax,c.location.ay),e=a.Drawing.Utilities.toDegrees(d);c.placement.coordinates.x=b.placement.coordinates.x,c.placement.coordinates.y=b.placement.coordinates.y,c.dimensions.offset.x=.5,c.location.ax=b.location.ax-c.dimensions.getWidth(),c.location.ay=b.location.ay,c.setFill("blue"),c.setStrokeWidth(2),c.dimensions.width=2*b.dimensions.getWidth(),c.dimensions.height=2*b.dimensions.getHeight();var f=a.Drawing.Utilities.getPathString(!0,[c.location.ax,c.location.ay,c.location.ax+2*c.dimensions.getWidth(),c.location.ay]);c.path(f),c.setAttribute("class","painted-fill"),c.rotate(90-e)},b.delay=function(b,c){if(a.Utilities.isNullOrUndefined(c))throw new Error("RouteActionFactory block(): route action graphics is null");if(a.Utilities.isNullOrUndefined(b))throw new Error("RouteActionFactory block(): route node graphics is null");c.dimensions.offset.x=.5,c.dimensions.offset.y=.5,c.dimensions.width=2*b.dimensions.getWidth(),c.dimensions.height=2*b.dimensions.getHeight(),c.setFill("orange"),c.setStrokeWidth(1),c.rect(),c.setAttribute("class","painted-fill")},b}();b.RouteActionFactory=c}(b=a.Factories||(a.Factories={}))}(Common||(Common={}));var Common;!function(a){var b;!function(a){!function(a){a[a.Nothing=0]="Nothing",a[a.Create=1]="Create",a[a.Overwrite=2]="Overwrite",a[a.Copy=3]="Copy"}(a.Actions||(a.Actions={}));a.Actions}(b=a.API||(a.API={}));var c;!function(b){var c=function(){function b(b,c,e){this.name=b,this.type=c,this.guid=a.Utilities.guid(),this.waitingOn=e||[],this.loaded=this.waitingOn&&0==this.waitingOn.length,this.dependencies=new d,this.onReadyCallback=function(){}}return b.prototype.ready=function(){this.loaded=!0,this.onReadyCallback(this)},b.prototype.onready=function(a){this.onReadyCallback=a,this.loaded&&this.ready()},b.prototype.loadDependency=function(a){this.dependencies.add(a);var b=this.waitingOn.indexOf(a.name);this.waitingOn.splice(b,1),a.loaded&&a.ready(),0==this.waitingOn.length&&this.ready()},b.prototype.registerDependencies=function(){for(var c=0;c<this.waitingOn.length;c++)this.dependencies.add(new b(this.waitingOn[c],a.Base.ComponentType.Null))},b}();b.Component=c,function(a){a[a.Null=0]="Null",a[a.Service=1]="Service",a[a.Controller=2]="Controller",a[a.Directive=3]="Directive"}(b.ComponentType||(b.ComponentType={}));var d=(b.ComponentType,function(){function a(){this.obj={},this.count=0}return a.prototype.add=function(a){return this.obj[a.guid]?void this.set(a):(this.obj[a.guid]=a,void this.count++)},a.prototype.remove=function(a){var b=this.obj[a];return delete this.obj[a],this.count--,b},a.prototype.get=function(a){return this.obj[a]},a.prototype.set=function(a){this.obj[a.guid]=a},a}());b.ComponentMap=d}(c=a.Base||(a.Base={}));var d=function(){function b(){}return b.notImplementedException=function(){throw new Error("Exception: Method not implemented")},b.exportToPng=function(b,c){if(!c)throw new Error("play-preview: Corresponding SVG element not found");var d=a.Utilities.serializeXMLToString(c);canvg(b.exportCanvas,d);var e=b.exportCanvas.toDataURL("image/png");return e},b.compressSVG=function(b){var c=a.Utilities.serializeXMLToString(b),d=a.Utilities.toBase64(c);return d},b.compress=function(a){return LZString.compress(a)},b.decompressSVG=function(b){return a.Utilities.fromBase64(b)},b.decompress=function(a){return LZString.decompress(a)},b.toBase64=function(a){return window.btoa(a)},b.fromBase64=function(a){return window.atob(a)},b.serializeXMLToString=function(a){return(new XMLSerializer).serializeToString(a)},b.parseData=function(a){for(var b=0;b<a.length;b++)try{"string"==typeof a[b].data&&(a[b].data=JSON.parse(a[b].data))}catch(c){console.log(c)}return a},b.guid=function(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b},b.randomInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},b.randomId=function(){return Math.floor(8999999999*Math.random())+999999999},b.camelCaseToSpace=function(b,c){var d=b.replace(/([A-Z])/g," $1");return c&&(d=a.Utilities.sentenceCase(d)),d},b.sentenceCase=function(a){return(a.charAt(0).toUpperCase()+a.slice(1)).trim()},b.convertEnumToList=function(b){var c={};for(var d in b)isNaN(d)||(c[parseInt(d)]=a.Utilities.camelCaseToSpace(b[d],!0));return c},b.getEnumerationsOnly=function(a){var b={};for(var c in a)isNaN(c)&&(b[c]=a[c]);return b},b.getEnumerationsAsArray=function(a){var b=[];for(var c in a)isNaN(c)||b.push(parseInt(c));return b},b.parseEnumFromString=function(b){if(a.Utilities.isEmptyString(b))return null;for(var c=b.split("."),d=window,e=0;e<c.length;e++)c[e]&&(d=d[c[e]]);return d},b.isArray=function(a){return"[object Array]"==Object.prototype.toString.call(a)},b.isObject=function(a){return"object"==typeof a},b.isFunction=function(a){},b.toJson=function(b){var c=null;return c=a.Utilities.isObject(b)?a.Utilities.toJsonRecursive(b,{}):a.Utilities.isArray(b)?a.Utilities.toJsonArrayRecursive(b):b},b.toJsonArrayRecursive=function(b){for(var c=[],d=0;d<b.length;d++){var e=b[d],f=null;f=a.Utilities.isArray(e)?a.Utilities.toJsonArrayRecursive(e):a.Utilities.isObject(e)?a.Utilities.toJson(e):e,c.push(f)}return c},b.toJsonRecursive=function(b,c){var d=Object.keys(b);if(!d)return null;if(b.toJson)c=b.toJson();else for(var e=0;e<d.length;e++){var f=d[e];a.Utilities.isFunction(b[f])||(a.Utilities.isObject(b[f])?b[f].toJson&&(c[f]=a.Utilities.toJsonRecursive(b[f].toJson(),{})):a.Utilities.isArray(b[f])?c[f]=a.Utilities.toJsonArrayRecursive(b[f]):c[f]=b[f])}return c},b.generateChecksum=function(a){return objectHash(a,{})},b.prepareObjectForEncoding=function(b){var c=null;if(Array.isArray(b))for(var d=b,e=0;e<d.length;e++){var f=d[e];c=a.Utilities.prepareObjectForEncoding(f)}else{var g=Object.keys(b).sort();c=[];for(var h,i=0;i<g.length;i++)h=g[i],c.push(h),c.push(b[h])}return c},b.isNotNullOrUndefined=function(b){return!a.Utilities.isNullOrUndefined(b)},b.isNullOrUndefined=function(b){return a.Utilities.isNull(b)||a.Utilities.isUndefined(b)},b.isNull=function(a){return null===a},b.isUndefined=function(a){return void 0===a||"undefined"===a},b.isEmptyString=function(b){return a.Utilities.isNullOrUndefined(b)||""===b},b.isNotEmptyString=function(b){return!a.Utilities.isEmptyString(b)},b.uniqueArray=function(b){if(a.Utilities.isNullOrUndefined(b))throw new Error("Utilities uniqueArray(): array is null or undefined");for(var c=[],d=0;d<b.length;d++){var e=b[d];c.indexOf(e)<0&&c.push(e)}return c},b}();a.Utilities=d}(Common||(Common={}));var Common;!function(a){var b;!function(a){a.SCROLL_BAR_SIZE=12}(b=a.UI||(a.UI={}))}(Common||(Common={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this),this.scenario=Common.API.Actions.Nothing,this.play=Common.API.Actions.Nothing,this.formation=Common.API.Actions.Nothing,this.assignmentGroup=Common.API.Actions.Nothing}return __extends(b,a),b}(Common.Models.APIOptions);a.PlaybookAPIOptions=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(b){var c=function(){function b(b,c,d,e,f,g,h){this.title="Generic tool",this.guid=Common.Utilities.guid(),this.tooltip="Generic tool",this.glyphicon=new Common.Icons.Glyphicon,this.action=a.Enums.ToolActions.Nothing,this.title=b||this.title,this.action=c||this.action,this.tooltip=e||this.tooltip,this.glyphicon.icon=d||this.glyphicon.icon,this.cursor=f||Common.Enums.CursorTypes.pointer,this.mode=g||a.Enums.ToolModes.Select,this.selected=h||!1}return b}();b.Tool=c}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.prototype.initialize=function(b){a.prototype.initialize.call(this,b)},b}(Common.Models.Endzone);a.EditorEndzone=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.prototype.initialize=function(b){a.prototype.initialize.call(this,b)},b}(Common.Models.Endzone);a.PreviewEndzone=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.initialize=function(b){a.prototype.initialize.call(this,b)},b.prototype.draw=function(){a.prototype.draw.call(this),this.graphics.onclick(this.click,this),this.graphics.ondrag(this.dragMove,this.dragStart,this.dragEnd,this)},b.prototype.dragMove=function(a,b,c,d,e){this.graphics.moveByDeltaX(a),this.graphics.moveByDeltaY(b),this.field.ball.graphics.moveByDeltaY(b)},b.prototype.dragStart=function(a,b,c){},b.prototype.dragEnd=function(a){this.graphics.drop(),this.field.ball.graphics.drop()},b}(Common.Models.Ball);a.EditorBall=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.initialize=function(b){a.prototype.initialize.call(this,b)},b.prototype.dragMove=function(a,b,c,d,e){},b.prototype.dragStart=function(a,b,c){},b.prototype.dragEnd=function(a){},b}(Common.Models.Ball);a.PreviewBall=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this,a),this.zoom=1;this.onModified(function(){}),this.state=Common.Enums.State.Constructed}return __extends(c,b),c.prototype.initialize=function(){var b=!1;this.ball||(this.ball=new a.Models.EditorBall,this.ball.initialize(this,null),b=!0,this.layer.addLayer(this.ball.layer)),this.ground||(this.ground=new a.Models.EditorGround,this.ground.initialize(this,null),this.layer.addLayer(this.ground.layer)),this.los||(this.los=new a.Models.EditorLineOfScrimmage,this.los.initialize(this,null),this.layer.addLayer(this.los.layer)),this.endzone_top||(this.endzone_top=new a.Models.EditorEndzone(0),this.endzone_top.initialize(this,null),this.layer.addLayer(this.endzone_top.layer)),this.endzone_bottom||(this.endzone_bottom=new a.Models.EditorEndzone(110),this.endzone_bottom.initialize(this,null),this.layer.addLayer(this.endzone_bottom.layer)),this.sideline_left||(this.sideline_left=new a.Models.EditorSideline(0),this.sideline_left.initialize(this,null),this.layer.addLayer(this.sideline_left.layer)),this.sideline_right||(this.sideline_right=new a.Models.EditorSideline(51),this.sideline_right.initialize(this,null),this.layer.addLayer(this.sideline_right.layer)),this.hashmark_left||(this.hashmark_left=new a.Models.EditorHashmark(22),this.hashmark_left.initialize(this,null),this.layer.addLayer(this.hashmark_left.layer)),this.hashmark_right||(this.hashmark_right=new a.Models.EditorHashmark(28),this.hashmark_right.initialize(this,null),this.layer.addLayer(this.hashmark_right.layer)),this.hashmark_sideline_left||(this.hashmark_sideline_left=new a.Models.EditorHashmark(2),this.hashmark_sideline_left.initialize(this,null),this.layer.addLayer(this.hashmark_sideline_left.layer)),this.hashmark_sideline_right||(this.hashmark_sideline_right=new a.Models.EditorHashmark(50),this.hashmark_sideline_right.initialize(this,null),this.layer.addLayer(this.hashmark_sideline_right.layer)),b&&this.ball.graphics.setContainment(this.hashmark_left.graphics.placement.coordinates.x,this.hashmark_right.graphics.placement.coordinates.x,this.endzone_top.graphics.dimensions.getHeight(),this.endzone_top.graphics.placement.coordinates.y),this.draw(),this.invokeListener("onready"),this.state=Common.Enums.State.Ready},c.prototype.draw=function(){this.ground.draw(),this.grid.draw(),this.endzone_top.draw(),this.endzone_bottom.draw(),this.sideline_left.draw(),this.sideline_right.draw(),this.hashmark_left.draw(),this.hashmark_right.draw(),this.hashmark_sideline_left.draw(),this.hashmark_sideline_right.draw(),this.los.draw(),this.ball.draw()},c.prototype.useAssignmentTool=function(a){if(!this.selectedElements.hasElements())return void console.error("Select a player first");var b=this.getSelectedByLayerType(Common.Enums.LayerTypes.PrimaryPlayer),c=this,d=null;if(b.size()>1)b.forEach(function(b,e){0==e?d=b.graphics.placement.coordinates.getRelativeTo(a,b):d.relativeElement=b,c._addAssignmentToPlayer.call(c,b,d)});else if(1==b.size()){var e=b.first();this._addAssignmentToPlayer(e,e.graphics.placement.coordinates.getRelativeTo(a,e))}},c.prototype._addAssignmentToPlayer=function(b,c){if(b.assignment&&b.assignment.routes&&0==b.assignment.routes.size()){var d=new a.Models.EditorRoute;d.setPlayer(b),d.flipped=b.flipped,b.assignment.addRoute(d)}b.assignment&&!b.layer.containsLayer(b.assignment.layer)&&b.layer.addLayer(b.assignment.layer);var e=b.assignment.routes.getOne();if(!e.dragInitialized){var f=new a.Models.EditorRouteNode(c,Common.Enums.RouteNodeTypes.Normal);f.initialize(this,b),e.addNode(f),b.assignment.updateRouteArray(),this.scenario.playPrimary.assignmentGroup.assignments.addAtIndex(b.assignment,b.position.index)}},c.prototype["export"]=function(){return null},c.prototype.placeAtYardline=function(a,b){},c.prototype.remove=function(){},c.prototype.getBBoxCoordinates=function(){},c.prototype.addPrimaryPlayer=function(b,c,d){var e=new a.Models.EditorPlayer(b,c,d);e.initialize(this),e.draw(),e.layer.type=Common.Enums.LayerTypes.PrimaryPlayer;var f=this;return e.onModified(function(){f.setModified(!0),f.scenario.playPrimary&&f.scenario.playPrimary.setModified(!0),f.scenario.playOpponent&&f.scenario.playOpponent.setModified(!0);
}),this.primaryPlayers.add(e),e},c.prototype.addOpponentPlayer=function(b,c,d){var e=new a.Models.EditorPlayer(b,c,d);e.initialize(this),e.draw(),e.layer.type=Common.Enums.LayerTypes.OpponentPlayer;var f=this;return e.onModified(function(){f.setModified(!0),f.scenario.playPrimary&&f.scenario.playPrimary.setModified(!0),f.scenario.playOpponent&&f.scenario.playOpponent.setModified(!0)}),this.opponentPlayers.add(e),e},c}(Common.Models.Field);b.EditorField=c}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(b){var c=function(b){function c(c,d){b.call(this,c,d),this.toolMode=a.Enums.ToolModes.Select,this.editorType=a.Enums.EditorTypes.Any,this.tab=null,this.readyCallbacks.push(function(){console.log("CANVAS READY: default canvas ready callback")}),this.state=Common.Enums.State.Constructed}return __extends(c,b),c.prototype.initialize=function(b){if(Common.Utilities.isNotNullOrUndefined(b))this.container=b[0],this.$container=b;else if(Common.Utilities.isNullOrUndefined(this.$container))throw new Error("Canvas intialize: $container arg passed or existing canvas                     $container value is null or undefined. A jQuery HTML container element is                     required in order to intialize the canvas.");this.setDimensions(),this.grid=this.grid||new Common.Models.Grid(this,a.Constants.FIELD_COLS_FULL,a.Constants.FIELD_ROWS_FULL),this.drawing=new Common.Drawing.Utilities(this,this.grid),Common.Utilities.isNullOrUndefined(this.field)&&(this.field=new a.Models.EditorField(this)),this.field.initialize(),this.invokeListener("onready"),this.state=Common.Enums.State.Ready},c.prototype.setDimensions=function(){this.dimensions.width=this.$container.width(),this.dimensions.height=this.$container.height()},c.prototype.resetHeight=function(){},c.prototype.getToolMode=function(){return this.toolMode},c.prototype.getToolModeName=function(){return a.Enums.ToolModes[this.toolMode]},c}(Common.Models.Canvas);b.EditorCanvas=c}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this,a),this.initialize(),this.state=Common.Enums.State.Constructed}return __extends(c,b),c.prototype.initialize=function(){this.ball||(this.ball=new a.Models.PreviewBall,this.ball.initialize(this,null),this.layer.addLayer(this.ball.layer)),this.ground||(this.ground=new a.Models.PreviewGround,this.ground.initialize(this,null),this.layer.addLayer(this.ground.layer)),this.los||(this.los=new a.Models.PreviewLineOfScrimmage,this.los.initialize(this,null),this.layer.addLayer(this.los.layer)),this.endzone_top||(this.endzone_top=new a.Models.PreviewEndzone(0),this.endzone_top.initialize(this,null),this.layer.addLayer(this.endzone_top.layer)),this.endzone_bottom||(this.endzone_bottom=new a.Models.PreviewEndzone(110),this.endzone_bottom.initialize(this,null),this.layer.addLayer(this.endzone_bottom.layer)),this.sideline_left||(this.sideline_left=new a.Models.PreviewSideline(0),this.sideline_left.initialize(this,null),this.layer.addLayer(this.sideline_left.layer)),this.sideline_right||(this.sideline_right=new a.Models.PreviewSideline(51),this.sideline_right.initialize(this,null),this.layer.addLayer(this.sideline_right.layer)),this.hashmark_left||(this.hashmark_left=new a.Models.PreviewHashmark(22),this.hashmark_left.initialize(this,null),this.layer.addLayer(this.hashmark_left.layer)),this.hashmark_right||(this.hashmark_right=new a.Models.PreviewHashmark(28),this.hashmark_right.initialize(this,null),this.layer.addLayer(this.hashmark_right.layer)),this.hashmark_sideline_left||(this.hashmark_sideline_left=new a.Models.PreviewHashmark(2),this.hashmark_sideline_left.initialize(this,null),this.layer.addLayer(this.hashmark_sideline_left.layer)),this.hashmark_sideline_right||(this.hashmark_sideline_right=new a.Models.PreviewHashmark(50),this.hashmark_sideline_right.initialize(this,null),this.layer.addLayer(this.hashmark_sideline_right.layer)),this.draw(),this.invokeListener("onready"),this.state=Common.Enums.State.Ready},c.prototype.draw=function(){this.ground.draw(),this.hashmark_left.draw(),this.hashmark_right.draw(),this.sideline_left.draw(),this.sideline_right.draw(),this.endzone_top.draw(),this.endzone_bottom.draw(),this.los.draw(),this.ball.draw()},c.prototype.addPrimaryPlayer=function(b,c,d){var e=new a.Models.PreviewPlayer(b,c,d);return e.initialize(this),e.draw(),e.layer.type=Common.Enums.LayerTypes.PrimaryPlayer,this.primaryPlayers.add(e),e},c.prototype.addOpponentPlayer=function(b,c,d){var e=new a.Models.PreviewPlayer(b,c,d);return e.initialize(this),e.draw(),e.layer.type=Common.Enums.LayerTypes.OpponentPlayer,this.opponentPlayers.add(e),e},c.prototype.useAssignmentTool=function(a){},c}(Common.Models.Field);b.PreviewField=c}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this.sizingMode=Common.Enums.CanvasSizingModes.PreviewWidth,this.dimensions.setMinWidth(250),this.dimensions.setMinHeight(200),this.state=Common.Enums.State.Constructed}return __extends(c,b),c.prototype.initialize=function(b){this.container=b[0],this.$container=b,this.setDimensions(),this.grid=new Common.Models.Grid(this,a.Constants.FIELD_COLS_FULL,a.Constants.FIELD_ROWS_FULL),this.drawing=new Common.Drawing.Utilities(this,this.grid),this.field=new a.Models.PreviewField(this),this.field.initialize(),this.$exportCanvas=$("<canvas/>",{id:"exportCanvas"+this.guid}).width(this.dimensions.width).height(this.dimensions.height),this.exportCanvas=this.$exportCanvas[0],this.invokeListener("onready"),this.state=Common.Enums.State.Ready},c.prototype.setDimensions=function(){this.dimensions.width=Math.min(500,this.$container.width()),this.dimensions.height=Math.min(400,this.$container.height())},c}(Common.Models.Canvas);b.PreviewCanvas=c}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.initialize=function(b){a.prototype.initialize.call(this,b),this.graphics.setOffsetXY(0,2),this.graphics.dimensions.setHeight(1),this.hoverable=!1,this.selectable=!1},b.prototype.draw=function(){this.graphics.rect()},b}(Common.Models.LineOfScrimmage);a.PreviewLineOfScrimmage=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.initialize=function(b){a.prototype.initialize.call(this,b),this.graphics.dimensions.setOffsetXY(0,8),this.graphics.dimensions.setHeight(4),this.graphics.selectedFill="blue"},b.prototype.draw=function(){this.graphics.rect(),this.graphics.setAttribute("class","ns-resize"),this.graphics.ondrag(this.dragMove,this.dragStart,this.dragEnd,this),this.onhover(this.hoverIn,this.hoverOut,this)},b.prototype.hoverIn=function(a){this.graphics.setHeight(7)},b.prototype.hoverOut=function(a){this.graphics.setHeight(4)},b.prototype.dragMove=function(a,b,c,d,e){(this.dragging||this.isOverDragThreshold(a,b))&&(this.dragging=!0,this.layer.moveByDelta(0,b),this.field.ball.dragging=!0,this.field.ball.layer.moveByDelta(0,b),this.field.primaryPlayers.forEach(function(a,c){a.layer.moveByDelta(0,b)}),this.field.opponentPlayers.forEach(function(a,c){a.layer.moveByDelta(0,b)}),this.setModified(!0))},b.prototype.dragStart=function(b,c,d){a.prototype.dragStart.call(this,b,c,d)},b.prototype.dragEnd=function(a){this.dragging&&(this.drop(),this.field.ball.drop(),this.field.primaryPlayers.forEach(function(a,b){a.drop()}),this.field.opponentPlayers.forEach(function(a,b){a.drop()}),this.dragging=!1)},b}(Common.Models.LineOfScrimmage);a.EditorLineOfScrimmage=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.draw=function(){a.prototype.draw.call(this)},b.prototype.hoverIn=function(a){},b.prototype.hoverOut=function(a){},b.prototype.click=function(a){},b.prototype.mousedown=function(a){},b.prototype.dragMove=function(a,b,c,d,e){},b.prototype.dragStart=function(a,b,c){},b.prototype.dragEnd=function(a){},b}(Common.Models.Ground);a.PreviewGround=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this.selectionBox=new Common.Models.FieldSelectionBox}return __extends(c,b),c.prototype.initialize=function(a,c){b.prototype.initialize.call(this,a,null),this.selectionBox.initialize(a,null),this.layer.addLayer(this.selectionBox.layer)},c.prototype.draw=function(){this.graphics.rect(),this.graphics.onclick(this.click,this),this.graphics.ondrag(this.dragMove,this.dragStart,this.dragEnd,this),this.graphics.onmousemove(this.mousemove,this)},c.prototype.mousemove=function(a){this.field.setCursorCoordinates(a.offsetX,a.offsetY)},c.prototype.click=function(b){var c=this.getClickCoordinates(b.offsetX,b.offsetY);console.log("ground clicked",c);var d=this.canvas.toolMode;switch(d){case a.Enums.ToolModes.Select:console.log("selection mode"),this.field.deselectAll();break;case a.Enums.ToolModes.None:console.log("no mode"),this.field.deselectAll();break;case a.Enums.ToolModes.Assignment:this.field.useAssignmentTool(c)}},c.prototype.dragMove=function(a,b,c,d,e){if(this.isOverDragThreshold(a,b)){this.dragging=!0;var f=0,g=0;0>a&&(f=a,a=-1*a),0>b&&(g=b,b=-1*b),this.selectionBox.graphics.dimensions.setWidth(a),this.selectionBox.graphics.dimensions.setHeight(b),this.selectionBox.draw(),this.selectionBox.graphics.transform(f,g)}},c.prototype.dragStart=function(a,c,d){b.prototype.dragStart.call(this,a,c,d);var e=this.getClickAbsolute(d.offsetX,d.offsetY);this.selectionBox.graphics.location.ax=e.x,this.selectionBox.graphics.location.ay=e.y},c.prototype.dragEnd=function(a){if(this.dragging){this.selectionBox.graphics.dimensions.setHeight(0),this.selectionBox.graphics.dimensions.setWidth(0);var c=this.selectionBox.graphics.getBBox();this.selectionBox.graphics.remove(),console.log(c),this.field.primaryPlayers.forEach(function(a,b){var d=a.icon.graphics.getBBox();(d.x>=c.x&&d.x<=c.x+c.width||d.x+d.width>=c.x&&d.x+d.width<=c.x+c.width)&&(d.y>=c.y&&d.y<=c.y+c.height||d.y+d.height>=c.y&&d.y+d.height<=c.y+c.height)&&a.toggleSelect(!0)})}b.prototype.dragEnd.call(this,a)},c}(Common.Models.Ground);b.EditorGround=c}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(Common.Models.Hashmark);a.PreviewHashmark=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(Common.Models.Hashmark);a.EditorHashmark=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.prototype.initialize=function(b){a.prototype.initialize.call(this,b),this.graphics.opacity=1},b}(Common.Models.Sideline);a.PreviewSideline=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(Common.Models.Sideline);a.EditorSideline=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(b){var c=function(b){function c(a,c,d){b.call(this,a,c,d)}return __extends(c,b),c.prototype.initialize=function(c){b.prototype.initialize.call(this,c),this.selectionBox=new a.Models.EditorPlayerSelectionBox(this),this.icon=new a.Models.EditorPlayerIcon(this),this.relativeCoordinatesLabel=new a.Models.EditorPlayerRelativeCoordinatesLabel(this),this.personnelLabel=new a.Models.EditorPlayerPersonnelLabel(this),this.indexLabel=new a.Models.EditorPlayerIndexLabel(this),this.renderType=Common.Enums.RenderTypes.Editor,this.layer.addLayer(this.selectionBox.layer),this.layer.addLayer(this.icon.layer),this.layer.addLayer(this.relativeCoordinatesLabel.layer),this.layer.addLayer(this.personnelLabel.layer),this.layer.addLayer(this.indexLabel.layer);var d=this;this.icon.layer.onModified(function(){console.log("editor player modified"),d.setModified(!0)}),Common.Utilities.isNotNullOrUndefined(this.assignment)&&this.canvas.editorType!=a.Enums.EditorTypes.Formation&&this.assignment.setRoutes(this,Common.Enums.RenderTypes.Editor),this.contextmenuTemplateUrl=Common.Constants.PLAYER_CONTEXTMENU_TEMPLATE_URL},c.prototype.draw=function(){this.selectionBox.draw(),this.icon.draw(),this.icon.graphics.ondrag(this.dragMove,this.dragStart,this.dragEnd,this),this.relativeCoordinatesLabel.draw(),this.personnelLabel.draw(),this.indexLabel.draw(),Common.Utilities.isNotNullOrUndefined(this.assignment)&&this.assignment.draw()},c.prototype.remove=function(){this.layer.remove(),this.assignment.remove()},c.prototype.mousedown=function(b){b.which==Common.Input.Which.RightClick&&this.canvas.listener.invoke(a.Enums.Actions.PlayerContextmenu,this)},c.prototype.click=function(b){b.ctrlKey&&(b.preventDefault(),b.isDefaultPrevented()||(b.returnValue=!1)),this.toggleSelect(b.metaKey);var c=this.canvas.toolMode;switch(c){case a.Enums.ToolModes.Select:break;case a.Enums.ToolModes.Assignment:}return b.returnValue},c.prototype.toggleSelect=function(a){this.icon.toggleSelect(a),a?this.field.toggleSelection(this):this.field.setSelection(this)},c.prototype.deselect=function(){this.icon.deselect()},c.prototype.select=function(){this.icon.select()},c.prototype.dragMove=function(b,c,d,e,f){if(this.dragging||this.isOverDragThreshold(b,c))if(this.dragging=!0,this.relativeCoordinatesLabel&&this.relativeCoordinatesLabel.layer.show(),this.canvas.toolMode!=a.Enums.ToolModes.Assignment){if(f.shiftKey||f.which==Common.Input.Which.RightClick)this.canvas.toolMode==a.Enums.ToolModes.Select||f.shiftKey||f.which==Common.Input.Which.RightClick;else if(this.layer.moveByDelta(b,c),this.relativeCoordinatesLabel){var g=[this.graphics.placement.relative.rx,", ",this.graphics.placement.relative.ry].join("");this.relativeCoordinatesLabel.graphics.attrKeyValue("text",g)}}else{this.assignment||(this.assignment=new Common.Models.Assignment(this.position.unitType),this.assignment.positionIndex=this.position.index);var h=this.assignment.routes.getOne();if(!h){var i=new a.Models.EditorRoute(!0);this.assignment.routes.add(i),h=this.assignment.routes.get(i.guid)}if(h.dragInitialized){var j=new Common.Models.Coordinates(this.graphics.location.ax+b,this.graphics.location.ay+c);h.initializeCurve(j,f.shiftKey)}}},c.prototype.dragStart=function(a,c,d){b.prototype.dragStart.call(this,a,c,d)},c.prototype.dragEnd=function(a){this.dragging&&(this.drop(),this.relativeCoordinatesLabel&&this.relativeCoordinatesLabel.layer.hide()),b.prototype.dragEnd.call(this,a)},c.prototype.clearRoute=function(){},c.prototype.setRouteFromDefaults=function(a){},c.prototype.onkeypress=function(){},c.prototype.getPositionRelativeToBall=function(){return this.graphics.placement.relative},c.prototype.getCoordinatesFromAbsolute=function(){return this.graphics.placement.coordinates},c.prototype.hasPlacement=function(){return null!=this.graphics.placement},c.prototype.hasPosition=function(){return null!=this.position},c.prototype.setAssignment=function(a){b.prototype.setAssignment.call(this,a),Common.Utilities.isNotNullOrUndefined(a)&&this.assignment.setRoutes(this,Common.Enums.RenderTypes.Editor),this.setModified(!0)},c}(Common.Models.Player);b.EditorPlayer=c}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(b){var c=function(b){function c(a,c,d){b.call(this,a,c,d)}return __extends(c,b),c.prototype.initialize=function(c){b.prototype.initialize.call(this,c),this.icon=new a.Models.PreviewPlayerIcon(this),this.personnelLabel=new a.Models.PreviewPlayerPersonnelLabel(this),this.renderType=Common.Enums.RenderTypes.Preview,this.layer.addLayer(this.icon.layer),Common.Utilities.isNotNullOrUndefined(this.assignment)&&this.assignment.setRoutes(this,Common.Enums.RenderTypes.Preview)},c.prototype.draw=function(){this.icon.draw(),Common.Utilities.isNotNullOrUndefined(this.assignment)&&this.assignment.draw()},c.prototype.dragMove=function(a,b,c,d,e){},c.prototype.dragStart=function(a,b,c){},c.prototype.dragEnd=function(a){},c.prototype.setAssignment=function(a){b.prototype.setAssignment.call(this,a),Common.Utilities.isNotNullOrUndefined(a)&&this.assignment.setRoutes(this,Common.Enums.RenderTypes.Preview),this.setModified(!0)},c}(Common.Models.Player);b.PreviewPlayer=c}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b),this.graphics.setHoverOpacity(.6)}return __extends(b,a),b.prototype.draw=function(){a.prototype.draw.call(this),this.graphics.setAttribute("class","pointer"),this.graphics.onclick(this.click,this),this.graphics.onhover(this.player.hoverIn,this.player.hoverOut,this.player),this.graphics.onmousedown(this.player.mousedown,this.player)},b.prototype.click=function(a){this.player.click(a)},b}(Common.Models.PlayerIcon);a.EditorPlayerIcon=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b),this.graphics.fill="black",this.graphics.setStrokeWidth(0)}return __extends(b,a),b}(Common.Models.PlayerIcon);a.PreviewPlayerIcon=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(Common.Models.PlayerRelativeCoordinatesLabel);a.PreviewPlayerRelativeCoordinatesLabel=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(Common.Models.PlayerRelativeCoordinatesLabel);a.EditorPlayerRelativeCoordinatesLabel=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(Common.Models.PlayerPersonnelLabel);a.EditorPlayerPersonnelLabel=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(Common.Models.PlayerPersonnelLabel);a.PreviewPlayerPersonnelLabel=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(Common.Models.PlayerIndexLabel);a.EditorPlayerIndexLabel=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.prototype.draw=function(){},b}(Common.Models.PlayerIndexLabel);a.PreviewPlayerIndexLabel=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(Common.Models.PlayerSelectionBox);a.EditorPlayerSelectionBox=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.prototype.draw=function(){},b}(Common.Models.PlayerSelectionBox);a.PreviewPlayerSelectionBox=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.setPlayer=function(c){b.prototype.setPlayer.call(this,c),this.player,this.routePath=new a.Models.PreviewRoutePath,this.routePath.initialize(this.field,this),this.graphics.disable(),this.renderType=Common.Enums.RenderTypes.Preview},c.prototype.addNode=function(c,d){if(this.nodes.isEmpty()&&c.type!=Common.Enums.RouteNodeTypes.Root){var e=new a.Models.PreviewRouteNode(new Common.Models.RelativeCoordinates(0,0,this.player),Common.Enums.RouteNodeTypes.Root);e.initialize(this.field,this.player),b.prototype.addNode.call(this,e,!1),this.disableRootNode(e)}return b.prototype.addNode.call(this,c,!1)},c.prototype.setContext=function(a){},c.prototype.moveNodesByDelta=function(a,b){},c.prototype.initializeCurve=function(a,b){},c}(Common.Models.Route);b.PreviewRoute=c}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this,a)}return __extends(c,b),c.prototype.setPlayer=function(c){b.prototype.setPlayer.call(this,c),this.routePath=new a.Models.EditorRoutePath,this.routePath.initialize(this.field,this),this.renderType=Common.Enums.RenderTypes.Editor},c.prototype.setContext=function(a){if(a){this.player=a,this.grid=this.player.grid,this.field=this.player.field,this.canvas=this.player.canvas;var b=this;this.nodes.forEach(function(a,c){a.setContext(b),b.layer.containsLayer(a.layer)||b.layer.addLayer(a.layer)}),this.draw()}},c.prototype.addNode=function(c,d){if(this.nodes.isEmpty()&&c.type!=Common.Enums.RouteNodeTypes.Root){var e=new a.Models.EditorRouteNode(new Common.Models.RelativeCoordinates(0,0,this.player),Common.Enums.RouteNodeTypes.Root);e.initialize(this.field,this.player),b.prototype.addNode.call(this,e,!1),this.disableRootNode(e)}return b.prototype.addNode.call(this,c,!1)},c.prototype.initializeCurve=function(b,c){if(0!=this.nodes.size()){var d,e,f;this.nodes.hasElements()&&1==this.nodes.size()?(d=this.nodes.getLast(),d.type=Common.Enums.RouteNodeTypes.CurveStart,e=new a.Models.EditorRouteNode(new Common.Models.RelativeCoordinates(d.graphics.placement.relative.rx,d.graphics.placement.relative.ry,this.player),Common.Enums.RouteNodeTypes.CurveControl),e.initialize(this.field,this.player),f=new a.Models.EditorRouteNode(new Common.Models.RelativeCoordinates(d.graphics.placement.relative.rx,d.graphics.placement.relative.ry,this.player),Common.Enums.RouteNodeTypes.CurveEnd),f.initialize(this.field,this.player),this.addNode(e,!1),this.addNode(f,!0)):(d=this.nodes.getRoot(),e=this.nodes.getIndex(1),f=this.nodes.getIndex(2)),c===!0?e.graphics.updateFromAbsolute(b.x,d.graphics.location.ay):e.graphics.updateFromAbsolute(d.graphics.location.ax,b.y),f.graphics.updateFromAbsolute(b.x,b.y),this.drawCurve(e)}},c.prototype.moveNodesByDelta=function(a,b){this.nodes.forEach(function(c,d){c&&c.moveByDelta(a,b)})},c}(Common.Models.Route);b.EditorRoute=c}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(b){var c=function(b){function c(c,d){b.call(this,c,d),this.routeAction=new a.Models.PreviewRouteAction(Common.Enums.RouteNodeActions.None),this.routeControlPath=new a.Models.PreviewRouteControlPath,this.renderType=Common.Enums.RenderTypes.Preview}return __extends(c,b),c.prototype.initialize=function(a,c){b.prototype.initialize.call(this,a,c),this.contextmenuTemplateUrl=null,this.routeAction.initialize(this.field,this),this.routeControlPath.initialize(this.field,this),this.layer.addLayer(this.routeAction.layer),this.layer.addLayer(this.routeControlPath.layer),this.route.layer.addLayer(this.layer),this.disable()},c}(Common.Models.RouteNode);b.PreviewRouteNode=c}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(b){var c=function(b){function c(c,d){b.call(this,c,d),this.routeAction=new a.Models.EditorRouteAction(Common.Enums.RouteNodeActions.None),this.routeControlPath=new a.Models.EditorRouteControlPath,this.renderType=Common.Enums.RenderTypes.Editor,this.contextmenuTemplateUrl=Common.Constants.EDITOR_ROUTENODE_CONTEXTMENU_TEMPLATE_URL}return __extends(c,b),c.prototype.initialize=function(a,c){b.prototype.initialize.call(this,a,c),this.graphics.enable(),this.graphics.setOriginalFill("#222222"),this.graphics.setHoverOpacity(1),this.graphics.setOriginalOpacity(.05),this.graphics.setSelectedFillOpacity(1),this.graphics.setSelectedFill("#222222"),this.routeAction.initialize(this.field,this),this.routeControlPath.initialize(this.field,this),this.layer.addLayer(this.routeAction.layer),this.layer.addLayer(this.routeControlPath.layer),this.route.layer.addLayer(this.layer)},c.prototype.draw=function(){b.prototype.draw.call(this),this.graphics.setAttribute("class","grab"),this.graphics.onclick(this.click,this),this.graphics.ondrag(this.dragMove,this.dragStart,this.dragEnd,this),this.graphics.onhover(this.hoverIn,this.hoverOut,this),this.graphics.oncontextmenu(this.contextmenu,this),this.type==Common.Enums.RouteNodeTypes.CurveControl},c.prototype.hoverIn=function(a){this.graphics.toggleOpacity()},c.prototype.hoverOut=function(a){this.graphics.toggleOpacity()},c.prototype.click=function(a){this.field.toggleSelection(this)},c.prototype.contextmenu=function(b){this.canvas.listener.invoke(a.Enums.Actions.RouteNodeContextmenu,new Common.Models.ContextmenuData(this,b.pageX,b.pageY))},c.prototype.dragMove=function(a,b,c,d,e){if(!this.disabled){if(this.graphics.moveByDelta(a,b),this.routeAction){this.routeAction.layer.moveByDelta(a,b);var f=Common.Drawing.Utilities.theta(this.prev.graphics.location.ax,this.prev.graphics.location.ay,this.graphics.location.ax,this.graphics.location.ay),g=Common.Drawing.Utilities.toDegrees(f);this.routeAction.graphics.rotate(90-g)}this.isCurveNode()&&console.log("dragging control:",this.type),this.route.draw()}},c.prototype.dragStart=function(a,c,d){b.prototype.dragStart.call(this,a,c,d),this.listen(!1)},c.prototype.dragEnd=function(a){b.prototype.dragEnd.call(this,a),this.listen(!0),this.drop(),this.route.draw(),this.setModified(!0)},c.prototype.drop=function(){b.prototype.drop.call(this),this.routeAction&&this.routeAction.drop(),this.setModified()},c}(Common.Models.RouteNode);b.EditorRouteNode=c}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.initialize=function(b,c){a.prototype.initialize.call(this,b,c),this.graphics.setOriginalStrokeWidth(2),this.route.layer.addLayer(this.layer)},b}(Common.Models.RoutePath);a.PreviewRoutePath=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.initialize=function(b,c){a.prototype.initialize.call(this,b,c),this.route.layer.addLayer(this.layer)},b.prototype.draw=function(){a.prototype.draw.call(this),this.graphics.setAttribute("class","painted-fill pointer"),this.onhover(this.hoverIn,this.hoverOut,this)},b.prototype.hoverIn=function(a){this.graphics.setStrokeWidth(6)},b.prototype.hoverOut=function(a){this.graphics.setStrokeWidth(3)},b}(Common.Models.RoutePath);a.EditorRoutePath=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.prototype.initialize=function(b,c){a.prototype.initialize.call(this,b,c)},b.prototype.draw=function(){},b}(Common.Models.RouteAction);a.PreviewRouteAction=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.prototype.initialize=function(b,c){a.prototype.initialize.call(this,b,c)},b}(Common.Models.RouteAction);a.EditorRouteAction=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.draw=function(){},b}(Common.Models.RouteControlPath);a.PreviewRouteControlPath=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b}(Common.Models.RouteControlPath);a.EditorRouteControlPath=b}(b=a.Models||(a.Models={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){!function(a){a[a.FieldElementContextmenu=0]="FieldElementContextmenu",a[a.PlayerContextmenu=1]="PlayerContextmenu",a[a.RouteNodeContextmenu=2]="RouteNodeContextmenu",a[a.RouteTreeSelection=3]="RouteTreeSelection"}(a.Actions||(a.Actions={}));a.Actions;!function(a){a[a.None=0]="None",a[a.Select=1]="Select",a[a.Formation=2]="Formation",a[a.Assignment=3]="Assignment",a[a.Zoom=4]="Zoom"}(a.ToolModes||(a.ToolModes={}));a.ToolModes;!function(a){a[a.Nothing=0]="Nothing",a[a.Select=1]="Select",a[a.ToggleMenu=2]="ToggleMenu",a[a.AddPlayer=3]="AddPlayer",a[a.Save=4]="Save",a[a.ZoomIn=5]="ZoomIn",a[a.ZoomOut=6]="ZoomOut",a[a.Assignment=7]="Assignment"}(a.ToolActions||(a.ToolActions={}));a.ToolActions;!function(a){a[a.Any=0]="Any",a[a.Formation=1]="Formation",a[a.Assignment=2]="Assignment",a[a.Play=3]="Play",a[a.Scenario=4]="Scenario"}(a.EditorTypes||(a.EditorTypes={}));a.EditorTypes;!function(a){a[a.Any=0]="Any",a[a.Primary=1]="Primary",a[a.Opponent=2]="Opponent",a[a.Unknown=3]="Unknown"}(a.PlayTypes||(a.PlayTypes={}));a.PlayTypes;!function(a){a[a.CircleEditor=0]="CircleEditor",a[a.SquareEditor=1]="SquareEditor",a[a.TriangleEditor=2]="TriangleEditor",a[a.CirclePreview=3]="CirclePreview",a[a.SquarePreview=4]="SquarePreview",a[a.TrianglePreview=5]="TrianglePreview"}(a.PlayerIconTypes||(a.PlayerIconTypes={}));a.PlayerIconTypes;!function(a){a[a.Left=0]="Left",a[a.Center=1]="Center",a[a.Right=2]="Right"}(a.Hashmark||(a.Hashmark={}));a.Hashmark;!function(a){a[a.Goalline=0]="Goalline",a[a.Redzone=1]="Redzone",a[a.Midfield=2]="Midfield",a[a.Endzone=3]="Endzone",a[a.LineOfScrimmage=4]="LineOfScrimmage"}(a.FieldZones||(a.FieldZones={}));a.FieldZones}(b=a.Enums||(a.Enums={}))}(Playbook||(Playbook={}));var Playbook;!function(a){var b;!function(a){a.FIELD_COLS_FULL=52,a.FIELD_ROWS_FULL=120,a.FIELD_COLOR="#638148",a.GRID_SIZE=15,a.GRID_BASE=10,a.BALL_DEFAULT_PLACEMENT_X=25,a.BALL_DEFAULT_PLACEMENT_Y=60,a.PREVIEW_PLAYER_ICON_RADIUS=5,a.DRAG_THRESHOLD_X=5,a.DRAG_THRESHOLD_Y=5}(b=a.Constants||(a.Constants={}))}(Playbook||(Playbook={}));var Team;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this,Common.Enums.ImpaktDataTypes.Team),this.name="",this.teamType=a.Enums.TeamTypes.Mixed,this.records=new a.Models.TeamRecordCollection,this.division=new League.Models.Division,this.divisionGuid="",this.location=new League.Models.Location,this.locationGuid="";this.onModified(function(a){}),this.associable=["leagues","conferences","divisions","playbooks","locations"]}return __extends(c,b),c.prototype.toJson=function(){return $.extend({name:this.name,teamType:this.teamType,records:this.records.toJson(),divisionGuid:this.divisionGuid,locationGuid:this.locationGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){return a?(this.teamType=a.teamType,this.name=a.name,this.records.fromJson(a.records),this.divisionGuid=a.divisionGuid,this.locationGuid=a.locationGuid,void b.prototype.fromJson.call(this,a)):null},c.prototype.setDivision=function(a){this.division=a,this.divisionGuid=this.division?this.division.guid:""},c.prototype.setLocation=function(a){this.location=a,this.locationGuid=this.location?this.location.guid:""},c}(Common.Models.AssociableEntity);b.TeamModel=c}(b=a.Models||(a.Models={}))}(Team||(Team={}));var Team;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this.teamType=a.Enums.TeamTypes.Mixed}return __extends(c,b),c.prototype.toJson=function(){return{teamType:this.teamType,guid:this.guid,teams:b.prototype.toJson.call(this)}},c.prototype.fromJson=function(b){if(b){this.teamType=b.teamType,this.guid=b.guid;for(var c=b.teams||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){e.teamType=Common.Utilities.isNullOrUndefined(e.teamType)&&e.teamType>=0?e.teamType:a.Enums.TeamTypes.Other;var f=new a.Models.TeamModel;f.fromJson(e),this.add(f)}}}},c}(Common.Models.ActionableCollection);b.TeamModelCollection=c}(b=a.Models||(a.Models={}));
}(Team||(Team={}));var Team;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this),a.prototype.setContext.call(this,this),this.wins=0,this.losses=0,this.season=2016}return __extends(b,a),b.prototype.toJson=function(){return{wins:this.wins,losses:this.losses,season:this.season}},b.prototype.fromJson=function(a){a&&(this.wins=a.wins,this.losses=a.losses,this.season=a.season)},b}(Common.Models.Modifiable);a.TeamRecord=b}(b=a.Models||(a.Models={}))}(Team||(Team={}));var Team;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.toJson=function(){return b.prototype.toJson.call(this)},c.prototype.fromJson=function(b){if(b)for(var c=b.records||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){var f=new a.Models.TeamRecord;f.fromJson(e),this.add(f)}}},c}(Common.Models.Collection);b.TeamRecordCollection=c}(b=a.Models||(a.Models={}))}(Team||(Team={}));var Team;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this.teamType=a.Enums.TeamTypes.Primary,this.onModified(function(a){})}return __extends(c,b),c.prototype.toJson=function(){return{}},c.prototype.fromJson=function(a){},c}(a.Models.TeamModel);b.PrimaryTeam=c}(b=a.Models||(a.Models={}))}(Team||(Team={}));var Team;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this.teamType=a.Enums.TeamTypes.Opponent,this.onModified(function(a){})}return __extends(c,b),c.prototype.toJson=function(){return{}},c.prototype.fromJson=function(a){},c}(a.Models.TeamModel);b.OpponentTeam=c}(b=a.Models||(a.Models={}))}(Team||(Team={}));var Team;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this,Common.Enums.ImpaktDataTypes.PersonnelGroup),this.name="Untitled",this.unitType=a,this.positions=null,this.setType=Common.Enums.SetTypes.Personnel,this.onModified(function(a){})}return __extends(c,b),c.prototype.copy=function(c){var d=c||new a.Models.Personnel(this.unitType);return b.prototype.copy.call(this,d,this)},c.prototype.hasPositions=function(){return this.positions&&this.positions.size()>0},c.prototype.update=function(a){this.unitType=a.unitType,this.key=a.key,this.name=a.name,this.guid=a.guid},c.prototype.fromJson=function(c){return c?(this.unitType=c.unitType,this.positions?this.positions.removeAll():this.positions=new a.Models.PositionCollection(this.unitType),this.positions.fromJson(c.positions),this.name=c.name,void b.prototype.fromJson.call(this,c)):null},c.prototype.toJson=function(){return $.extend({name:this.name,unitType:this.unitType,positions:this.positions.toJson()},b.prototype.toJson.call(this))},c.prototype.setDefault=function(){this.positions=a.Models.PositionDefault.getBlank(this.unitType),this.positions.onModified(function(a){})},c.prototype.setUnitType=function(a){this.unitType=a,this.setDefault()},c}(Common.Models.AssociableEntity);b.Personnel=c}(b=a.Models||(a.Models={}))}(Team||(Team={}));var Team;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this),this.unitType=a,this.setType=Common.Enums.SetTypes.Personnel}return __extends(c,b),c.prototype.toJson=function(){return{unitType:this.unitType,setType:this.setType,personnel:b.prototype.toJson.call(this)}},c.prototype.fromJson=function(b){if(b){this.unitType=b.unitType,this.guid=b.guid,this.setType=b.setType;for(var c=b.personnel||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){e.unitType=Common.Utilities.isNullOrUndefined(e.unitType)&&e.unitType>=0?e.unitType:a.Enums.UnitTypes.Other;var f=new a.Models.Personnel(e.unitType);f.fromJson(e),this.add(f)}}}},c}(Common.Models.Collection);b.PersonnelCollection=c}(b=a.Models||(a.Models={}))}(Team||(Team={}));var Team;!function(a){var b;!function(b){var c=function(a){function b(b,c){a.call(this),a.prototype.setContext.call(this,this),c||(c={}),this.unitType=b,this.positionListValue=c.positionListValue||d.Other,this.title=c.title||"Untitled",this.label=c.label||"-",this.eligible=c.eligible||!1,this.index=c.index>=0?c.index:-1}return __extends(b,a),b.prototype.toJson=function(){return{positionListValue:this.positionListValue,title:this.title,label:this.label,eligible:this.eligible,index:this.index,unitType:this.unitType,guid:this.guid}},b.prototype.fromJson=function(a){this.positionListValue=a.positionListValue,this.label=a.label,this.eligible=a.eligible,this.title=a.title,this.unitType=a.unitType,this.index=a.index,this.guid=a.guid},b}(Common.Models.Modifiable);b.Position=c,function(a){a[a.BlankOffense=0]="BlankOffense",a[a.BlankDefense=1]="BlankDefense",a[a.BlankSpecialTeams=2]="BlankSpecialTeams",a[a.BlankOther=3]="BlankOther",a[a.Quarterback=4]="Quarterback",a[a.RunningBack=5]="RunningBack",a[a.FullBack=6]="FullBack",a[a.TightEnd=7]="TightEnd",a[a.Center=8]="Center",a[a.Guard=9]="Guard",a[a.Tackle=10]="Tackle",a[a.WideReceiver=11]="WideReceiver",a[a.SlotReceiver=12]="SlotReceiver",a[a.NoseGuard=13]="NoseGuard",a[a.DefensiveTackle=14]="DefensiveTackle",a[a.DefensiveGuard=15]="DefensiveGuard",a[a.DefensiveEnd=16]="DefensiveEnd",a[a.Linebacker=17]="Linebacker",a[a.Safety=18]="Safety",a[a.FreeSafety=19]="FreeSafety",a[a.StrongSafety=20]="StrongSafety",a[a.DefensiveBack=21]="DefensiveBack",a[a.Cornerback=22]="Cornerback",a[a.Kicker=23]="Kicker",a[a.Holder=24]="Holder",a[a.Punter=25]="Punter",a[a.LongSnapper=26]="LongSnapper",a[a.KickoffSpecialist=27]="KickoffSpecialist",a[a.PuntReturner=28]="PuntReturner",a[a.KickReturner=29]="KickReturner",a[a.Upback=30]="Upback",a[a.Gunner=31]="Gunner",a[a.Jammer=32]="Jammer",a[a.Other=33]="Other"}(b.PositionList||(b.PositionList={}));var d=b.PositionList,e=function(){function b(){a.Models.PositionDefault.defaults={blankOffense:{positionListValue:a.Models.PositionList.BlankOffense,title:"Blank",label:"",unitType:a.Enums.UnitTypes.Offense,eligible:!1},blankDefense:{positionListValue:a.Models.PositionList.BlankDefense,title:"Blank",label:"",unitType:a.Enums.UnitTypes.Defense,eligible:!1},blankSpecialTeams:{positionListValue:a.Models.PositionList.BlankSpecialTeams,title:"Blank",label:"",unitType:a.Enums.UnitTypes.SpecialTeams,eligible:!1},blankOther:{positionListValue:a.Models.PositionList.BlankOther,title:"Blank",label:"",unitType:a.Enums.UnitTypes.Other,eligible:!1},quarterback:{positionListValue:a.Models.PositionList.Quarterback,title:"Quarterback",label:"QB",unitType:a.Enums.UnitTypes.Offense,eligible:!1},runningBack:{positionListValue:a.Models.PositionList.RunningBack,title:"Running Back",label:"RB",unitType:a.Enums.UnitTypes.Offense,eligible:!0},fullBack:{positionListValue:a.Models.PositionList.FullBack,title:"Full Back",label:"FB",unitType:a.Enums.UnitTypes.Offense,eligible:!0},tightEnd:{positionListValue:a.Models.PositionList.TightEnd,title:"Tight End",label:"TE",unitType:a.Enums.UnitTypes.Offense,eligible:!0},center:{positionListValue:a.Models.PositionList.Center,title:"Center",label:"C",unitType:a.Enums.UnitTypes.Offense,eligible:!1},guard:{positionListValue:a.Models.PositionList.Guard,title:"Guard",label:"G",unitType:a.Enums.UnitTypes.Offense,eligible:!1},tackle:{positionListValue:a.Models.PositionList.Tackle,title:"Tackle",label:"T",unitType:a.Enums.UnitTypes.Offense,eligible:!1},wideReceiver:{positionListValue:a.Models.PositionList.WideReceiver,title:"Wide Receiver",label:"WR",unitType:a.Enums.UnitTypes.Offense,eligible:!0},slotReceiver:{positionListValue:a.Models.PositionList.SlotReceiver,title:"Slot Receiver",label:"SL",unitType:a.Enums.UnitTypes.Offense,eligible:!0},noseGuard:{positionListValue:a.Models.PositionList.NoseGuard,title:"Nose Guard",label:"N",unitType:a.Enums.UnitTypes.Defense,eligible:!1},defensiveGuard:{positionListValue:a.Models.PositionList.DefensiveGuard,title:"Guard",label:"G",unitType:a.Enums.UnitTypes.Defense,eligible:!1},defensiveTackle:{positionListValue:a.Models.PositionList.DefensiveTackle,title:"Tackle",label:"T",unitType:a.Enums.UnitTypes.Defense,eligible:!1},defensiveEnd:{positionListValue:a.Models.PositionList.DefensiveEnd,title:"Defensive End",label:"DE",unitType:a.Enums.UnitTypes.Defense,eligible:!1},linebacker:{positionListValue:a.Models.PositionList.Linebacker,title:"Linebacker",label:"LB",unitType:a.Enums.UnitTypes.Defense,eligible:!1},safety:{positionListValue:a.Models.PositionList.Safety,title:"Safety",label:"S",unitType:a.Enums.UnitTypes.Defense,eligible:!1},freeSafety:{positionListValue:a.Models.PositionList.FreeSafety,title:"Free Safety",label:"FS",unitType:a.Enums.UnitTypes.Defense,eligible:!1},strongSafety:{positionListValue:a.Models.PositionList.StrongSafety,title:"Strong Safety",label:"SS",unitType:a.Enums.UnitTypes.Defense,eligible:!1},defensiveBack:{positionListValue:a.Models.PositionList.DefensiveBack,title:"Defensive Back",label:"DB",unitType:a.Enums.UnitTypes.Defense,eligible:!1},cornerback:{positionListValue:a.Models.PositionList.Cornerback,title:"Cornerback",label:"CB",unitType:a.Enums.UnitTypes.Defense,eligible:!1},kicker:{positionListValue:a.Models.PositionList.Kicker,title:"Kicker",label:"K",unitType:a.Enums.UnitTypes.SpecialTeams,eligible:!1},holder:{positionListValue:a.Models.PositionList.Holder,title:"Holder",label:"H",unitType:a.Enums.UnitTypes.SpecialTeams,eligible:!1},punter:{positionListValue:a.Models.PositionList.Punter,title:"Punter",label:"P",unitType:a.Enums.UnitTypes.SpecialTeams,eligible:!1},longSnapper:{positionListValue:a.Models.PositionList.LongSnapper,title:"Long Snapper",label:"LS",unitType:a.Enums.UnitTypes.SpecialTeams,eligible:!1},kickoffSpecialist:{positionListValue:a.Models.PositionList.KickoffSpecialist,title:"Kickoff Specialist",label:"KS",unitType:a.Enums.UnitTypes.SpecialTeams,eligible:!1},puntReturner:{positionListValue:a.Models.PositionList.PuntReturner,title:"Punt Returner",label:"PR",unitType:a.Enums.UnitTypes.SpecialTeams,eligible:!0},kickReturner:{positionListValue:a.Models.PositionList.KickReturner,title:"Kick Returner",label:"KR",unitType:a.Enums.UnitTypes.SpecialTeams,eligible:!0},upback:{positionListValue:a.Models.PositionList.Upback,title:"Upback",label:"U",unitType:a.Enums.UnitTypes.SpecialTeams,eligible:!0},gunner:{positionListValue:a.Models.PositionList.Gunner,title:"Gunner",label:"G",unitType:a.Enums.UnitTypes.SpecialTeams,eligible:!0},jammer:{positionListValue:a.Models.PositionList.Jammer,title:"Jammer",label:"J",unitType:a.Enums.UnitTypes.SpecialTeams,eligible:!0},other:{positionListValue:a.Models.PositionList.Other,title:"Other",label:"-",unitType:a.Enums.UnitTypes.Other,eligible:!1}}}return b.prototype.getPosition=function(b){var c=null;for(var d in a.Models.PositionDefault.defaults)if(a.Models.PositionDefault.defaults[d].positionListValue==b){var e=a.Models.PositionDefault.defaults[d];c=new a.Models.Position(e.unitType,e)}return c},b.prototype.switchPosition=function(a,b){var c=this.getPosition(b);return c.index=a.index,c},b.getBlank=function(b){var c=new a.Models.PositionCollection(b),d=null;switch(b){case a.Enums.UnitTypes.Offense:d=a.Models.PositionDefault.defaults.blankOffense;break;case a.Enums.UnitTypes.Defense:d=a.Models.PositionDefault.defaults.blankDefense;break;case a.Enums.UnitTypes.SpecialTeams:d=a.Models.PositionDefault.defaults.blankSpecialTeams;break;case a.Enums.UnitTypes.Other:d=a.Models.PositionDefault.defaults.blankOther}if(!d)return null;for(var e=0;11>e;e++){var f=new a.Models.Position(d.unitType,d);f.index=e,c.add(f)}return c},b.prototype.getByUnitType=function(b){var c=new a.Models.PositionCollection(b);switch(b){case a.Enums.UnitTypes.Offense:c.fromJson([new a.Models.Position(b,a.Models.PositionDefault.defaults.blankOffense),new a.Models.Position(b,a.Models.PositionDefault.defaults.quarterback),new a.Models.Position(b,a.Models.PositionDefault.defaults.runningBack),new a.Models.Position(b,a.Models.PositionDefault.defaults.fullBack),new a.Models.Position(b,a.Models.PositionDefault.defaults.tightEnd),new a.Models.Position(b,a.Models.PositionDefault.defaults.center),new a.Models.Position(b,a.Models.PositionDefault.defaults.guard),new a.Models.Position(b,a.Models.PositionDefault.defaults.tackle),new a.Models.Position(b,a.Models.PositionDefault.defaults.wideReceiver),new a.Models.Position(b,a.Models.PositionDefault.defaults.slotReceiver)]);break;case a.Enums.UnitTypes.Defense:c.fromJson([new a.Models.Position(b,a.Models.PositionDefault.defaults.blankDefense),new a.Models.Position(b,a.Models.PositionDefault.defaults.noseGuard),new a.Models.Position(b,a.Models.PositionDefault.defaults.defensiveTackle),new a.Models.Position(b,a.Models.PositionDefault.defaults.defensiveGuard),new a.Models.Position(b,a.Models.PositionDefault.defaults.defensiveEnd),new a.Models.Position(b,a.Models.PositionDefault.defaults.linebacker),new a.Models.Position(b,a.Models.PositionDefault.defaults.safety),new a.Models.Position(b,a.Models.PositionDefault.defaults.freeSafety),new a.Models.Position(b,a.Models.PositionDefault.defaults.strongSafety),new a.Models.Position(b,a.Models.PositionDefault.defaults.defensiveBack),new a.Models.Position(b,a.Models.PositionDefault.defaults.cornerback)]);break;case a.Enums.UnitTypes.SpecialTeams:c.fromJson([new a.Models.Position(b,a.Models.PositionDefault.defaults.blankSpecialTeams),new a.Models.Position(b,a.Models.PositionDefault.defaults.kicker),new a.Models.Position(b,a.Models.PositionDefault.defaults.holder),new a.Models.Position(b,a.Models.PositionDefault.defaults.punter),new a.Models.Position(b,a.Models.PositionDefault.defaults.longSnapper),new a.Models.Position(b,a.Models.PositionDefault.defaults.kickoffSpecialist),new a.Models.Position(b,a.Models.PositionDefault.defaults.puntReturner),new a.Models.Position(b,a.Models.PositionDefault.defaults.kickReturner),new a.Models.Position(b,a.Models.PositionDefault.defaults.upback),new a.Models.Position(b,a.Models.PositionDefault.defaults.gunner),new a.Models.Position(b,a.Models.PositionDefault.defaults.jamme)]);break;case a.Enums.UnitTypes.Other:c.fromJson([new a.Models.Position(b,a.Models.PositionDefault.defaults.blankOther),new a.Models.Position(b,a.Models.PositionDefault.defaults.other)]);break;default:c=null}return c},b}();b.PositionDefault=e}(b=a.Models||(a.Models={}))}(Team||(Team={}));var Team;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this),this.unitType=a,this.setDefault()}return __extends(c,b),c.prototype.listPositions=function(){var a=[];return this.forEach(function(b,c){a.push(b.title)}),a},c.prototype.toJson=function(){return b.prototype.toJson.call(this)},c.prototype.fromJson=function(b){if(b)for(var c=0;c<b.length;c++){var d=b[c];if(!Common.Utilities.isNullOrUndefined(d)){d.unitType=Common.Utilities.isNotNullOrUndefined(d.unitType)&&d.unitType>=0?d.unitType:a.Enums.UnitTypes.Other;var e=new a.Models.Position(d.unitType);e.fromJson(d),this.add(e)}}},c.prototype.setDefault=function(){},c}(Common.Models.Collection);b.PositionCollection=c}(b=a.Models||(a.Models={}))}(Team||(Team={}));var Team;!function(a){var b;!function(b){var c=function(b){function c(a,c){b.call(this),b.prototype.setContext.call(this,this),this.unitType=a,this.name=c}return __extends(c,b),c.getUnitTypes=function(){return Common.Utilities.convertEnumToList(a.Enums.UnitTypes)},c.prototype.toJson=function(){var a={unitType:this.unitType,name:this.name,guid:this.guid};return a},c.prototype.fromJson=function(a){a&&(this.unitType=a.unitType,this.name=a.name,this.guid=a.guid)},c}(Common.Models.Modifiable);b.UnitType=c}(b=a.Models||(a.Models={}))}(Team||(Team={}));var Team;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this);var c=new a.Models.UnitType(a.Enums.UnitTypes.Offense,"offense");this.add(c);var d=new a.Models.UnitType(a.Enums.UnitTypes.Defense,"defense");this.add(d);var e=new a.Models.UnitType(a.Enums.UnitTypes.SpecialTeams,"special teams");this.add(e);var f=new a.Models.UnitType(a.Enums.UnitTypes.Other,"other");this.add(f)}return __extends(c,b),c.prototype.getByUnitType=function(a){return this.filterFirst(function(b){return b.unitType==a})},c.prototype.getAssociatedPlaybooks=function(){var b=new Common.Models.PlaybookModelCollection(a.Enums.UnitTypes.Mixed);return this.forEach(function(a,c){a&&a.associated&&a.associated.playbooks&&a.associated.playbooks.hasElements()&&a.associated.playbooks.forEach(function(a,c){var d=impakt.context.Playbook.playbooks.get(a);d&&b.add(d)})}),b},c.prototype.toJson=function(){return b.prototype.toJson.call(this)},c.prototype.fromJson=function(a){a&&(this.guid=a.guid||this.guid)},c}(Common.Models.Collection);b.UnitTypeCollection=c}(b=a.Models||(a.Models={}))}(Team||(Team={}));var Team;!function(a){var b;!function(a){!function(a){a[a.Offense=0]="Offense",a[a.Defense=1]="Defense",a[a.SpecialTeams=2]="SpecialTeams",a[a.Other=3]="Other",a[a.Mixed=4]="Mixed"}(a.UnitTypes||(a.UnitTypes={}));a.UnitTypes;!function(a){a[a.Primary=0]="Primary",a[a.Opponent=1]="Opponent",a[a.Other=2]="Other",a[a.Mixed=3]="Mixed"}(a.TeamTypes||(a.TeamTypes={}));a.TeamTypes}(b=a.Enums||(a.Enums={}))}(Team||(Team={}));var Planning;!function(a){var b;!function(b){var c=function(b){function c(c){if(b.call(this,Common.Enums.ImpaktDataTypes.Unknown),Common.Utilities.isNullOrUndefined(c)||Common.Utilities.isEmptyString(c))throw new Error("PlanningEditorToggleItem constructor(): label is null or undefined");this.label=c,this.type=a.Enums.PlanningEditorToggleTypes.Unknown}return __extends(c,b),c.prototype.toJson=function(){return $.extend({label:this.label},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.label=a.label,b.prototype.fromJson.call(this,a))},c}(Common.Models.Actionable);b.PlanningEditorToggleItem=c}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.fromJson=function(a){if(a)for(var b=a||[],c=0;c<b.length;c++);},b}(Common.Models.ActionableCollection);a.PlanningEditorToggleItemCollection=b}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this,Common.Enums.ImpaktDataTypes.Plan),this.game=null,this.gameGuid="",this.start=new Common.Models.Datetime,this.associable=["games","practicePlans","practiceSchedules","gamePlans","scoutCards","QBWristbands","teams","playbooks"]}return __extends(b,a),b.prototype.toJson=function(){return $.extend({gameGuid:this.gameGuid,start:this.start},a.prototype.toJson.call(this))},b.prototype.fromJson=function(b){b&&(this.gameGuid=b.gameGuid,this.start.fromJson(b.start),a.prototype.fromJson.call(this,b))},b.prototype.setGame=function(a){this.game=a,this.gameGuid=this.game?this.game.guid:""},b}(Common.Models.AssociableEntity);a.Plan=b}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.toJson=function(){return{guid:this.guid,Plans:b.prototype.toJson.call(this)}},c.prototype.fromJson=function(b){if(b){this.guid=b.guid;for(var c=b.plans||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){var f=new a.Models.Plan;f.fromJson(e),this.add(f)}}}},c}(Common.Models.ActionableCollection);b.PlanCollection=c}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this,Common.Enums.ImpaktDataTypes.PracticePlan),this.plan=null,this.planGuid="",this.start=new Common.Models.Datetime,this.titleData=new a.Models.PracticePlanTitleData,this.situationData=new a.Models.PracticePlanSituationData,this.offensiveData=new a.Models.PracticePlanOffensiveData,this.defensiveData=new a.Models.PracticePlanDefensiveData,this.items=new a.Models.PracticePlanItemCollection,this._populateItems(),this.associable=["plans"]}return __extends(c,b),c.prototype.toJson=function(){return $.extend({planGuid:this.planGuid,start:this.start.toJson(),titleData:this.titleData.toJson(),situationData:this.situationData.toJson(),offensiveData:this.offensiveData.toJson(),defensiveData:this.defensiveData.toJson(),items:this.items.toJson()},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.planGuid=a.planGuid,this.start.fromJson(a.start),this.titleData.fromJson(a.titleData),this.situationData.fromJson(a.situationData),this.offensiveData.fromJson(a.offensiveData),this.defensiveData.fromJson(a.defensiveData),this.items.empty(!1),this.items.fromJson(a.items),b.prototype.fromJson.call(this,a))},c.prototype._populateItems=function(){for(var b=0;b<a.Constants.DEFAULT_PRACTICE_PLAN_ITEMS_LENGTH;b++){var c=new a.Models.PracticePlanItem;c.index=b,this.items.add(c,!1)}},c.prototype.setPlan=function(a){this.plan=a,this.planGuid=this.plan?this.plan.guid:""},c}(Common.Models.AssociableEntity);b.PracticePlan=c}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.toJson=function(){return{guid:this.guid,practicePlans:b.prototype.toJson.call(this)}},c.prototype.fromJson=function(b){if(b){this.guid=b.guid;for(var c=b.practicePlans||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){var f=new a.Models.PracticePlan;f.fromJson(e),this.add(f)}}}},c}(Common.Models.ActionableCollection);b.PracticePlanCollection=c}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this.index=-1,this.situationData=new a.Models.PracticePlanSituationData,this.offensiveData=new a.Models.PracticePlanOffensiveData,this.defensiveData=new a.Models.PracticePlanDefensiveData}return __extends(c,b),c.prototype.toJson=function(){return $.extend({index:this.index,situationData:this.situationData.toJson(),offensiveData:this.offensiveData.toJson(),defensiveData:this.defensiveData.toJson()},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.index=a.index,this.situationData.fromJson(a.situationData),this.offensiveData.fromJson(a.offensiveData),this.defensiveData.fromJson(a.defensiveData),b.prototype.fromJson.call(this,a))},c.prototype.getNumber=function(){return this.index+1},c}(Common.Models.Modifiable);b.PracticePlanItem=c}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(b){var c=function(b){function c(a){b.call(this,a)}return __extends(c,b),c.prototype.fromJson=function(c){if(c){for(var d=c||[],e=0;e<d.length;e++){var f=d[e],g=new a.Models.PracticePlanItem;g.fromJson(f),this.add(g,!1)}b.prototype.fromJson.call(this,c)}},c}(Common.Models.Collection);b.PracticePlanItemCollection=c}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this.periodName=new a.Models.PracticePlanPeriodName,this.periodNumber=new a.Models.PracticePlanPeriodNumber,this.periodReps=new a.Models.PracticePlanPeriodReps,this.periodStart=new a.Models.PracticePlanPeriodStart,this.periodFinish=new a.Models.PracticePlanPeriodFinish,this.date=new a.Models.PracticePlanDate,this.location=new a.Models.PracticePlanLocation,this.opponent=new a.Models.PracticePlanOpponent,this.duration=new a.Models.PracticePlanDuration}return __extends(c,b),c.prototype.toJson=function(){return $.extend({periodName:this.periodName.toJson(),periodNumber:this.periodNumber.toJson(),periodReps:this.periodReps.toJson(),periodStart:this.periodStart.toJson(),periodFinish:this.periodFinish.toJson(),date:this.date.toJson(),location:this.location.toJson(),opponent:this.opponent.toJson(),duration:this.duration.toJson()},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.periodName.fromJson(a.periodName),this.periodNumber.fromJson(a.periodNumber),this.periodReps.fromJson(a.periodReps),this.periodStart.fromJson(a.periodStart),this.periodFinish.fromJson(a.periodFinish),this.date.fromJson(a.date),this.location.fromJson(a.locationGuid),this.opponent.fromJson(a.opponentGuid),this.duration.fromJson(a.duration),b.prototype.fromJson.call(this,a))},c.prototype.toCollection=function(){var b=new a.Models.PlanningEditorToggleItemCollection;return b.add(this.periodName,!1),b.add(this.periodNumber,!1),b.add(this.periodReps,!1),b.add(this.periodStart,!1),b.add(this.periodFinish,!1),b.add(this.date,!1),b.add(this.location,!1),b.add(this.opponent,!1),b.add(this.duration,!1),b},c}(Common.Models.Storable);b.PracticePlanTitleData=c;var d=function(b){function c(){b.call(this,"Period name"),this.name="",this.type=a.Enums.PlanningEditorToggleTypes.PeriodName}return __extends(c,b),c.prototype.toJson=function(){return $.extend({name:this.name},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.name=a.name,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanPeriodName=d;var e=function(b){function c(){b.call(this,"Period number"),this.number=0,this.type=a.Enums.PlanningEditorToggleTypes.PeriodName}return __extends(c,b),c.prototype.toJson=function(){return $.extend({number:this.number},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.number=a.number,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanPeriodNumber=e;var f=function(b){function c(){b.call(this,"Period Reps"),this.reps=0,this.type=a.Enums.PlanningEditorToggleTypes.PeriodReps}return __extends(c,b),c.prototype.toJson=function(){return $.extend({reps:this.reps},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.reps=a.reps,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanPeriodReps=f;var g=function(b){function c(){b.call(this,"Period start"),this.start=0,this.type=a.Enums.PlanningEditorToggleTypes.PeriodStart}return __extends(c,b),c.prototype.toJson=function(){return $.extend({start:this.start},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.start=a.start,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanPeriodStart=g;var h=function(b){function c(){b.call(this,"Period finish"),this.finish=0,this.type=a.Enums.PlanningEditorToggleTypes.PeriodFinish}return __extends(c,b),c.prototype.toJson=function(){return $.extend({finish:this.finish},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.finish=a.finish,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanPeriodFinish=h;var i=function(b){function c(){b.call(this,"Date"),this.date=new Common.Models.Datetime,this.type=a.Enums.PlanningEditorToggleTypes.Date}return __extends(c,b),c.prototype.toJson=function(){return $.extend({date:this.date.toJson()},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.date.fromJson(a.date),b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanDate=i;var j=function(b){function c(){b.call(this,"Location"),this.location=null,this.locationGuid="",this.type=a.Enums.PlanningEditorToggleTypes.Location}return __extends(c,b),c.prototype.toJson=function(){return $.extend({locationGuid:this.locationGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.locationGuid=a.locationGuid,b.prototype.fromJson.call(this,a))},c.prototype.setLocation=function(a){this.location=a,this.locationGuid=this.location?this.location.guid:""},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanLocation=j;var k=function(b){function c(){b.call(this,"Opponent"),this.opponent=null,this.opponentGuid="",this.type=a.Enums.PlanningEditorToggleTypes.Opponent}return __extends(c,b),c.prototype.toJson=function(){return $.extend({opponentGuid:this.opponentGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.opponentGuid=a.opponentGuid,b.prototype.fromJson.call(this,a))},c.prototype.setOpponent=function(a){this.opponent=a,this.opponentGuid=this.opponent?this.opponent.guid:""},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanOpponent=k;var l=function(b){function c(){b.call(this,"Duration"),this.duration=0,this.type=a.Enums.PlanningEditorToggleTypes.Duration}return __extends(c,b),c.prototype.toJson=function(){return $.extend({duration:this.duration},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.duration=a,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanDuration=l}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this.playCount=new a.Models.PracticePlanPlayCount,this.hashmark=new a.Models.PracticePlanHashmark,this.down=new a.Models.PracticePlanDown,this.distance=new a.Models.PracticePlanDistance,this.yardline=new a.Models.PracticePlanYardline,this.fieldZone=new a.Models.PracticePlanFieldZone,this.time=new a.Models.PracticePlanTime,this.tempo=new a.Models.PracticePlanTempo,this.scoreDifference=new a.Models.PracticePlanScoreDifference}return __extends(c,b),c.prototype.toJson=function(){return $.extend({playCount:this.playCount.toJson(),hashmark:this.hashmark.toJson(),down:this.down.toJson(),distance:this.distance.toJson(),yardline:this.yardline.toJson(),fieldZone:this.fieldZone.toJson(),time:this.time.toJson(),tempo:this.tempo.toJson(),scoreDifference:this.scoreDifference.toJson()},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.playCount.fromJson(a.playCount),this.hashmark.fromJson(a.hashmark),this.down.fromJson(a.down),this.distance.fromJson(a.distance),this.yardline.fromJson(a.yardline),this.fieldZone.fromJson(a.fieldZone),this.time.fromJson(a.time),this.tempo.fromJson(a.tempo),this.scoreDifference.fromJson(a.scoreDifference),b.prototype.fromJson.call(this,a))},c.prototype.toCollection=function(){var b=new a.Models.PlanningEditorToggleItemCollection;return b.add(this.playCount,!1),b.add(this.hashmark,!1),b.add(this.down,!1),b.add(this.distance,!1),b.add(this.yardline,!1),b.add(this.fieldZone,!1),b.add(this.time,!1),b.add(this.tempo,!1),b.add(this.scoreDifference,!1),b},c}(Common.Models.Storable);b.PracticePlanSituationData=c;var d=function(b){function c(){b.call(this,"Play count"),this.type=a.Enums.PlanningEditorToggleTypes.PlayCount,this.count=30}return __extends(c,b),c.prototype.toJson=function(){return $.extend({count:this.count},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.count=a.count,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanPlayCount=d;var e=function(b){function c(){b.call(this,"Hashmark"),this.type=a.Enums.PlanningEditorToggleTypes.Hashmark,this.hashmark=Playbook.Enums.Hashmark.Center}return __extends(c,b),c.prototype.toJson=function(){return $.extend({hashmark:this.hashmark},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.hashmark=a.hashmark,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanHashmark=e;var f=function(b){function c(){b.call(this,"Down"),this.type=a.Enums.PlanningEditorToggleTypes.Down,this.down=1}return __extends(c,b),c.prototype.toJson=function(){return $.extend({down:this.down},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.down=a.down,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanDown=f;var g=function(b){function c(){b.call(this,"Distance"),this.type=a.Enums.PlanningEditorToggleTypes.Distance,this.distance=10}return __extends(c,b),c.prototype.toJson=function(){return $.extend({distance:this.distance},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.distance=a.distance,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanDistance=g;var h=function(b){function c(){b.call(this,"Yardline"),this.type=a.Enums.PlanningEditorToggleTypes.Yardline,this.yardline=50}return __extends(c,b),c.prototype.toJson=function(){return $.extend({yardline:this.yardline},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){
a&&(this.yardline=a.yardline,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanYardline=h;var i=function(b){function c(){b.call(this,"Field zone"),this.type=a.Enums.PlanningEditorToggleTypes.FieldZone,this.fieldZone=Playbook.Enums.FieldZones.Midfield}return __extends(c,b),c.prototype.toJson=function(){return $.extend({fieldZone:this.fieldZone},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.fieldZone=a.fieldZone,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanFieldZone=i;var j=function(b){function c(){b.call(this,"Time"),this.type=a.Enums.PlanningEditorToggleTypes.Time,this.time=0}return __extends(c,b),c.prototype.toJson=function(){return $.extend({time:this.time},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.time=a.time,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanTime=j;var k=function(b){function c(){b.call(this,"Tempo"),this.type=a.Enums.PlanningEditorToggleTypes.Tempo,this.tempo=a.Enums.Tempo.Normal}return __extends(c,b),c.prototype.toJson=function(){return $.extend({tempo:this.tempo},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.tempo=a.tempo,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanTempo=k;var l=function(b){function c(){b.call(this,"Score difference"),this.type=a.Enums.PlanningEditorToggleTypes.ScoreDifference,this.difference=0}return __extends(c,b),c.prototype.toJson=function(){return $.extend({difference:this.difference},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.difference=a.difference,b.prototype.fromJson.call(this,a))},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanScoreDifference=l}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this.personnel=new a.Models.PracticePlanPersonnel,this.formation=new a.Models.PracticePlanFormation,this.play=new a.Models.PracticePlanPlay,this.wristband=new a.Models.PracticePlanWristband,this.depth=new a.Models.PracticePlanDepth,this.read=new a.Models.PracticePlanRead}return __extends(c,b),c.prototype.toJson=function(){return $.extend({personnel:this.personnel.toJson(),formation:this.formation.toJson(),play:this.play.toJson(),wristband:this.wristband.toJson(),depth:this.depth.toJson(),read:this.read.toJson()},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.personnel.fromJson(a.personnel),this.formation.fromJson(a.formation),this.play.fromJson(a.play),this.wristband.fromJson(a.wristband),this.depth.fromJson(a.depth),this.read.fromJson(a.read),b.prototype.fromJson.call(this,a))},c.prototype.toCollection=function(){var b=new a.Models.PlanningEditorToggleItemCollection;return b.add(this.personnel,!1),b.add(this.formation,!1),b.add(this.play,!1),b.add(this.wristband,!1),b.add(this.depth,!1),b.add(this.read,!1),b},c}(Common.Models.Storable);b.PracticePlanOffensiveData=c;var d=function(b){function c(){b.call(this,"Wristband"),this.type=a.Enums.PlanningEditorToggleTypes.Wristband,this.wristband=null,this.wristbandGuid=""}return __extends(c,b),c.prototype.toJson=function(){return $.extend({wristbandGuid:this.wristbandGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.wristbandGuid=a.wristbandGuid,b.prototype.fromJson.call(this,a))},c.prototype.setWristband=function(a){},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanWristband=d;var e=function(b){function c(){b.call(this,"Read"),this.type=a.Enums.PlanningEditorToggleTypes.Read,this.read=null,this.readGuid=""}return __extends(c,b),c.prototype.toJson=function(){return $.extend({readGuid:this.readGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.readGuid=a.readGuid,b.prototype.fromJson.call(this,a))},c.prototype.setRead=function(a){},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanRead=e;var f=function(b){function c(){b.call(this,"Depth"),this.type=a.Enums.PlanningEditorToggleTypes.Depth,this.depth=null,this.depthGuid=""}return __extends(c,b),c.prototype.toJson=function(){return $.extend({depthGuid:this.depthGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.depthGuid=a.depthGuid,b.prototype.fromJson.call(this,a))},c.prototype.setDepth=function(a){},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanDepth=f;var g=function(b){function c(){b.call(this,"Play"),this.type=a.Enums.PlanningEditorToggleTypes.Play,this.play=null,this.playGuid=""}return __extends(c,b),c.prototype.toJson=function(){return $.extend({playGuid:this.playGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.playGuid=a.playGuid,b.prototype.fromJson.call(this,a))},c.prototype.setPlay=function(a){this.play=a,this.playGuid=this.play?this.play.guid:""},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanPlay=g;var h=function(b){function c(){b.call(this,"Formation"),this.type=a.Enums.PlanningEditorToggleTypes.Formation,this.formation=null,this.formationGuid=""}return __extends(c,b),c.prototype.toJson=function(){return $.extend({formationGuid:this.formationGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.formationGuid=a.formationGuid,b.prototype.fromJson.call(this,a))},c.prototype.setFormation=function(a){this.formation=a,this.formationGuid=this.formation?this.formation.guid:""},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanFormation=h;var i=function(b){function c(){b.call(this,"Personnel"),this.type=a.Enums.PlanningEditorToggleTypes.Personnel,this.personnel=null,this.personnelGuid=""}return __extends(c,b),c.prototype.toJson=function(){return $.extend({personnelGuid:this.personnelGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.personnelGuid=a.personnelGuid,b.prototype.fromJson.call(this,a))},c.prototype.setPersonnel=function(a){this.personnel=a,this.personnelGuid=this.personnel?this.personnel.guid:""},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanPersonnel=i}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this),this.personnel=new a.Models.PracticePlanPersonnel,this.formation=new a.Models.PracticePlanFormation,this.play=new a.Models.PracticePlanPlay,this.pressure=new a.Models.PracticePlanPressure,this.coverage=new a.Models.PracticePlanCoverage,this.read=new a.Models.PracticePlanRead}return __extends(c,b),c.prototype.toJson=function(){return $.extend({personnel:this.personnel.toJson(),formation:this.formation.toJson(),play:this.play.toJson(),pressure:this.pressure.toJson(),coverage:this.coverage.toJson(),read:this.read.toJson()},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.personnel.fromJson(a.personnel),this.formation.fromJson(a.formation),this.play.fromJson(a.play),this.pressure.fromJson(a.pressure),this.coverage.fromJson(a.coverage),this.read.fromJson(a.read),b.prototype.fromJson.call(this,a))},c.prototype.toCollection=function(){var b=new a.Models.PlanningEditorToggleItemCollection;return b.add(this.personnel,!1),b.add(this.formation,!1),b.add(this.play,!1),b.add(this.pressure,!1),b.add(this.coverage,!1),b.add(this.read,!1),b},c}(Common.Models.Storable);b.PracticePlanDefensiveData=c;var d=function(b){function c(){b.call(this,"Pressure"),this.type=a.Enums.PlanningEditorToggleTypes.Pressure,this.pressure=null,this.pressureGuid=""}return __extends(c,b),c.prototype.toJson=function(){return $.extend({pressureGuid:this.pressureGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.pressureGuid=a.pressureGuid,b.prototype.fromJson.call(this,a))},c.prototype.setPressure=function(a){},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanPressure=d;var e=function(b){function c(){b.call(this,"Coverage"),this.type=a.Enums.PlanningEditorToggleTypes.Coverage,this.coverage=null,this.coverageGuid=""}return __extends(c,b),c.prototype.toJson=function(){return $.extend({coverageGuid:this.coverageGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.coverageGuid=a.coverageGuid,b.prototype.fromJson.call(this,a))},c.prototype.setCoverage=function(a){},c}(a.Models.PlanningEditorToggleItem);b.PracticePlanCoverage=e}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this,Common.Enums.ImpaktDataTypes.GamePlan),this.plan=null,this.planGuid="",this.start=new Common.Models.Datetime}return __extends(b,a),b.prototype.toJson=function(){return $.extend({planGuid:this.planGuid,start:this.start.toJson()},a.prototype.toJson.call(this))},b.prototype.fromJson=function(b){b&&(this.planGuid=b.planGuid,this.start.fromJson(b.start),a.prototype.fromJson.call(this,b))},b.prototype.setPlan=function(a){this.plan=a,this.planGuid=this.plan?this.plan.guid:""},b}(Common.Models.AssociableEntity);a.GamePlan=b}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.toJson=function(){return{guid:this.guid,gamePlans:b.prototype.toJson.call(this)}},c.prototype.fromJson=function(b){if(b){this.guid=b.guid;for(var c=b.gamePlans||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){var f=new a.Models.GamePlan;f.fromJson(e),this.add(f)}}}},c}(Common.Models.ActionableCollection);b.GamePlanCollection=c}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this,Common.Enums.ImpaktDataTypes.PracticePlan)}return __extends(b,a),b.prototype.toJson=function(){return $.extend({},a.prototype.toJson.call(this))},b.prototype.fromJson=function(b){b&&a.prototype.fromJson.call(this,b)},b}(Common.Models.AssociableEntity);a.PracticeSchedule=b}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.toJson=function(){return{guid:this.guid,practiceSchedules:b.prototype.toJson.call(this)}},c.prototype.fromJson=function(b){if(b){this.guid=b.guid;for(var c=b.practiceSchedules||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){var f=new a.Models.PracticeSchedule;f.fromJson(e),this.add(f)}}}},c}(Common.Models.ActionableCollection);b.PracticeScheduleCollection=c}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this,Common.Enums.ImpaktDataTypes.ScoutCard),this.plan=null,this.planGuid=""}return __extends(b,a),b.prototype.toJson=function(){return $.extend({planGuid:this.planGuid},a.prototype.toJson.call(this))},b.prototype.fromJson=function(b){b&&(this.planGuid=b.planGuid,a.prototype.fromJson.call(this,b))},b.prototype.setPlan=function(a){this.plan=a,this.planGuid=this.plan?this.plan.guid:""},b}(Common.Models.AssociableEntity);a.ScoutCard=b}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.toJson=function(){return{guid:this.guid,scoutCards:b.prototype.toJson.call(this)}},c.prototype.fromJson=function(b){if(b){this.guid=b.guid;for(var c=b.scoutCards||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){var f=new a.Models.ScoutCard;f.fromJson(e),this.add(f)}}}},c}(Common.Models.ActionableCollection);b.ScoutCardCollection=c}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this,Common.Enums.ImpaktDataTypes.PracticePlan)}return __extends(b,a),b.prototype.toJson=function(){return $.extend({},a.prototype.toJson.call(this))},b.prototype.fromJson=function(b){b&&a.prototype.fromJson.call(this,b)},b}(Common.Models.AssociableEntity);a.QBWristband=b}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.toJson=function(){return{guid:this.guid,QBWristbands:b.prototype.toJson.call(this)}},c.prototype.fromJson=function(b){if(b){this.guid=b.guid;for(var c=b.QBWristbands||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){var f=new a.Models.QBWristband;f.fromJson(e),this.add(f)}}}},c}(Common.Models.ActionableCollection);b.QBWristbandCollection=c}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(a){var b=function(a){function b(b){if(a.call(this,Common.Enums.ImpaktDataTypes.Unknown),Common.Utilities.isNullOrUndefined(b))throw new Error("PlanningEditorTab constructor(): data is null or undefined");this.data=b}return __extends(b,a),b}(Common.Models.Actionable);a.PlanningEditorTab=b}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.close=function(a){this.remove(a.guid),a.close()},b}(Common.Models.ActionableCollection);a.PlanningEditorTabCollection=b}(b=a.Models||(a.Models={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(a){!function(a){a[a.Unknown=0]="Unknown",a[a.PeriodName=1]="PeriodName",a[a.PeriodNumber=2]="PeriodNumber",a[a.PeriodReps=3]="PeriodReps",a[a.PeriodStart=4]="PeriodStart",a[a.PeriodFinish=5]="PeriodFinish",a[a.Date=6]="Date",a[a.Location=7]="Location",a[a.Opponent=8]="Opponent",a[a.Duration=9]="Duration",a[a.PlayCount=10]="PlayCount",a[a.Hashmark=11]="Hashmark",a[a.Down=12]="Down",a[a.Distance=13]="Distance",a[a.Yardline=14]="Yardline",a[a.FieldZone=15]="FieldZone",a[a.Time=16]="Time",a[a.Tempo=17]="Tempo",a[a.ScoreDifference=18]="ScoreDifference",a[a.Personnel=19]="Personnel",a[a.Formation=20]="Formation",a[a.Play=21]="Play",a[a.Wristband=22]="Wristband",a[a.Depth=23]="Depth",a[a.Read=24]="Read",a[a.Pressure=25]="Pressure",a[a.Coverage=26]="Coverage"}(a.PlanningEditorToggleTypes||(a.PlanningEditorToggleTypes={}));a.PlanningEditorToggleTypes;!function(a){a[a.Normal=0]="Normal",a[a.HurryUp=1]="HurryUp",a[a.NoHuddle=2]="NoHuddle"}(a.Tempo||(a.Tempo={}));a.Tempo}(b=a.Enums||(a.Enums={}))}(Planning||(Planning={}));var Planning;!function(a){var b;!function(a){a.DEFAULT_PRACTICE_PLAN_ITEMS_LENGTH=10}(b=a.Constants||(a.Constants={}))}(Planning||(Planning={}));var Navigation;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e,f,g){a.call(this),a.prototype.setContext.call(this,this),this.name=b,this.label=c,this.glyphicon=d,this.path=e,this.active=f===!0,this.activationCallback=g}return __extends(b,a),b.prototype.activate=function(){this.active=!0,this.activationCallback(this)},b.prototype.deactivate=function(){this.active=!1},b.prototype.toggleActivation=function(){this.active=!this.active,this.active===!0&&this.activate()},b}(Common.Models.Modifiable);a.NavigationItem=b}(b=a.Models||(a.Models={}))}(Navigation||(Navigation={}));var Navigation;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.activate=function(a){this.forEach(function(a,b){a.deactivate()}),a.activate()},b.prototype.getActive=function(){return this.filterFirst(function(a,b){return a.active===!0})},b}(Common.Models.Collection);a.NavigationItemCollection=b}(b=a.Models||(a.Models={}))}(Navigation||(Navigation={}));var Season;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this,Common.Enums.ImpaktDataTypes.Season),this.year=(new Date).getFullYear(),this.start=new Common.Models.Datetime,this.weeks=new a.Models.WeekCollection,this.associable=["leagues"]}return __extends(c,b),c.prototype.copy=function(c){var d=c||new a.Models.SeasonModel;return b.prototype.copy.call(this,d,this)},c.prototype.toJson=function(){return $.extend({weeks:this.weeks.toJson(),year:this.year,start:this.start.toJson()},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.year=a.year,this.weeks.fromJson(a.weeks),this.start.fromJson(a.start),b.prototype.fromJson.call(this,a))},c}(Common.Models.AssociableEntity);b.SeasonModel=c}(b=a.Models||(a.Models={}))}(Season||(Season={}));var Season;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.toJson=function(){return null},c.prototype.fromJson=function(b){if(b){this.guid=b.guid;for(var c=b.seasons||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){var f=new a.Models.SeasonModel;f.fromJson(e),this.add(f)}}}},c}(Common.Models.ActionableCollection);b.SeasonModelCollection=c}(b=a.Models||(a.Models={}))}(Season||(Season={}));var Season;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this,Common.Enums.ImpaktDataTypes.Unknown),this.name=null,this.number=0,this.season=new a.Models.SeasonModel,this.seasonGuid="",this.start=new Common.Models.Datetime}return __extends(c,b),c.prototype.toJson=function(){return $.extend({name:this.name,number:this.number,guid:this.guid,seasonGuid:this.seasonGuid,start:this.start.toJson()},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.name=a.name,this.number=a.number,this.seasonGuid=a.seasonGuid,this.start.fromJson(a.start),b.prototype.fromJson.call(this,a))},c.prototype.getFormattedName=function(){return this.name+" "+this.number},c.prototype.setSeason=function(a){this.season=a,this.seasonGuid=this.season?this.season.guid:""},c.prototype.incrementWeek=function(a,b){this.start.date=moment(a.date).add(b,"week")._d},c.prototype.decrementWeek=function(a,b){this.start.date=moment(a.date).subtract(b,"week")._d},c.prototype.getFormattedDate=function(){return this.start.getFormatted()},c}(Common.Models.Actionable);b.Week=c}(b=a.Models||(a.Models={}))}(Season||(Season={}));var Season;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.toJson=function(){return{guid:this.guid,weeks:b.prototype.toJson.call(this)}},c.prototype.fromJson=function(b){if(b){this.guid=b.guid;for(var c=b.weeks||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){var f=new a.Models.Week;f.fromJson(e),this.add(f,!1)}}}},c}(Common.Models.ActionableCollection);b.WeekCollection=c}(b=a.Models||(a.Models={}))}(Season||(Season={}));var Season;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this,Common.Enums.ImpaktDataTypes.Game),this.start=new Common.Models.Datetime,this.location=new League.Models.Location,this.locationGuid="",this.home=new Team.Models.TeamModel,this.homeGuid="",this.away=new Team.Models.TeamModel,this.awayGuid="",this.week=new a.Models.Week,this.weekGuid="",this.outcome=null,this.season=null,this.seasonGuid="",this.associable=["seasons","teams","locations","plans","playbooks"]}return __extends(c,b),c.prototype.copy=function(c){var d=c||new a.Models.Game;return b.prototype.copy.call(this,d,this)},c.prototype.toJson=function(){return $.extend({start:this.start.toJson(),locationGuid:this.locationGuid,homeGuid:this.homeGuid,awayGuid:this.awayGuid,seasonGuid:this.seasonGuid,weekGuid:this.weekGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.start.fromJson(a.start),this.locationGuid=a.locationGuid,this.homeGuid=a.homeGuid,this.awayGuid=a.awayGuid,this.seasonGuid=a.seasonGuid,this.weekGuid=a.weekGuid,b.prototype.fromJson.call(this,a))},c.prototype.getFormattedName=function(){return this.away&&this.home?[this.away.name," @ ",this.home.name].join(""):this.name},c.prototype.setSeason=function(a){this.season=a,this.seasonGuid=this.season?this.season.guid:""},c.prototype.setWeek=function(a){this.week=a,this.weekGuid=this.week?this.week.guid:""},c.prototype.setLocation=function(a){this.location=a,this.locationGuid=this.location?this.location.guid:""},c.prototype.setHome=function(a){this.home=a,this.homeGuid=this.home?this.home.guid:"",this.name=this.getFormattedName()},c.prototype.setAway=function(a){this.away=a,this.awayGuid=this.away?this.away.guid:"",this.name=this.getFormattedName()},c}(Common.Models.AssociableEntity);b.Game=c}(b=a.Models||(a.Models={}))}(Season||(Season={}));var Season;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.toJson=function(){return{guid:this.guid,games:b.prototype.toJson.call(this)}},c.prototype.fromJson=function(b){if(b){this.guid=b.guid;for(var c=b.games||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){var f=new a.Models.Game;f.fromJson(e),this.add(f)}}}},c}(Common.Models.ActionableCollection);b.GameCollection=c}(b=a.Models||(a.Models={}))}(Season||(Season={}));var League;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this,Common.Enums.ImpaktDataTypes.League),this.associable=["conferences","divisions","teams"]}return __extends(c,b),c.prototype.copy=function(c){var d=c||new a.Models.LeagueModel;return b.prototype.copy.call(this,d,this)},c.prototype.toJson=function(){return $.extend({name:this.name},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.name=a.name,b.prototype.fromJson.call(this,a))},c}(Common.Models.AssociableEntity);b.LeagueModel=c}(b=a.Models||(a.Models={}))}(League||(League={}));var League;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b}(Common.Models.ActionableCollection);a.LeagueModelCollection=b}(b=a.Models||(a.Models={}))}(League||(League={}));var League;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this,Common.Enums.ImpaktDataTypes.Conference),this.name=null,this.league=null,this.leagueGuid="",this.associable=["leagues","divisions","teams"]}return __extends(c,b),c.prototype.copy=function(c){var d=c||new a.Models.Conference;return b.prototype.copy.call(this,d,this)},c.prototype.toJson=function(){return $.extend({name:this.name,png:this.png,leagueGuid:this.leagueGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.name=a.name,this.png=a.png,this.leagueGuid=a.leagueGuid,b.prototype.fromJson.call(this,a))},c.prototype.setLeague=function(a){this.league=a,this.leagueGuid=this.league?this.league.guid:""},c}(Common.Models.AssociableEntity);b.Conference=c}(b=a.Models||(a.Models={}))}(League||(League={}));var League;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.toJson=function(){return{guid:this.guid,conferences:b.prototype.toJson.call(this)}},c.prototype.fromJson=function(b){if(b){this.guid=b.guid;for(var c=b.conferences||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){var f=new a.Models.Conference;f.fromJson(e),this.add(f)}}}},c}(Common.Models.ActionableCollection);b.ConferenceCollection=c}(b=a.Models||(a.Models={}))}(League||(League={}));var League;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this,Common.Enums.ImpaktDataTypes.Division),this.name="",this.conference=null,this.conferenceGuid="",this.associable=["leagues","conferences","teams"]}return __extends(c,b),c.prototype.copy=function(c){var d=c||new a.Models.Division;return b.prototype.copy.call(this,d,this)},c.prototype.toJson=function(){return $.extend({name:this.name,png:this.png,conferenceGuid:this.conferenceGuid},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.name=a.name,this.png=a.png,this.conferenceGuid=a.conferenceGuid,b.prototype.fromJson.call(this,a))},c.prototype.setConference=function(a){this.conference=a,this.conferenceGuid=this.conference?this.conference.guid:""},c}(Common.Models.AssociableEntity);b.Division=c}(b=a.Models||(a.Models={}))}(League||(League={}));var League;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.toJson=function(){return{guid:this.guid,divisions:b.prototype.toJson.call(this)}},c.prototype.fromJson=function(b){if(b){this.guid=b.guid;for(var c=b.divisions||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){var f=new a.Models.Division;f.fromJson(e),this.add(f)}}}},c}(Common.Models.ActionableCollection);b.DivisionCollection=c}(b=a.Models||(a.Models={}))}(League||(League={}));var User;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this),a.prototype.setContext.call(this,this),this.accountKey=0,this.address1=null,this.address2=null,this.address3=null,this.city=null,this.country=null,this.faxPrimary=null,this.inactive=!1,this.name=null,this.notes=null,this.organizationKey=0,this.otherDetails=null,this.phonePrimary=null,this.postalCode=null,this.primaryEmail=null,this.stateProvince=null}return __extends(b,a),b.prototype.toJson=function(){return{accountKey:this.accountKey,address1:this.address1,address2:this.address2,address3:this.address3,city:this.city,country:this.country,faxPrimary:this.faxPrimary,inactive:this.inactive,name:this.name,notes:this.notes,organizationKey:this.organizationKey,otherDetails:this.otherDetails,phonePrimary:this.phonePrimary,postalCode:this.postalCode,primaryEmail:this.primaryEmail,stateProvince:this.stateProvince}},b.prototype.fromJson=function(a){a&&(this.accountKey=a.accountKey,this.address1=a.address1,this.address2=a.address2,this.address3=a.address3,this.city=a.city,this.country=a.country,this.faxPrimary=a.faxPrimary,this.inactive=a.inactive,this.name=a.name,this.notes=a.notes,this.organizationKey=a.organizationKey,this.otherDetails=a.otherDetails,this.phonePrimary=a.phonePrimary,this.postalCode=a.postalCode,this.primaryEmail=a.primaryEmail,this.stateProvince=a.stateProvince)},b}(Common.Models.Modifiable);a.Organization=b}(b=a.Models||(a.Models={}))}(User||(User={}));var User;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.toJson=function(){return a.prototype.toJson.call(this)},b.prototype.fromJson=function(a){if(a)throw new Error("OrganizationCollection fromJson(): not implemented")},b}(Common.Models.Collection);a.OrganizationCollection=b}(b=a.Models||(a.Models={}))}(User||(User={}));var impakt={};impakt.context={},impakt.app=angular.module("impakt.app",["ui.router","angular.filter","ui.bootstrap","impakt.common","impakt.modules","ngTagsInput"]).provider("appConfigurator",function(){var a={appVer:"0.0.0",hostUrl:void 0};return{set:function(b){angular.extend(a,b)},$get:function(){return a}}}).config(["$stateProvider","$urlRouterProvider","$httpProvider","$sceDelegateProvider",function(a,b,c,d){d.resourceUrlWhitelist(["self","https://test-impakt.azurewebsites.net/**","http://test.impaktathletics.com/**","*"]),a.state("home",{url:"/home",templateUrl:"modules/home/home.tpl.html"}).state("team",{url:"/team",templateUrl:"modules/team/team.tpl.html"}).state("analysis",{url:"/analysis",templateUrl:"modules/analysis/analysis.tpl.html"}).state("profile",{url:"/profile",templateUrl:"modules/user/user.tpl.html"}),console.debug("impakt.app - config")}]).run(["$http","$window","__auth","__localStorage","__context","__notifications","_user",function(a,b,c,d,e,f,g){console.debug("impakt - running");var h=d.getAccessToken();if(h){a.defaults.headers.common.Authorization="Bearer "+h;var i=f.pending("Initializing user...");g.initialize().then(function(){i.success("User successfully initialized")},function(a){i.error("Failed to initialize user")})}else b.location.href="/signin.html"}]),impakt.signin=angular.module("impakt.signin",["ui.router","ui.bootstrap","impakt.common"]).provider("appConfigurator",function(){var a={appVer:"0.0.0",hostUrl:void 0};return{set:function(b){angular.extend(a,b)},$get:function(){return a}}}).config([function(){console.debug("impakt.signin - config")}]).run(["$http","$window","$location","$rootScope","__signin",function(a,b,c,d,e){console.debug("impakt.signin - running"),a.defaults.headers.common={"Content-Type":"application/json"}}]),impakt.common=angular.module("impakt.common",["impakt.common.api","impakt.common.auth","impakt.common.contextmenu","impakt.common.context","impakt.common.associations","impakt.common.base","impakt.common.scrollable","impakt.common.modals","impakt.common.localStorage","impakt.common.parser","impakt.common.signin","impakt.common.locale","impakt.common.ui","impakt.common.notifications"]).config(function(){console.debug("impakt.common - config")}).run(function(){console.debug("impakt.common - run")}),impakt.common.api=angular.module("impakt.common.api",[]).config([function(){console.debug("impakt.common.api - config")}]).run([function(){console.debug("impakt.common.api - run")}]),impakt.common.api.constant("API",{VERSION:.01,HOST_URL:"https://test.impaktathletics.com",ENDPOINT:"/api"}),impakt.common.api.factory("__api",["API","AUTH","$http","$q","__localStorage","appConfigurator",function(a,b,c,d,e,f){function g(b,f){f.OrganizationKey||(f.OrganizationKey=e.getOrganizationKey());var g=d.defer();return c({method:"POST",url:i(j,a.ENDPOINT,b),data:JSON.stringify(f),headers:{"Content-Type":"application/json"}}).then(function(a){g.resolve(a)},function(a){console.error(a),g.reject(a)}),g.promise}function h(b,f){var g=d.defer();return c({method:"POST",url:i(j,a.ENDPOINT,b),headers:{"X-HTTP-Method-Override":"GET","Content-Type":"application/json"},data:$.extend({OrganizationKey:e.getOrganizationKey()},f)}).then(function(a){g.resolve(a)},function(a){console.error(a),g.reject(a)}),g.promise}function i(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return a.join("")}var j=f.hostUrl||a.HOST_URL,k={post:g,get:h,path:i};return k}]),impakt.common.auth=angular.module("impakt.common.auth",[]),impakt.common.auth.constant("AUTH",{TOKEN_ENDPOINT:"/token",HANDSHAKE_DUMMY:"grant_type=password&username=fredf@imanufacture.com&Password=Abc123",CREATE_ORGANIZATION:"/configuration/createOrganization"}),function(){var a="__auth";impakt.common.auth.factory(a,["AUTH","API","$http","$q","__api","appConfigurator",function(a,b,c,d,e,f){function g(b,f){var g=d.defer(),i=["grant_type=password","&username=",encodeURIComponent(b),"&Password=",f].join("");return c({method:"POST",url:e.path(h,a.TOKEN_ENDPOINT),data:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){console.log(a),g.resolve(a)},function(a){console.error(a),g.reject(a)}),g.promise}var h=f.hostUrl||b.HOST_URL,i={getToken:g};return i}])}(),impakt.common.base=angular.module("impakt.common.base",[]).config(function(){console.debug("impakt.common.base - config")}).run(function(){console.debug("impakt.common.base - run")}),impakt.common.base.service("_base",["$rootScope",function(a){console.debug("service: impakt.common.base");var b=new Common.Base.ComponentMap;this.loadComponent=function(a){this.registerComponent(a),a.loaded&&a.ready()},this.registerComponent=function(a){b[a.guid]=a}}]),impakt.common.associations=angular.module("impakt.common.associations",[]).config([function(){console.debug("impakt.common.associations - config")}]).run([function(){console.debug("impakt.common.associations - run")}]),impakt.common.associations.constant("ASSOCIATIONS",{ENDPOINT:"/general",GET_ASSOCIATIONS_FOR_CONTEXT:"/getAssociationsForContext",GET_ASSOCIATIONS_FOR_ENTITY:"/getAssociationsForEntity",UPDATE_ASSOCIATIONS:"/updateAssociations",DELETE_ASSOCIATIONS:"/deleteAssociations"}),impakt.common.associations.service("_associations",["ASSOCIATIONS","$rootScope","$q","__api","__localStorage","__notifications",function(a,b,c,d,e,f){var g=e.getOrganizationKey();this.associations=new Common.Models.AssociationCollection(g),this.getAssociationsByContextId=function(){var b=c.defer(),g=e.getOrganizationKey(),h=f.pending("Retrieving Association data for Organization ",g,"...");return Common.Utilities.isNullOrUndefined(g)&&(h.error("Failed to retrieve associations for Organization ",g,""),b.reject(["Organization Key is invalid when attempting				 to request all Associations: (",g,")"].join(""))),
d.get(d.path(a.ENDPOINT,a.GET_ASSOCIATIONS_FOR_CONTEXT),{contextId:g+""}).then(function(a){var c=new Common.Models.AssociationCollection(g);a&&a.data&&a.data.results&&c.fromJson(a.data.results),h.success(c.size()," Associations successfully retrieved"),b.resolve(c)},function(a){h.error("Failed to retrieve Associations for Organization ",g,""),b.reject(a)}),b.promise},this.getAssociationsByEntityKey=function(){},this.updateAssociations=function(){var g=c.defer(),h=e.getOrganizationKey(),i=f.pending("Updating data associations..."),j=impakt.context.Associations.associations.toJson();return d.post(d.path(a.ENDPOINT,a.UPDATE_ASSOCIATIONS),{version:1,contextID:h+"",associations:j}).then(function(a){i.success(impakt.context.Associations.associations.size()," Associations successfully updated"),b.$broadcast("associations-updated"),g.resolve()},function(a){i.error("Failed to update Associations"),g.reject(a)}),g.promise},this.deleteAssociations=function(g){var h=c.defer(),i=e.getOrganizationKey(),j=f.pending("Deleting ","data associations..."),k=impakt.context.Associations.associations["delete"](g);return d.post(d.path(a.ENDPOINT,a.UPDATE_ASSOCIATIONS),{contextID:i,associations:k.toJson()}).then(function(){j.success(k.size()," Associations successfully deleted"),b.$broadcast("associations-updated"),h.resolve()},function(a){j.error("Failed to update Associations"),h.reject(a)}),h.promise},this.deleteAssociation=function(g,h){var i=c.defer();impakt.context.Associations.associations.disassociate(g,h);var j=e.getOrganizationKey(),k=f.pending("Deleting association between ",g.name," and ",h.name,"...");return d.post(d.path(a.ENDPOINT,a.DELETE_ASSOCIATIONS),{contextID:j,associations:[{fromType:g.impaktDataType,fromKey:g.key,toType:h.impaktDataType,toKey:h.key,associationType:Common.Enums.AssociationTypes.Peer},{fromType:h.impaktDataType,fromKey:h.key,toType:g.impaktDataType,toKey:g.key,associationType:Common.Enums.AssociationTypes.Peer}]}).then(function(){k.success("Association between ",g.name," and ",h.name," successfully deleted"),b.$broadcast("associations-updated"),i.resolve()},function(a){k.error("Failed to update Associations"),i.reject(a)}),i.promise},this.createAssociation=function(a,b){var d=c.defer();return impakt.context.Associations.associations.add(a,b),this.updateAssociations().then(function(){d.resolve()},function(a){d.reject(a)}),d.promise},this.createAssociations=function(a,b){var d=c.defer();return impakt.context.Associations.associations.addAll(a,b),this.updateAssociations().then(function(){d.resolve()},function(a){d.reject(a)}),d.promise},this.getAssociated=function(a){if(!Common.Utilities.isNullOrUndefined(a.associationKey)){var b=impakt.context.Associations.associations.getByInternalKey(a.associationKey),c=new Common.Models.AssociationResults;if(Common.Utilities.isNullOrUndefined(b)||0==b.length)return c;for(var d=0;d<b.length;d++){var e=Common.Models.Association.parse(b[d]);if(!Common.Utilities.isNullOrUndefined(e)){var f=e.entityGuid,g=e.entityType;switch(g){case Common.Enums.ImpaktDataTypes.Playbook:var h=impakt.context.Playbook.playbooks.get(f);h&&c.playbooks.add(h);break;case Common.Enums.ImpaktDataTypes.Scenario:var i=impakt.context.Playbook.scenarios.get(f);i&&c.scenarios.add(i);break;case Common.Enums.ImpaktDataTypes.Play:var j=impakt.context.Playbook.plays.get(f);j&&c.plays.add(j);break;case Common.Enums.ImpaktDataTypes.Formation:var k=impakt.context.Playbook.formations.get(f);k&&c.formations.add(k);break;case Common.Enums.ImpaktDataTypes.PersonnelGroup:var l=impakt.context.Team.personnel.get(f);l&&c.personnel.add(l);break;case Common.Enums.ImpaktDataTypes.AssignmentGroup:var m=impakt.context.Playbook.assignmentGroups.get(f);m&&c.assignmentGroups.add(m);break;case Common.Enums.ImpaktDataTypes.League:var n=impakt.context.League.leagues.get(f);n&&c.leagues.add(n);break;case Common.Enums.ImpaktDataTypes.Conference:var o=impakt.context.League.conferences.get(f);o&&c.conferences.add(o);break;case Common.Enums.ImpaktDataTypes.Division:var p=impakt.context.League.divisions.get(f);p&&c.divisions.add(p);break;case Common.Enums.ImpaktDataTypes.Team:var q=impakt.context.Team.teams.get(f);q&&c.teams.add(q);break;case Common.Enums.ImpaktDataTypes.Location:var r=impakt.context.League.locations.get(f);r&&c.locations.add(r);break;case Common.Enums.ImpaktDataTypes.Season:var s=impakt.context.Season.seasons.get(f);s&&c.seasons.add(s);break;case Common.Enums.ImpaktDataTypes.Game:var t=impakt.context.Season.games.get(f);t&&c.games.add(t);break;case Common.Enums.ImpaktDataTypes.Plan:var u=impakt.context.Planning.plans.get(f);u&&c.plans.add(u);break;case Common.Enums.ImpaktDataTypes.PracticePlan:var v=impakt.context.Planning.practicePlans.get(f);v&&c.practicePlans.add(v);break;case Common.Enums.ImpaktDataTypes.PracticeSchedule:var w=impakt.context.Planning.practiceSchedules.get(f);w&&c.practiceSchedules.add(w);break;case Common.Enums.ImpaktDataTypes.GamePlan:var x=impakt.context.Planning.gamePlans.get(f);x&&c.gamePlans.add(x);break;case Common.Enums.ImpaktDataTypes.ScoutCard:var y=impakt.context.Planning.scoutCards.get(f);y&&c.scoutCards.add(y);break;case Common.Enums.ImpaktDataTypes.QBWristband:var z=impakt.context.Planning.QBWristbands.get(f);z&&c.QBWristbands.add(z)}}}return c}},this.associationExists=function(a,b){return this.associations.associationExists(a,b)},this.getContextDataByKey=function(a){if(Common.Utilities.isNullOrUndefined(a))throw new Error("_associations getContextDataByKey(): key is null or undefined");var b;switch(a){case"playbooks":b=impakt.context.Playbook.playbooks;break;case"scenarios":b=impakt.context.Playbook.scenarios;break;case"plays":b=impakt.context.Playbook.plays;break;case"formations":b=impakt.context.Playbook.formations;break;case"personnel":b=impakt.context.Team.personnel;break;case"assignmentGroups":b=impakt.context.Playbook.assignmentGroups;break;case"leagues":b=impakt.context.League.leagues;break;case"conferences":b=impakt.context.League.conferences;break;case"divisions":b=impakt.context.League.divisions;break;case"locations":b=impakt.context.League.locations;break;case"teams":b=impakt.context.Team.teams;break;case"seasons":b=impakt.context.Season.seasons;break;case"games":b=impakt.context.Season.games;break;case"plans":b=impakt.context.Planning.plans;break;case"practicePlans":b=impakt.context.Planning.practicePlans;break;case"practiceSchedules":b=impakt.context.Planning.practiceSchedules;break;case"gamePlans":b=impakt.context.Planning.gamePlans;break;case"scoutCards":b=impakt.context.Planning.scoutCards;break;case"QBWristbands":b=impakt.context.Planning.QBWristbands}var c=new Common.Models.ActionableCollection;return Common.Utilities.isNotNullOrUndefined(b)&&b.forEach(function(a,b){c.add(a,!1)}),c}}]),impakt.common.context=angular.module("impakt.common.context",[]).config([function(){console.debug("impakt.common.context - config")}]).run([function(){console.debug("impakt.common.context - run")}]),impakt.common.context.factory("__context",["$q","__api","__localStorage","__notifications","_associations","_playbook","_league","_season","_team","_planning",function(a,b,c,d,e,f,g,h,i,j){function k(a){q.push(a),p&&n()}function l(a){r.push(a)}function m(){for(var a=0;a<r.length;a++)r[a]();r=[]}function n(){p=!0;for(var a=0;a<q.length;a++)q[a]();q=[]}function o(b){m();var k=a.defer();console.log("Making application context initialization requests");var l=c.getOrganizationKey();return impakt.context.Actionable.selected=new Common.Models.ActionableCollection,impakt.context.Associations.associations=new Common.Models.AssociationCollection(l),impakt.context.Associations.creation=new Common.Models.AssociationCollection(l),impakt.context.Playbook.playbooks=new Common.Models.PlaybookModelCollection(Team.Enums.UnitTypes.Mixed),impakt.context.Playbook.formations=new Common.Models.FormationCollection(Team.Enums.UnitTypes.Mixed),impakt.context.Playbook.assignmentGroups=new Common.Models.AssignmentGroupCollection(Team.Enums.UnitTypes.Mixed),impakt.context.Playbook.plays=new Common.Models.PlayCollection(Team.Enums.UnitTypes.Mixed),impakt.context.Playbook.scenarios=new Common.Models.ScenarioCollection(Team.Enums.UnitTypes.Other),impakt.context.Playbook.editor={plays:new Common.Models.PlayCollection(Team.Enums.UnitTypes.Mixed),tabs:new Common.Models.TabCollection,scenarios:new Common.Models.ScenarioCollection(Team.Enums.UnitTypes.Other)},impakt.context.Playbook.creation={plays:new Common.Models.PlayCollection(Team.Enums.UnitTypes.Mixed),formations:new Common.Models.FormationCollection(Team.Enums.UnitTypes.Mixed),scenarios:new Common.Models.ScenarioCollection(Team.Enums.UnitTypes.Other)},impakt.context.Team.teams=new Team.Models.TeamModelCollection,impakt.context.Team.personnel=new Team.Models.PersonnelCollection(Team.Enums.UnitTypes.Mixed),impakt.context.Team.positionDefaults=new Team.Models.PositionDefault,impakt.context.Team.unitTypes=f.getUnitTypes(),impakt.context.Team.unitTypesEnum=f.getUnitTypesEnum(),impakt.context.Team.creation={teams:new Team.Models.TeamModelCollection},impakt.context.League.leagues=new League.Models.LeagueModelCollection,impakt.context.League.conferences=new League.Models.ConferenceCollection,impakt.context.League.divisions=new League.Models.DivisionCollection,impakt.context.League.locations=new League.Models.LocationCollection,impakt.context.League.creation={leagues:new League.Models.LeagueModelCollection,conferences:new League.Models.ConferenceCollection,team:new Team.Models.TeamModel,divisions:new League.Models.DivisionCollection,locations:new League.Models.LocationCollection},impakt.context.Season.seasons=new Season.Models.SeasonModelCollection,impakt.context.Season.games=new Season.Models.GameCollection,impakt.context.Season.creation={seasons:new Season.Models.SeasonModelCollection,games:new Season.Models.GameCollection},impakt.context.Planning.plans=new Planning.Models.PlanCollection,impakt.context.Planning.practicePlans=new Planning.Models.PracticePlanCollection,impakt.context.Planning.gamePlans=new Planning.Models.GamePlanCollection,impakt.context.Planning.practiceSchedules=new Planning.Models.PracticeScheduleCollection,impakt.context.Planning.scoutCards=new Planning.Models.ScoutCardCollection,impakt.context.Planning.QBWristbands=new Planning.Models.QBWristbandCollection,impakt.context.Planning.creation={plans:new Planning.Models.PlanCollection,practicePlans:new Planning.Models.PracticePlanCollection,gamePlans:new Planning.Models.GamePlanCollection,practiceSchedules:new Planning.Models.PracticeScheduleCollection,scoutCards:new Planning.Models.ScoutCardCollection,QBWristbands:new Planning.Models.QBWristbandCollection},impakt.context.Planning.editor={practicePlans:new Planning.Models.PracticePlanCollection,practiceSchedules:new Planning.Models.PracticeScheduleCollection,gamePlans:new Planning.Models.GamePlanCollection,scoutCards:new Planning.Models.ScoutCardCollection,QBWristbands:new Planning.Models.QBWristbandCollection},async.parallel([function(a){e.getAssociationsByContextId().then(function(c){b.Associations.associations=c,a(null,c)},function(b){a(b)})},function(a){g.getLeagues().then(function(c){b.League.leagues=c,d.success("Leagues successfully loaded"),a(null,c)},function(b){a(b)})},function(a){g.getConferences().then(function(c){b.League.conferences=c,d.success("Conferences successfully loaded"),a(null,c)},function(b){a(b)})},function(a){g.getDivisions().then(function(c){b.League.divisions=c,d.success("Divisions successfully loaded"),a(null,c)},function(b){a(b)})},function(a){i.getTeams().then(function(c){b.Team.teams=c,d.success("Teams successfully loaded"),a(null,c)},function(b){a(b)})},function(a){g.getLocations().then(function(c){b.League.locations=c,d.success("Locations successfully loaded"),a(null,c)},function(b){a(b)})},function(a){h.getSeasons().then(function(c){b.Season.seasons=c,d.success("Seasons successfully loaded"),a(null,c)},function(b){a(b)})},function(a){h.getGames().then(function(c){b.Season.games=c,d.success("Games successfully loaded"),a(null,c)},function(b){a(b)})},function(a){j.getPlans().then(function(c){b.Planning.plans=c,d.success(" plans successfully loaded"),a(null,c)},function(b){a(b)})},function(a){j.getPracticePlans().then(function(c){b.Planning.practicePlans=c,d.success("Practice plans successfully loaded"),a(null,c)},function(b){a(b)})},function(a){j.getGamePlans().then(function(c){b.Planning.gamePlans=c,d.success("Game plans successfully loaded"),a(null,c)},function(b){a(b)})},function(a){j.getPracticeSchedules().then(function(c){b.Planning.practiceSchedules=c,d.success("Practice schedules successfully loaded"),a(null,c)},function(b){a(b)})},function(a){j.getScoutCards().then(function(c){b.Planning.scoutCards=c,d.success("Scout cards successfully loaded"),a(null,c)},function(b){a(b)})},function(a){j.getQBWristbands().then(function(c){b.Planning.QBWristbands=c,d.success("QB wristbands successfully loaded"),a(null,c)},function(b){a(b)})},function(a){f.getPlaybooks().then(function(c){b.Playbook.playbooks=c,d.success("Playbooks successfully loaded"),a(null,c)},function(b){a(b)})},function(a){f.getFormations().then(function(c){b.Playbook.formations=c,d.success("Formations successfully loaded"),a(null,c)},function(b){a(b)})},function(a){f.getAssignmentGroups().then(function(c){Common.Utilities.isNotNullOrUndefined(c)&&(b.Playbook.assignmentGroups=c),d.success("Assignments successfully loaded"),a(null,c)},function(b){a(b)})},function(a){i.getPersonnel().then(function(c){Common.Utilities.isNotNullOrUndefined(c)&&(b.Team.personnel=c),d.success("Personnel successfully loaded"),a(null,c)},function(b){a(b)})},function(a){f.getPlays().then(function(c){b.Playbook.plays=c,d.success("Plays successfully loaded"),a(null,c)},function(b){a(b)})},function(a){f.getScenarios().then(function(c){b.Playbook.scenarios=c,d.success("Scenarios successfully loaded"),a(null,c)},function(b){a(b)})}],function(a,c){a?k.reject(a):(d.success("Initial data loaded successfully"),n(),k.resolve(b))}),k.promise}var p=!1,q=[],r=[],s={initialize:o,onReady:k,onInitializing:l};return impakt.context.Actionable||(impakt.context.Actionable={}),impakt.context.Organization||(impakt.context.Organization={}),impakt.context.Associations||(impakt.context.Associations={}),impakt.context.Playbook||(impakt.context.Playbook={}),impakt.context.Team||(impakt.context.Team={}),impakt.context.League||(impakt.context.League={}),impakt.context.Season||(impakt.context.Season={}),impakt.context.Planning||(impakt.context.Planning={}),s}]),impakt.common.contextmenu=angular.module("impakt.common.contextmenu",[]),impakt.common.contextmenu.controller("common.contextmenu.ctrl",["$scope","_contextmenu",function(a,b){a.$contextmenuElement,a.contextmenuData=b.contextmenuData,a.left=0,a.top=0,a.width=200,a.height=200,a.guid="",a.contextmenuVisible=!1,b.onopen(function(b){a.contextmenuData=b,a.contextmenuVisible=!0,a.$$phase||a.$apply(),a.$contextmenuElement.offset({top:b.pageY,left:b.pageX})}),b.onclose(function(){a.contextmenuData=null,a.contextmenuVisible=!1,a.$$phase||a.$apply()}),a.open=function(a){b.open(a)},a.close=function(){b.close()}}]).directive("contextmenu",["_contextmenu",function(a){return console.debug("directive: contextmenu - register"),{controller:"common.contextmenu.ctrl",restrict:"E",templateUrl:"common/contextmenu/contextmenu.tpl.html",transclude:!0,replace:!0,link:function(a,b,c){a.$contextmenuElement=b,$(document).keyup(function(b){b.which==Common.Input.Which.Esc&&a.close()})}}}]).directive("enableContextmenu",["_contextmenu",function(a){return{restrict:"A",scope:{entity:"="},link:function(b,c,d){c.mousedown(function(c){c.which==Common.Input.Which.RightClick&&a.open(new Common.Models.ContextmenuData(b.entity,c.pageX,c.pageY))})}}}]),impakt.common.contextmenu.service("_contextmenu",[function(){var a=function(){},b=function(a){};this.contextmenuData=null,this.open=function(a){this.contextmenuData=a,b(a)},this.onopen=function(a){b=a},this.close=function(){this.data=null,a()},this.onclose=function(b){a=b},this.calculatePosition=function(){},this.getData=function(){return Common.Utilities.isNotNullOrUndefined(this.contextmenuData)?this.contextmenuData.data:null}}]),impakt.common.localStorage=angular.module("impakt.common.localStorage",[]).config(function(){console.debug("impakt.common.localStorage - config")}).run(function(){console.debug("impakt.common.localStorage - run")}),impakt.common.localStorage.constant("LOCAL_STORAGE",{ACCESS_TOKEN:"access_token",ACCESS_TOKEN_EXPIRES:"access_token_expires",USER_NAME:"user_name",ORGANIZATION_KEY:"organization_key",DEFAULT_PLAYBOOK_KEY:"default_playbook_key",DEFAULT_PLAYBOOK_UNIT_TYPE:"default_playbook_unit_type",DEFAULT_EDITOR_TYPE:"default_editor_type",DEFAULT_EDITOR_ITEM_KEY:"default_editor_item_key",DEFAULT_EDITOR_ITEM_TYPE:"default_editor_item_type",DEFAULT_PATH:"default_path"}),impakt.common.localStorage.factory("__localStorage",["LOCAL_STORAGE",function(a){function b(){H.clearAccessToken(),H.resetDefaultEditorItem(),H.resetDefaultPlaybook()}function c(a){return localStorage.getItem(a)}function d(a,b){localStorage.setItem(a,b)}function e(){return localStorage.getItem(a.ACCESS_TOKEN)}function f(){return localStorage.getItem(a.ACCESS_TOKEN_EXPIRES)}function g(){var b=localStorage.getItem(a.USER_NAME);if(!b)throw new Error("__localStorage getUserName(): user name could not be found!");return b}function h(){var b=localStorage.getItem(a.ORGANIZATION_KEY);if(!b)throw new Error("__localStorage getOrganizationKey(): organization key could not be found!");return parseInt(b)}function i(b){if(isNaN(b))throw new Error("__localStorage setOrganizationKey(): Failed to set organization key "+b);localStorage.setItem(a.ORGANIZATION_KEY,b.toString())}function j(b){H.setItem(a.ACCESS_TOKEN,b.access_token),H.setItem(a.ACCESS_TOKEN_EXPIRES,b[".expires"]),H.setItem(a.USER_NAME,b.userName),H.setItem(a.ORGANIZATION_KEY,b.organizationKey)}function k(){H.setItem(a.ACCESS_TOKEN,null),H.setItem(a.ACCESS_TOKEN_EXPIRES,null),H.setItem(a.USER_NAME,null),H.setItem(a.ORGANIZATION_KEY,null)}function l(){return parseInt(localStorage.getItem(a.DEFAULT_PLAYBOOK_KEY))}function m(b){H.setItem(a.DEFAULT_PLAYBOOK_KEY,b)}function n(){H.setDefaultPlaybookKey(-1)}function o(){return parseInt(localStorage.getItem(a.DEFAULT_PLAYBOOK_UNIT_TYPE))}function p(b){H.setItem(a.DEFAULT_PLAYBOOK_UNIT_TYPE,b)}function q(){H.setDefaultPlaybookUnitType(-1)}function r(){H.resetDefaultPlaybookKey(),H.resetDefaultPlaybookUnitType()}function s(){var a=H.getDefaultEditorInfo();return a&&a.playbookKey>0&&a.editorType>=0&&a.editorItemKey>0&&a.editorItemType>=0}function t(a,b,c,d){H.setDefaultPlaybookKey(a),H.setDefaultEditorType(b),H.setDefaultEditorItemKey(c),H.setDefaultEditorItemType(d)}function u(){return{playbookKey:H.getDefaultPlaybookKey(),editorType:H.getDefaultEditorType(),editorItemKey:H.getDefaultEditorItemKey(),editorItemType:H.getDefaultEditorItemType()}}function v(){return parseInt(localStorage.getItem(a.DEFAULT_EDITOR_TYPE))}function w(b){H.setItem(a.DEFAULT_EDITOR_TYPE,b)}function x(){H.setDefaultEditorType(-1)}function y(){return parseInt(localStorage.getItem(a.DEFAULT_EDITOR_ITEM_KEY))}function z(b){H.setItem(a.DEFAULT_EDITOR_ITEM_KEY,b)}function A(){H.setDefaultEditorItemKey(-1)}function B(){return parseInt(localStorage.getItem(a.DEFAULT_EDITOR_ITEM_TYPE))}function C(b){H.setItem(a.DEFAULT_EDITOR_ITEM_TYPE,b)}function D(){H.setDefaultEditorItemType(-1)}function E(){H.resetDefaultEditorType(),H.resetDefaultEditorItemKey(),H.resetDefaultEditorItemType()}function F(){return localStorage.getItem(a.DEFAULT_PATH)}function G(b){H.setItem(a.DEFAULT_PATH,b)}var H={getItem:c,setItem:d,getAccessToken:e,setAccessToken:j,clearAccessToken:k,getAccessTokenExpiration:f,getUserName:g,getOrganizationKey:h,setOrganizationKey:i,isDefaultEditorInfoSet:s,getDefaultEditorInfo:u,setDefaultEditorInfo:t,getDefaultPlaybookKey:l,setDefaultPlaybookKey:m,resetDefaultPlaybookKey:n,getDefaultPlaybookUnitType:o,setDefaultPlaybookUnitType:p,resetDefaultPlaybookUnitType:q,resetDefaultPlaybook:r,getDefaultEditorType:v,setDefaultEditorType:w,resetDefaultEditorType:x,getDefaultEditorItemKey:y,setDefaultEditorItemKey:z,resetDefaultEditorItemKey:A,getDefaultEditorItemType:B,setDefaultEditorItemType:C,resetDefaultEditorItemType:D,resetDefaultEditorItem:E,getDefaultPath:F,setDefaultPath:G,signout:b};return H}]),impakt.common.locale=angular.module("impakt.common.locale",[]).config([function(){console.debug("impakt.common.locale - config")}]).run([function(){console.debug("impakt.common.locale - run")}]),impakt.common.locale.factory("__locale",[function(){function a(){return[{name:"Alabama",abbreviation:"AL"},{name:"Alaska",abbreviation:"AK"},{name:"American Samoa",abbreviation:"AS"},{name:"Arizona",abbreviation:"AZ"},{name:"Arkansas",abbreviation:"AR"},{name:"California",abbreviation:"CA"},{name:"Colorado",abbreviation:"CO"},{name:"Connecticut",abbreviation:"CT"},{name:"Delaware",abbreviation:"DE"},{name:"District Of Columbia",abbreviation:"DC"},{name:"Federated States Of Micronesia",abbreviation:"FM"},{name:"Florida",abbreviation:"FL"},{name:"Georgia",abbreviation:"GA"},{name:"Guam",abbreviation:"GU"},{name:"Hawaii",abbreviation:"HI"},{name:"Idaho",abbreviation:"ID"},{name:"Illinois",abbreviation:"IL"},{name:"Indiana",abbreviation:"IN"},{name:"Iowa",abbreviation:"IA"},{name:"Kansas",abbreviation:"KS"},{name:"Kentucky",abbreviation:"KY"},{name:"Louisiana",abbreviation:"LA"},{name:"Maine",abbreviation:"ME"},{name:"Marshall Islands",abbreviation:"MH"},{name:"Maryland",abbreviation:"MD"},{name:"Massachusetts",abbreviation:"MA"},{name:"Michigan",abbreviation:"MI"},{name:"Minnesota",abbreviation:"MN"},{name:"Mississippi",abbreviation:"MS"},{name:"Missouri",abbreviation:"MO"},{name:"Montana",abbreviation:"MT"},{name:"Nebraska",abbreviation:"NE"},{name:"Nevada",abbreviation:"NV"},{name:"New Hampshire",abbreviation:"NH"},{name:"New Jersey",abbreviation:"NJ"},{name:"New Mexico",abbreviation:"NM"},{name:"New York",abbreviation:"NY"},{name:"North Carolina",abbreviation:"NC"},{name:"North Dakota",abbreviation:"ND"},{name:"Northern Mariana Islands",abbreviation:"MP"},{name:"Ohio",abbreviation:"OH"},{name:"Oklahoma",abbreviation:"OK"},{name:"Oregon",abbreviation:"OR"},{name:"Palau",abbreviation:"PW"},{name:"Pennsylvania",abbreviation:"PA"},{name:"Puerto Rico",abbreviation:"PR"},{name:"Rhode Island",abbreviation:"RI"},{name:"South Carolina",abbreviation:"SC"},{name:"South Dakota",abbreviation:"SD"},{name:"Tennessee",abbreviation:"TN"},{name:"Texas",abbreviation:"TX"},{name:"Utah",abbreviation:"UT"},{name:"Vermont",abbreviation:"VT"},{name:"Virgin Islands",abbreviation:"VI"},{name:"Virginia",abbreviation:"VA"},{name:"Washington",abbreviation:"WA"},{name:"West Virginia",abbreviation:"WV"},{name:"Wisconsin",abbreviation:"WI"},{name:"Wyoming",abbreviation:"WY"}]}var b={states:a()};return b}]),impakt.common.modals=angular.module("impakt.common.modals",[]).config([function(){console.debug("impakt.common.modals - config")}]).run([function(){console.debug("impakt.common.modals - run")}]),impakt.common.modals.factory("__modals",["$uibModal",function(a){function b(b,c,d,e){console.log("open modal",e);for(var f in e)if("function"!=typeof e[f])throw Error(["Modal resolve data must be given ","as an anonymous function which ","returns a value."," | key: ",f," | data: ",e[f]].join(""));return a.open({animation:!0,backdrop:!0,size:b,templateUrl:c,controller:d,resolve:e})}var c={open:b};return c}]),impakt.common.notifications=angular.module("impakt.common.notifications",[]).config([function(){console.debug("impakt.common.notifications - config")}]).run([function(){console.debug("impakt.common.notifications - run")}]),impakt.common.notifications.controller("notifications.ctrl",["$scope","__notifications",function(a,b){a.notifications=b.notifications,a.notificationTypes=b.notificationTypes,a.test=function(){var c=Math.floor(Math.random()*a.notificationTypes.length);b.notify("test notification!",c)},a.clearAll=function(){b.removeAll()},a.remove=function(a){b.remove(a)}}]).directive("notifications",["$compile","__notifications",function(a,b){return{restrict:"E",templateUrl:"common/notifications/notifications.tpl.html",controller:"notifications.ctrl",link:function(a,b,c){}}}]).directive("notificationItem",[function(){return{restrict:"E",templateUrl:"common/notifications/notification-item.tpl.html",controller:"notifications.ctrl",link:function(a,b,c){c.type}}}]),impakt.common.notifications.service("__notifications",[function(){function a(a){return!a||!a.length||a.length<=0?"":a.join("")}this.notifications=new Common.Models.NotificationCollection,this.notificationTypes=Common.Utilities.getEnumerationsAsArray(Common.Models.NotificationType),this.removeAll=function(){this.notifications.removeAll()},this.remove=function(a){return this.notifications.remove(a)},this.notify=function(a,b){var c=new Common.Models.Notification(a,b);return this.notifications.add(c),c},this.success=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return this.notify(a(b),Common.Models.NotificationType.Success)},this.error=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return this.notify(a(b),Common.Models.NotificationType.Error)},this.warning=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return this.notify(a(b),Common.Models.NotificationType.Warning)},this.info=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return this.notify(a(b),Common.Models.NotificationType.Info)},this.pending=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return this.notify(a(b),Common.Models.NotificationType.Pending)}}]),impakt.common.parser=angular.module("impakt.common.parser",[]).config(function(){console.debug("impakt.common.parser - config")}).run(function(){console.debug("impakt.common.parser - run")}),impakt.common.parser.constant("PARSER",{}),impakt.common.parser.factory("__parser",["PARSER",function(a){function b(a,b){return Common.Utilities.camelCaseToSpace(a,b)}function c(a){return Common.Utilities.convertEnumToList(a)}function d(a){return Common.Utilities.toJson(a)}var e={camelCaseToSpace:b,convertEnumToList:c,toJson:d};return e}]),impakt.common.scrollable=angular.module("impakt.common.scrollable",[]).config(function(){console.debug("impakt.common.scrollable - config")}).run(function(){console.debug("impakt.common.scrollable - run")}),impakt.common.scrollable.directive("scrollable",["_scrollable",function(a){return console.debug("directive: impakt.common.scrollable - register"),{restrict:"A",link:function(a,b,c){console.log("scrollable element")}}}]),impakt.common.scrollable.service("_scrollable",["$rootScope",function(a){console.debug("service: impakt.common.scrollable");var b,c,d=this;this.$container,this.$head,this.headHeight,this.$well,this.content,this.contentHeight,this.HEIGHT_RATIO,this.deltaY,this.deltaX,this.offsetY,this.deltaRatioY,this.offsetX,this.deltaRatioX,this.speed,this.range,this.altKeyPressed,this.speed,this.thresholdX=10,this.thresholdY=10,this.readyCallback=function(){console.log("scrollable ready")},this.scrollCallback=function(a,b){},this.initialize=function(a,d){if(this.altKeyPressed=!1,this.$container=a,this.height=a.height(),this.content=d,this.contentHeight=d.getHeight(),this.HEIGHT_RATIO=this.height/this.contentHeight,this.$head=$("<div class='scroll-head'></div>"),this.$well=$("<div class='scroll'></div>").append(this.$head),this.$container.find(".scroll").remove(),this.$container.addClass("scrollable-container").append(this.$well),this.offsetY=0,this.offsetX=0,this.deltaY=0,this.deltaX=0,this.speed=.25,this.speed<0||this.speed>1)throw new Error("scroll speed must be between 0 and 1");this.deltaRatioY=0,this.deltaRatioX=0,this.headHeight=Math.ceil(this.HEIGHT_RATIO*this.height),this.$head.height(this.headHeight),this.headOffsetY=0,this.headOffsetX=0,console.log("container height: ",this.height,"head height: ",this.headHeight),this.range=this.contentHeight-this.height,this.headRange=this.height-this.headHeight,b=!1,c=!1,this.setListener(),this.ready()},this.setListener=function(){this.$head.draggable({axis:"y",containment:".scrollable-container .scroll",drag:function(a,b){}}),this.$container[0].addEventListener("mousewheel",function(a){d.scroll.call(d,a.wheelDeltaX,a.wheelDeltaY,a.altKey)},!1)},this.isDown=function(){return b&&d.offsetY>-d.range},this.isUp=function(){return c&&d.offsetY<0},this.canScroll=function(){return this.isDown()||this.isUp()},this.setHead=function(a,b){this.$head.css({top:b+"px"})},this.onready=function(a){this.readyCallback=a},this.ready=function(){this.readyCallback(this.content)},this.onscroll=function(a){this.scrollCallback=a},this.scrollToPercentY=function(a){if(0>a||a>1)throw new Error("Percent must be between 0 and 1");this.headOffsetY=a*this.headRange,this.offsetY=-a*this.range,this.setHead(0,this.headOffsetY),this.content.scroll(this.offsetX,-this.offsetY)},this.scrollToPercentX=function(a){},this.scrollToPercent=function(a,b){this.scrollToPercentX(a),this.scrollToPercentY(b)},this.scroll=function(a,e,f){if(!(Math.abs(a)<d.thresholdX&&Math.abs(e)<d.thresholdY)){if(d.deltaX=a,d.deltaY=e,d.altKeyPressed=f,d.deltaRatioX=new Number(d.deltaX*d.HEIGHT_RATIO).toFixed(1),d.deltaRatioY=new Number(d.deltaY*d.HEIGHT_RATIO).toFixed(1),b=d.deltaY<0,c=!b,!d.altKeyPressed)if(d.canScroll()){var g=d.offsetY+d.deltaY*d.speed,h=d.isDown()?Math.max(g,-d.range):Math.min(g,0);if(h<-d.range||h>0)return;d.headOffsetY=-h*d.HEIGHT_RATIO,d.offsetY=h,d.setHead.call(d,0,d.headOffsetY),d.content.scroll(d.offsetX,-d.offsetY)}else console.log("STOP");this.scrollCallback(a,e)}}}]),impakt.common.signin=angular.module("impakt.common.signin",[]).config([function(){console.debug("impakt.common.signin - config")}]).run([function(){console.debug("impakt.common.signin - run")}]),impakt.common.signin.constant("SIGNIN",{ORG_ENDPOINT:"/configuration",INVITE_ENDPOINT:"/invitations",REGISTER_USER:"/registerUser",CREATE_ORGANIZATION:"/createOrganization"}),impakt.common.signin.controller("signin.ctrl",["$scope","__signin","__locale",function(a,b,c){a.showSignin=!0,a.showRegister=!1,a.states=c.states,a.signinData={username:"",password:""},a.signinMessage="",a.organization=new User.Models.Organization,a.account=new User.Models.Account,a.toggleSignin=function(b){a.showSignin=b===!0?b:!a.showSignin,a.showRegister=!a.showSignin},a.toggleRegister=function(b){a.showRegister=b===!0?b:!a.showRegister,a.showSignin=!a.showRegister},a.createUser=function(c){console.log("creating user"),b.registerUser(a.user).then(function(a){console.log("user created",a)},function(a){console.error(a)})},a.createOrganization=function(c){console.log("creating organization"),b.createOrganization(a.organization).then(function(a){console.log("organization created",a)},function(a){console.error(a)}),c()},a.createAccount=function(a){console.log("creating account"),a()},a.signin=function(){b.signin(a.signinData.username,a.signinData.password).then(function(b){a.signinMessage="signin successful."},function(b){a.signinMessage=b&&b.data&&b.data.error_description||b})},a.register=function(){}}]),impakt.common.signin.factory("__signin",["$q","$window","__api","__auth","__localStorage","SIGNIN",function(a,b,c,d,e,f){function g(c,f){var g=a.defer();return d.getToken(c,f).then(function(a){console.log(a),e.setAccessToken(a.data),b.location.href="index.html",g.resolve(a)},function(a){console.error(a),g.reject(a)}),g.promise}function h(){e.signout(),b.location.href="signin.html"}function i(b){var d=a.defer(),e=b.toJson();return c.post(c.path(f.INVITE_ENDPOINT,f.REGISTER_USER),{version:1,FirstName:b.firstName,LastName:b.lastName,OrganizationKey:0,OrganizationName:b.organizationName,Email:b.email,data:{version:1,FirstName:b.firstName,LastName:b.lastName,OrganizationKey:0,OrganizationName:b.organizationName,Email:b.email,user:e}}).then(function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise;
}function j(b){var d=a.defer(),e=b.toJson();return c.post(c.path(f.ORG_ENDPOINT,f.CREATE_ORGANIZATION),{version:1,data:{version:1,organization:e}}).then(function(a){var b=Common.Utilities.parseData(a.data.results),c=new User.Models.Organization;b?c.fromJson(b):d.reject(null),d.resolve(c)},function(a){d.reject(a)}),d.promise}var k={signin:g,logout:h,registerUser:i,createOrganization:j};return k}]),impakt.common.ui=angular.module("impakt.common.ui",["impakt.quotes"]).config([function(){console.debug("impakt.common.ui - config")}]).run([function(){console.debug("impakt.common.ui - run")}]),impakt.common.ui.controller("appLoading.ctrl",["$scope","$timeout","__context","__notifications",function(a,b,c,d){a.$element,a.visible=!1,a.notifications=d.notifications,a.notification,a.notifications.onModified(function(b){a.notification=b.getLast(),a.$$phase||a.$apply()}),a.skip=function(){a.visible=!1},c.onInitializing(function(){a.visible=!0}),c.onReady(function(){b(function(){a.visible=!1},1e3)})}]).directive("appLoading",[function(){return{restrict:"E",templateUrl:"common/ui/app-loading/app-loading.tpl.html",transclude:!0,replace:!0,controller:"appLoading.ctrl",link:function(a,b,c){a.$element=b}}}]),impakt.common.ui.controller("assignmentGroupItem.ctrl",["$scope","_playbook","_details",function(a,b,c){a.assignmentGroup,a.element,a.toggleSelection=function(a){c.toggleSelection(a)}}]).directive("assignmentGroupItem",[function(){return{restrict:"E",controller:"assignmentGroupItem.ctrl",scope:{assignmentGroup:"=assignmentgroup"},templateUrl:"common/ui/assignment-group-item/assignment-group-item.tpl.html",transclude:!0,replace:!0,link:function(a,b,c){a.$element=b}}}]),impakt.common.ui.controller("assignmentGroupSelectDropdown.ctrl",["$scope",function(a){a.assignmentGroups=impakt.context.Playbook.assignmentGroups}]).directive("assignmentGroupSelectDropdown",[function(){return{restrict:"E",controller:"assignmentGroupSelectDropdown.ctrl",link:function(a,b,c){}}}]),impakt.common.ui.controller("associationInput.ctrl",["$scope","$rootScope","_associations",function(a,b,c){function d(b){if(Common.Utilities.isNullOrUndefined(a.entity))throw new Error("association-input addAssociation(): entity is null or undefined");if(Common.Utilities.isNullOrUndefined(b))throw new Error("association-input addAssociation(): toEntity is null or undefined")}a.associations,a.key,a.possibleAssociations=new Common.Models.ActionableCollection,a.associatedEntities=new Common.Models.ActionableCollection,a.possibleAssociationsListVisible=!1,a.selectedPossibleAssociationIndex=0,a.selectedPossibleAssociation=null,a.search={text:""};var e=b.$on("associations-updated",function(b){a.associations=c.getAssociated(a.entity),a.initialize()}),f=b.$on("create-entity",function(b,c){a.initialize()});a.$watch("search",function(b,c){a.possibleAssociationsListVisible=b.text.length>0},!0),a.$on("$destroy",function(){e(),f()}),a.initialize=function(){a.possibleAssociations=c.getContextDataByKey(a.key),Common.Utilities.isNotNullOrUndefined(a.associations)&&(a.associatedEntities=a.associations[a.key],Common.Utilities.isNotNullOrUndefined(a.associatedEntities)&&a.associatedEntities.forEach(function(b,c){a.possibleAssociations.remove(b.guid)}))},a.addAssociation=function(b){d(b),c.createAssociation(a.entity,b).then(function(){a.selectedPossibleAssociation=null,a.search.text=""},function(b){a.search.text=""})},a.removeAssociation=function(b){d(b),c.deleteAssociation(a.entity,b).then(function(){a.search.text=""},function(b){a.search.text=""})},a.addSelectedPossibleAssociation=function(){Common.Utilities.isNullOrUndefined(a.selectedPossibleAssociation)||(a.addAssociation(a.selectedPossibleAssociation),a.selectedPossibleAssociation=null,a.hidePossibleAssociationsList())},a.hidePossibleAssociationsList=function(){a.selectedPossibleAssociationIndex=0,a.possibleAssociationsListVisible=!1},a.showPossibleAssociationsList=function(){a.possibleAssociationsListVisible=!0,a.hoverInitialPossibleAssociation()},a.hoverInitialPossibleAssociation=function(){if(!Common.Utilities.isNullOrUndefined(a.possibleAssociations)){a.selectedPossibleAssociationIndex=0;var b=a.possibleAssociations.size();b>0&&(a.selectedPossibleAssociation=a.possibleAssociations.first(),Common.Utilities.isNotNullOrUndefined(a.selectedPossibleAssociation)&&a.possibleAssociations.hoverIn(a.selectedPossibleAssociation))}},a.hoverNextPossibleAssociation=function(){if(!Common.Utilities.isNullOrUndefined(a.possibleAssociations)){if(!a.possibleAssociationsListVisible)return void a.showPossibleAssociationsList();var b=a.possibleAssociations.size();a.selectedPossibleAssociationIndex<b-1&&(a.selectedPossibleAssociationIndex++,a.selectedPossibleAssociation=a.possibleAssociations.getIndex(a.selectedPossibleAssociationIndex),Common.Utilities.isNotNullOrUndefined(a.selectedPossibleAssociation)&&a.possibleAssociations.hoverIn(a.selectedPossibleAssociation))}},a.hoverPreviousPossibleAssociation=function(){Common.Utilities.isNullOrUndefined(a.possibleAssociations)||(a.selectedPossibleAssociationIndex>0?(a.selectedPossibleAssociationIndex--,a.selectedPossibleAssociation=a.possibleAssociations.getIndex(a.selectedPossibleAssociationIndex),Common.Utilities.isNotNullOrUndefined(a.selectedPossibleAssociation)&&a.possibleAssociations.hoverIn(a.selectedPossibleAssociation)):a.possibleAssociationsListVisible&&a.hidePossibleAssociationsList())},a.getController=function(){return a}}]).directive("associationInput",["_associations",function(a){return{restrict:"E",controller:"associationInput.ctrl",templateUrl:"common/ui/association-input/association-input.tpl.html",transclude:!0,replace:!1,scope:{entity:"=",associations:"=",key:"@"},link:function(a,b,c){if(Common.Utilities.isNullOrUndefined(a.key))throw new Error("association-input link(): key is required and is null or undefined");a.initialize();var d=b.find(".associations-input-text");Common.Utilities.isNotNullOrUndefined(d)&&(d.keyup(function(b){b.preventDefault(),b.keyCode==Common.Input.Which.Esc?a.possibleAssociationsListVisible=!1:b.keyCode==Common.Input.Which.Up?a.hoverPreviousPossibleAssociation():b.keyCode==Common.Input.Which.Down?a.hoverNextPossibleAssociation():b.keyCode==Common.Input.Which.Enter&&a.addSelectedPossibleAssociation(),a.$apply()}),a.$on("$destroy",function(){d.off("focus").off("blur").off("keyup)")}))}}}]).directive("associationCandidateItem",[function(){return{restrict:"E",controller:"associationInput.ctrl",require:"^associationInput",templateUrl:"common/ui/association-input/association-candidate-item.tpl.html",transclude:!0,replace:!1,link:function(a,b,c,d){}}}]).directive("associationTag",[function(){return{restrict:"E",controller:"associationInput.ctrl",require:"^associationInput",templateUrl:"common/ui/association-input/association-tag.tpl.html",transclude:!0,replace:!1,link:function(a,b,c){}}}]),impakt.common.ui.controller("conferenceItem.ctrl",["$scope","$state","_details","_league","_associations",function(a,b,c,d,e){a.conference,a.element,a.getLeague=function(a){return Common.Utilities.isNotNullOrUndefined(a)&&Common.Utilities.isNotNullOrUndefined(a.league)?a.league.name:"No league"},a.toggleSelection=function(a){b.is("league.drilldown.conference")?c.toggleSelection(a):(c.selectedElements.deselectAll(),d.toConferenceDrilldown(a))}}]).directive("conferenceItem",["_associations",function(a){return{restrict:"E",controller:"conferenceItem.ctrl",scope:{conference:"="},templateUrl:"common/ui/conference-item/conference-item.tpl.html",transclude:!0,replace:!0,compile:function(b,c,d){return{pre:function(a,b,c,d){},post:function(b,c,d,e){b.$element=c;var f=a.getAssociated(b.conference);Common.Utilities.isNotNullOrUndefined(f)&&f.leagues.hasElements()&&b.conference.setLeague(f.leagues.first())}}}}}]),impakt.common.ui.directive("details",[function(){return{restrict:"E",compile:function(a,b){return{pre:function(a,b,c,d,e){},post:function(a,b,c,d,e){}}}}}]),impakt.common.ui.controller("divisionItem.ctrl",["$scope","$state","_details","_league","_associations",function(a,b,c,d,e){a.division,a.element,a.getConference=function(a){return Common.Utilities.isNotNullOrUndefined(a)&&Common.Utilities.isNotNullOrUndefined(a.conference)?a.conference.name:"No league"},a.toggleSelection=function(a){b.is("league.drilldown.division")?c.toggleSelection(a):(c.selectedElements.deselectAll(),d.toDivisionDrilldown(a))}}]).directive("divisionItem",["_associations",function(a){return{restrict:"E",controller:"divisionItem.ctrl",scope:{division:"="},templateUrl:"common/ui/division-item/division-item.tpl.html",transclude:!0,replace:!0,compile:function(b,c,d){return{pre:function(a,b,c,d){},post:function(b,c,d,e){b.$element=c;var f=a.getAssociated(b.division);Common.Utilities.isNotNullOrUndefined(f)&&f.conferences.hasElements()&&b.division.setConference(f.conferences.first())}}}}}]),impakt.common.ui.controller("expandable.ctrl",["$scope","_expandable",function(a,b){a.expandable}]).directive("expandable",["$compile",function(a){return{restrict:"E",controller:"expandable.ctrl",transclude:!0,replace:!0,templateUrl:"common/ui/expandable/expandable.tpl.html",scope:{collapsed:"=?",direction:"@",url:"@"},compile:function(a,b){return{pre:function(a,b,c,d,e){a.expandable=new Common.Models.Expandable(b),a.expandable.url=a.url,a.expandable.direction=a.direction,a.expandable.collapsed=Boolean(a.collapsed)!==!1,a.expandable.setInitialClass(),a.expandable.ready=!0},post:function(a,b,c,d,e){}}}}}]).directive("expandableToggle",[function(){return{restrict:"E",controller:"expandable.ctrl",transclude:!0,replace:!0,require:"^expandable",template:"<div class='width3 height3 pad {{expandable.handle.position}} 			gray-bg-3-hover pointer font- white'			ng-click='expandable.toggle()'>				<div class='glyphicon {{expandable.handle.class}}'></div>			</div>'",compile:function(a,b){return{pre:function(a,b,c,d,e){},post:function(a,b,c,d,e){a.expandable.initializeToggleHandle()}}}}}]),impakt.common.ui.service("_expandable",[function(){this.elements=new Common.Models.Collection}]),impakt.common.ui.controller("formationItem.ctrl",["$scope","_playbook","_details",function(a,b,c){a.play,a.element,a.toggleSelection=function(a){c.toggleSelection(a)},a.openInEditor=function(a){b.editFormation(a)}}]).directive("formationItem",[function(){return{restrict:"E",controller:"formationItem.ctrl",scope:{formation:"="},templateUrl:"common/ui/formation-item/formation-item.tpl.html",transclude:!0,replace:!0,compile:function(a,b,c){return{pre:function(a,b,c,d){},post:function(a,b,c,d){a.$element=b}}}}}]),impakt.common.ui.controller("formationPreview.ctrl",["$scope","$timeout",function(a,b){a.previewCanvas,a.play,a.scenario,a.$element,a.isModified=!0,a.modificationTimer,a.refresh=function(){if(!a.play)throw new Error("formation-preview refresh(): Play is null or undefined");if(!a.play.formation)throw new Error("formation-preview refresh(): Formation is null or undefined");if(!a.previewCanvas)throw new Error("formation-preview refresh(): PreviewCanvas is null or undefined");if(!a.$element)throw new Error("formation-preview refresh(): $element is null or undefined");a.$element.find("svg").show(),a.previewCanvas.field.updateScenario(a.scenario),a.play.formation.png=a.previewCanvas.exportToPng(),a.isModified=!1;var c=a.previewCanvas.field.getLOSAbsolute()-a.$element.height()/2;a.$element.scrollTop(c),a.modificationTimer&&b.cancel(a.modificationTimer)}}]).directive("formationPreview",["$timeout",function(a){return{restrict:"E",controller:"formationPreview.ctrl",scope:{play:"="},compile:function(b,c,d){return{pre:function(a,b,c,d){},post:function(b,c,d,e){if(b.$element=c,b.previewCanvas=new Playbook.Models.PreviewCanvas,Common.Utilities.isNullOrUndefined(b.play))throw new Error("play-preview link(): Unable to find play");b.play.onModified(function(){b.isModified=!0,b.modificationTimer&&a.cancel(b.modificationTimer),b.modificationTimer=a(function(){console.log("auto refresh based on user changes"),b.refresh()},200)}),a(function(){b.previewCanvas&&(b.previewCanvas.setListener("onready",function(){var a=b.previewCanvas.field.getLOSAbsolute()-b.$element.height()/2;b.$element.scrollTop(a)}),b.previewCanvas.initialize(c),b.scenario=new Common.Models.Scenario,b.scenario.setPlayPrimary(b.play),b.scenario.setPlayOpponent(null),b.previewCanvas.field.updateScenario(b.scenario),b.play.formation.png=b.previewCanvas.exportToPng())},0)}}}}}]),impakt.common.ui.controller("formationSelectDropdown.ctrl",["$scope",function(a){a.formations=impakt.context.Playbook.formations}]).directive("formationSelectDropdown",[function(){return{restrict:"E",controller:"formationSelectDropdown.ctrl",link:function(a,b,c){}}}]),impakt.common.ui.controller("formationThumbnail.ctrl",["$scope",function(a){a.formation}]).directive("formationThumbnail",[function(){return{restrict:"E",controller:"formationThumbnail.ctrl",scope:{formation:"="},compile:function(a,b,c){return{pre:function(a,b,c,d){},post:function(a,b,c,d){a.$element=b;var e=b.height(),f=document.createElement("img");f.src=a.formation.png;var g=$(f);a.$element.append(g),f.addEventListener("load",function(){var a=g.height(),b=-(.5*a)+e/2+"px";g.css({top:b})},!1)}}}}}]),impakt.common.ui.controller("typeFormatter.ctrl",["$scope",function(a){a.parseValue=function(b){var c=Common.Utilities.parseEnumFromString(a.type),d=Common.Utilities.convertEnumToList(c);if(d){var e=d[a.value];e&&b.html(e)}}}]).directive("typeFormatter",[function(){return{restrict:"E",controller:"typeFormatter.ctrl",scope:{value:"=",type:"@"},link:function(a,b,c){if(!c.type)throw new Error('type-formatter directive: 					A valid "type" attribute must be present on the element, 					which is the fully namespaced type of the enum to evaluate.');if(!c.value)throw new Error('type-formatter directive: 					A valid "value" attribute must be present on the element, 					which is the enum value to retrieve the string for.');a.parseValue(b),a.$watch("value",function(c,d){a.parseValue(b)})}}}]),impakt.common.ui.controller("gameItem.ctrl",["$scope","$state","_details","_season","_associations",function(a,b,c,d,e){a.game,a.element,a.getSeason=function(a){return Common.Utilities.isNotNullOrUndefined(a)&&Common.Utilities.isNotNullOrUndefined(a.season)?a.season.name:"No season"},a.getWeek=function(a){return Common.Utilities.isNotNullOrUndefined(a)&&Common.Utilities.isNotNullOrUndefined(a.week)?a.week.name:"No week"},a.toggleSelection=function(a){b.is("season.drilldown.game")?c.toggleSelection(a):(c.selectedElements.deselectAll(),d.toGameDrilldown(a))}}]).directive("gameItem",["_associations",function(a){return{restrict:"E",controller:"gameItem.ctrl",scope:{game:"="},templateUrl:"common/ui/game-item/game-item.tpl.html",transclude:!0,replace:!0,compile:function(b,c,d){return{pre:function(a,b,c,d){},post:function(b,c,d,e){b.$element=c;var f=a.getAssociated(b.game);Common.Utilities.isNotNullOrUndefined(f)&&f.seasons.hasElements()&&b.game.setSeason(f.seasons.first())}}}}}]),impakt.common.ui.controller("gamePlanItem.ctrl",["$scope","$state","_details","_planning","_associations",function(a,b,c,d,e){a.gamePlan,a.element,a.toggleSelection=function(a){c.toggleSelection(a)},a.hoverIn=function(){Common.Utilities.isNullOrUndefined(a.gamePlan)||a.gamePlan.hoverIn()},a.hoverOut=function(){Common.Utilities.isNullOrUndefined(a.gamePlan)||a.gamePlan.hoverOut()},a.edit=function(){d.toGamePlanEditor(a.gamePlan)}}]).directive("gamePlanItem",["_associations",function(a){return{restrict:"E",controller:"gamePlanItem.ctrl",scope:{gamePlan:"="},templateUrl:"common/ui/game-plan-item/game-plan-item.tpl.html",transclude:!0,replace:!0,compile:function(b,c,d){return{pre:function(a,b,c,d){},post:function(b,c,d,e){b.$element=c;var f=a.getAssociated(b.gamePlan);Common.Utilities.isNotNullOrUndefined(f)}}}}}]),impakt.common.ui.controller("grid.ctrl",["$scope","_details",function(a,b){a.play,a.element}]).directive("grid",[function(){return{restrict:"E",controller:"grid.ctrl",scope:{element:"="},templateUrl:"",compile:function(a,b,c){return{pre:function(a,b,c,d){},post:function(a,b,c,d){a.$element=b}}}}}]),impakt.common.ui.controller("impaktDatepicker.ctrl",["$scope",function(a){a.datetime,a.popup,a.togglePopup=function(b){a.popup.opened=b===!0?!0:!a.popup.opened},a.updateMethod=function(){a.update()}}]).directive("impaktDatepicker",[function(){return{restrict:"E",controller:"impaktDatepicker.ctrl",templateUrl:"common/ui/impakt-datepicker/impakt-datepicker.tpl.html",transclude:!0,replace:!1,scope:{datetime:"=",update:"&?"},link:function(a,b,c){a.popup=a.datetime.popup}}}]),impakt.common.ui.directive("ngPlaceholder",["$sce",function(a){return{restrict:"A",require:"?ngModel",scope:{ngPlaceholder:"@"},link:function(b,c,d,e){function f(){c.val(""),g(""),c.removeAttr("style")}function g(a){e.$setViewValue(a)}function h(){i()?c.removeAttr("style"):(c.css({color:"rgba(181, 182, 183, 0.8)","-webkit-text-fill-color":"rgba(181, 182, 183, 0.8)","font-style":"italic"}),c.val(b.ngPlaceholder))}function i(){return!isNaN(parseInt(e.$viewValue))||Common.Utilities.isNotNullOrUndefined(e.$viewValue)&&Common.Utilities.isNotEmptyString(e.$viewValue)}if(b.ngPlaceholder&&d&&(d&&d.hasOwnProperty("autofocus")&&(void 0===d.autofocus||Boolean(d.autofocus)===!0||""==d.autofocus)&&c.focus(),c.focus(function(){i()||f()}).blur(function(){i()||h()}).keyup(function(a){a.keyCode==Common.Input.Which.Backspace&&(i()||f())}),b.$on("$destroy",function(){c.off("focus").off("blur").off("keyup")}),Common.Utilities.isNotNullOrUndefined(e)&&Common.Utilities.isNotNullOrUndefined(d.ngModel))){var j=e.$viewValue||null;b.$watch(d.ngModel,function(a,b){h()},!0),Common.Utilities.isNullOrUndefined(j)?h():(c.removeClass("font-gray").addClass("font-white"),e.$render=function(){c.val(a.getTrustedHtml(e.$viewValue||""))})}}}}]),impakt.common.ui.controller("leagueItem.ctrl",["$scope","$state","_details","_league","_associations",function(a,b,c,d,e){a.league,a.element,a.toggleSelection=function(a){b.is("league.drilldown.league")?c.toggleSelection(a):(c.selectedElements.deselectAll(),d.toLeagueDrilldown(a))}}]).directive("leagueItem",["_associations",function(a){return{restrict:"E",controller:"leagueItem.ctrl",scope:{league:"="},templateUrl:"common/ui/league-item/league-item.tpl.html",transclude:!0,replace:!0,compile:function(b,c,d){return{pre:function(a,b,c,d){},post:function(b,c,d,e){b.$element=c;var f=a.getAssociated(b.league);Common.Utilities.isNotNullOrUndefined(f)}}}}}]),impakt.common.ui.controller("personnelSelectDropdown.ctrl",["$scope",function(a){a.personnels=impakt.context.Team.personnel}]).directive("personnelSelectDropdown",[function(){return{restrict:"E",controller:"personnelSelectDropdown.ctrl",link:function(a,b,c){}}}]),impakt.common.ui.controller("planItem.ctrl",["$scope","$state","_details","_planning","_associations",function(a,b,c,d,e){a.plan,a.element,a.toggleSelection=function(a){b.is("planning.drilldown.plan")?c.toggleSelection(a):(c.selectedElements.deselectAll(),d.toPlanDrilldown(a))}}]).directive("planItem",["_associations",function(a){return{restrict:"E",controller:"planItem.ctrl",scope:{plan:"="},templateUrl:"common/ui/plan-item/plan-item.tpl.html",transclude:!0,replace:!0,compile:function(b,c,d){return{pre:function(a,b,c,d){},post:function(b,c,d,e){b.$element=c;var f=a.getAssociated(b.plan);if(Common.Utilities.isNotNullOrUndefined(f),Common.Utilities.isNotNullOrUndefined(b.plan)&&Common.Utilities.isNotEmptyString(b.plan.gameGuid)){var g=impakt.context.Season.games.get(b.plan.gameGuid);b.plan.setGame(g)}}}}}}]),impakt.common.ui.controller("planningEditorTab.ctrl",["$scope","$state","_planningEditor",function(a,b,c){a.tab,a.element,a.toggleSelection=function(){a.tab.selected||c.activateTab(a.tab)},a.close=function(){c.close(a.tab)}}]).directive("planningEditorTab",["_associations",function(a){return{restrict:"E",controller:"planningEditorTab.ctrl",scope:{tab:"=tabObject"},templateUrl:"common/ui/planning-editor-tab/planning-editor-tab.tpl.html",transclude:!0,replace:!0,compile:function(a,b,c){return{pre:function(a,b,c,d){},post:function(a,b,c,d){a.$element=b}}}}}]),impakt.common.ui.controller("planningEditorToggle.ctrl",["$scope",function(a){a.item,a.toggle=function(){a.item.toggleSelect()}}]).directive("planningEditorToggle",[function(){return{restrict:"E",controller:"planningEditorToggle.ctrl",templateUrl:"common/ui/planning-editor-toggle/planning-editor-toggle.tpl.html",transclude:!0,replace:!0,scope:{item:"="},link:function(a,b,c){}}}]),impakt.common.ui.controller("playItem.ctrl",["$scope","_details","_playbook",function(a,b,c){a.play,a.element,a.toggleSelection=function(a){b.toggleSelection(a)},a.openInEditor=function(a){c.editPlay(a)}}]).directive("playItem",[function(){return{restrict:"E",controller:"playItem.ctrl",scope:{play:"="},templateUrl:"common/ui/play-item/play-item.tpl.html",transclude:!0,replace:!0,compile:function(a,b,c){return{pre:function(a,b,c,d){},post:function(a,b,c,d){a.$element=b}}}}}]),impakt.common.ui.controller("playPreview.ctrl",["$scope","$timeout",function(a,b){a.previewCanvas,a.play,a.scenario,a.$element,a.isModified=!0,a.modificationTimer,a.refresh=function(){if(!a.play)throw new Error("play-preview refresh(): Play is null or undefined");if(!a.previewCanvas)throw new Error("play-preview refresh(): PreviewCanvas is null or undefined");if(!a.$element)throw new Error("play-preview refresh(): $element is null or undefined");if(a.$element.height()<=0)return void console.warn("play-preview refresh(): $element height is <= 0, skipping the refresh.");a.$element.find("svg").show(),a.previewCanvas.field.updateScenario(a.scenario),a.play.png=a.previewCanvas.exportToPng(),a.isModified=!1;var c=a.previewCanvas.field.getLOSAbsolute()-a.$element.height()/2;a.$element.scrollTop(c),a.modificationTimer&&b.cancel(a.modificationTimer)}}]).directive("playPreview",["$timeout","_associations",function(a,b){return{restrict:"E",controller:"playPreview.ctrl",scope:{play:"="},compile:function(b,c,d){return{pre:function(a,b,c,d){},post:function(b,c,d,e){if(b.$element=c,!Common.Utilities.isNotNullOrUndefined(b.play))throw new Error("play-preview link(): Unable to find play");b.previewCanvas=new Playbook.Models.PreviewCanvas,b.play.onModified(function(){b.isModified=!0,b.modificationTimer&&a.cancel(b.modificationTimer),b.modificationTimer=a(function(){console.log("auto refresh based on user changes"),b.refresh()},200)}),a(function(){b.previewCanvas&&(b.previewCanvas.setListener("onready",function(){var a=b.previewCanvas.field.getLOSAbsolute()-b.$element.height()/2;b.$element.scrollTop(a)}),b.previewCanvas.initialize(c),b.scenario=new Common.Models.Scenario,b.scenario.setPlayPrimary(b.play),b.scenario.setPlayOpponent(null),b.previewCanvas.field.updateScenario(b.scenario),b.play.png=b.previewCanvas.exportToPng())},0)}}}}}]),impakt.common.ui.service("_playPreview",[function(){this.viewBox="",this.setViewBox=function(a,b,c,d){this.viewBox=[a," ",b," ",c," ",d].join("")},this.compress=function(a){return Common.Utilities.compressSVG(a)},this.decompress=function(a){return Common.Utilities.decompressSVG(a)}}]),impakt.common.ui.controller("playThumbnail.ctrl",["$scope",function(a){a.play}]).directive("playThumbnail",[function(){return{restrict:"E",controller:"playThumbnail.ctrl",scope:{play:"="},compile:function(a,b,c){return{pre:function(a,b,c,d){},post:function(a,b,c,d){a.$element=b;var e=b.height(),f=document.createElement("img");f.src=a.play.png;var g=$(f);a.$element.append(g),f.addEventListener("load",function(){var a=g.height(),b=-(.5*a)+e/2+"px";g.css({top:b})},!1)}}}}}]),impakt.common.ui.controller("playbookItem.ctrl",["$scope","$state","_details","_playbook",function(a,b,c,d){a.playbook,a.element,a.toggleSelection=function(a){b.is("playbook.drilldown.playbook")?c.toggleSelection(a):(c.selectedElements.deselectAll(),d.toPlaybookDrilldown(a))},a.toPlaybookDrilldown=function(a){d.toPlaybookDrilldown(a)}}]).directive("playbookItem",[function(){return{restrict:"E",controller:"playbookItem.ctrl",scope:{playbook:"="},templateUrl:"common/ui/playbook-item/playbook-item.tpl.html",transclude:!0,replace:!0,compile:function(a,b,c){return{pre:function(a,b,c,d){},post:function(a,b,c,d){a.$element=b}}}}}]),impakt.common.ui.controller("playbookSelectDropdown.ctrl",["$scope",function(a){a.playbooks=impakt.context.Playbook.playbooks}]).directive("playbookSelectDropdown",[function(){return{restrict:"E",controller:"playbookSelectDropdown.ctrl",link:function(a,b,c){}}}]),impakt.common.ui.controller("popout.ctrl",["$scope","$timeout",function(a,b){a.$element,a.expandable,a.collection,a.filteredCollection,a.optionalType,a.query={text:""},a.searchVisible=!1,a.itemSelect=function(b){a.expandable.close(),a.select(b,a.optionalType)},a.toggle=function(c){a.filteredCollection&&a.filteredCollection.isEmpty()||(a.expandable.toggle(),a.searchVisible=!a.expandable.collapsed,a.searchVisible?b(function(){a.$element.find("input").focus()},1):a.query.text="")},a.close=function(){a.searchVisible=!1,a.expandable.close()},a.filterCollection=function(){if(Common.Utilities.isNotNullOrUndefined(a.filterBy)&&Common.Utilities.isNotNullOrUndefined(a.filterValue)){a.filter={},a.filter[a.filterBy]=a.filterValue;try{Common.Utilities.isNotNullOrUndefined(a.filter)&&Common.Utilities.isNotNullOrUndefined(a.collection)&&(a.filteredCollection=a.collection.filterCollection(a.filter))}catch(b){console.error(b)}}},a.setLabel=function(){}}]).directive("popout",["$rootScope","$filter","$timeout",function(a,b,c){return{restrict:"E",controller:"popout.ctrl",scope:{root:"=",label:"=",direction:"@",collapsed:"@?",url:"@",collection:"=",select:"=",type:"@",filterBy:"@",filterValue:"="},transclude:!0,replace:!0,templateUrl:"common/ui/popout/popout.tpl.html",link:function(b,d,e){b.$element=d,b.expandable=new Common.Models.Expandable(d),c(function(){b.optionalType=Common.Utilities.parseEnumFromString(b.type),b.expandable.url=b.url,b.expandable.direction=b.direction,b.expandable.collapsed=Boolean(b.collapsed)!==!1,b.expandable.expandable=!1,b.expandable.label=b.label,b.expandable.initializeToggleHandle(),b.expandable.ready=!0,b.filterCollection()},1),b.$element.click(function(a){a.stopPropagation()}),b.expandable.onopen(function(){a.$broadcast("popout-opened",b.expandable.guid),$("html").on("click.popout-clickeater",function(a){b.close(),b.$apply()}).on("keyup.popout-keyboard",function(a){a.keyCode==Common.Input.Which.Esc&&(b.close(),b.$apply()),a.keyCode==Common.Input.Which.Enter})}),b.expandable.onclose(function(){$("html").off("click.popout-clickeater").off("popout-keyboard"),b.searchVisible=!1}),a.$on("popout-opened",function(a,c){c!=b.expandable.guid&&b.close()}),b.$watch("root",function(a,c){a&&(c&&a.guid==c.guid||(b.expandable.label=b.label,b.filterCollection()))})}}}]).directive("popoutToggle",[function(){return{restrict:"E",controller:"popout.ctrl",require:"^popout",replace:!0,transclude:!0,templateUrl:"common/ui/popout/popout-toggle.tpl.html",link:function(a,b,c){Common.Utilities.isNotNullOrUndefined(a.expandable)&&a.expandable.initializeToggleHandle()}}}]).directive("popoutContents",[function(){return{restrict:"E",controller:"popout.ctrl",require:"^popout",scope:{collection:"="},link:function(a,b,c){}}}]).directive("popoutClickeater",[function(){return{restrict:"E",scope:!0,replace:!0,transclude:!0,templateUrl:"common/ui/popout/popout-clickeater.tpl.html",link:function(a,b,c){}}}]),impakt.common.ui.controller("practicePlanItem.ctrl",["$scope","$state","_details","_planning","_associations",function(a,b,c,d,e){a.practicePlan,a.element,a.toggleSelection=function(a){c.toggleSelection(a)},a.hoverIn=function(){Common.Utilities.isNullOrUndefined(a.practicePlan)||a.practicePlan.hoverIn()},a.hoverOut=function(){Common.Utilities.isNullOrUndefined(a.practicePlan)||a.practicePlan.hoverOut()},a.edit=function(){d.toPracticePlanEditor(a.practicePlan)}}]).directive("practicePlanItem",["_associations",function(a){return{restrict:"E",controller:"practicePlanItem.ctrl",scope:{practicePlan:"="},templateUrl:"common/ui/practice-plan-item/practice-plan-item.tpl.html",transclude:!0,replace:!0,compile:function(b,c,d){return{pre:function(a,b,c,d){},post:function(b,c,d,e){b.$element=c;var f=a.getAssociated(b.practicePlan);Common.Utilities.isNotNullOrUndefined(f)}}}}}]),impakt.common.ui.controller("quotes.ctrl",["$scope","$interval","_quotes",function(a,b,c){a.$element,a.quote=c.getRandomQuote(),b(function(){a.quote=c.getRandomQuote()},1e4)}]).directive("quotes",[function(){return{restrict:"E",templateUrl:"common/ui/quotes/quotes.tpl.html",transclude:!0,replace:!0,controller:"quotes.ctrl",link:function(a,b,c){a.$element=b}}}]),impakt.common.ui.quotes=angular.module("impakt.quotes",[]).config([function(){console.debug("impakt.quotes - config")}]).run([function(){console.debug("impakt.quotes - run")}]),impakt.common.ui.quotes.service("_quotes",[function(){var a=[new Common.Models.Quote("It's not whether you get knocked down; 			it's whether you get back up.","Vince Lombardi"),new Common.Models.Quote("Winning isn't everything...it's the only thing.","Vince Lombardi"),new Common.Models.Quote("The essence of football was blocking, tackling, 			and execution based on timing, rhythm and deception.","Knute Rockne"),new Common.Models.Quote("It's not the will to win, but the will to prepare 			to win that makes the difference.","Bear Bryant"),new Common.Models.Quote("We love football.","Impakt Athletics"),new Common.Models.Quote("Football doesn't build character. It eliminates weak ones.","Darrell Royal"),new Common.Models.Quote("Football is like life. It requires perseverance, self denial 			hard work, sacrifice, dedication, and respect for authority.","Vince Lombardi"),new Common.Models.Quote("If tomorrow wasn't promised, what would you give for today?","Ray Lewis"),new Common.Models.Quote("I'm just here so I don't get fined.","Marshawn Lynch"),new Common.Models.Quote("I wish I knew about [Impakt] 10 years ago, I wouldn't have so much damn gray hair now!","Coach, USC"),new Common.Models.Quote("To me, this is a no brainer.","Oregon"),new Common.Models.Quote("People are going to love this","Harvard"),new Common.Models.Quote("This is really damn cool. I know I want it.","Arizona"),new Common.Models.Quote("This is awesome. It fits perfectly with what we're trying to do.","Michigan"),new Common.Models.Quote("This is really slick. I think the way you guys approached this was brilliant.","Dallas Cowboys")];this.getRandomQuote=function(){var b=Common.Utilities.randomInt(0,a.length-1);return a[b]}}]),impakt.common.ui.factory("__router",[function(){var a={templates:{},size:0,index:0,current:function(){return a.hasTemplates()?a.templates[a.index]:null},get:function(b,c){return a.templates[b].filterFirst(function(a,b){return c==a.name})},add:function(b,c){a.templates[b]||(a.templates[b]=new Common.Models.TemplateCollection(b),a.size++),a.templates[b].add(c)},push:function(b,c){for(var d=0;d<c.length;d++)a.add(b,c[d])},next:function(){var b=a.index;a.hasTemplates()&&(a.index=a.hasNextTemplate()?a.index+1:0),console.log("next layer:",b,"->",a.index,a.templates)},prev:function(){a.hasTemplates()&&(a.index=a.hasPrevTemplate()?a.index-1:a.size-1)},to:function(b){a.hasTemplates()&&b>=0&&b<a.size-1&&(a.index=b)},hasTemplates:function(){return a.templates&&a.size>0},hasNextTemplate:function(){return a.index<a.size-1},hasPrevTemplate:function(){return a.index>0}};return a}]),impakt.common.ui.controller("scenarioItem.ctrl",["$scope","_details","_playbook",function(a,b,c){a.scenario,a.element,a.toggleSelection=function(a){b.toggleSelection(a)},a.openInEditor=function(a){c.editScenario(a)}}]).directive("scenarioItem",[function(){return{restrict:"E",controller:"scenarioItem.ctrl",scope:{scenario:"="},templateUrl:"common/ui/scenario-item/scenario-item.tpl.html",transclude:!0,replace:!0,compile:function(a,b,c){return{pre:function(a,b,c,d){},post:function(a,b,c,d){a.$element=b}}}}}]),impakt.common.ui.controller("scenarioPreview.ctrl",["$scope","$timeout",function(a,b){
a.previewCanvas,a.scenario,a.$element,a.isModified=!0,a.modificationTimer,a.refresh=function(){if(!a.scenario)throw new Error("scenario-preview refresh(): Play is null or undefined");if(!a.previewCanvas)throw new Error("scenario-preview refresh(): PreviewCanvas is null or undefined");if(!a.$element)throw new Error("scenario-preview refresh(): $element is null or undefined");a.$element.find("svg").show(),a.previewCanvas.field.updateScenario(a.scenario),a.scenario.png=a.previewCanvas.exportToPng(),a.isModified=!1;var c=a.previewCanvas.field.getLOSAbsolute()-a.$element.height()/2;a.$element.scrollTop(c),a.modificationTimer&&b.cancel(a.modificationTimer)}}]).directive("scenarioPreview",["$timeout","_associations",function(a,b){return{restrict:"E",controller:"scenarioPreview.ctrl",scope:{scenario:"="},compile:function(b,c,d){return{pre:function(a,b,c,d){},post:function(b,c,d,e){if(b.$element=c,!Common.Utilities.isNotNullOrUndefined(b.scenario))throw new Error("scenario-preview link(): Unable to find scenario");b.previewCanvas=new Playbook.Models.PreviewCanvas,b.scenario.onModified(function(){b.isModified=!0,b.modificationTimer&&a.cancel(b.modificationTimer),b.modificationTimer=a(function(){console.log("auto refresh based on user changes"),b.refresh()},200)}),a(function(){b.previewCanvas&&(b.previewCanvas.setListener("onready",function(){var a=b.previewCanvas.field.getLOSAbsolute()-b.$element.height()/2;b.$element.scrollTop(a)}),b.previewCanvas.initialize(c),b.previewCanvas.field.updateScenario(b.scenario),b.scenario.png=b.previewCanvas.exportToPng())},0)}}}}}]),impakt.common.ui.service("_scenarioPreview",[function(){this.viewBox="",this.setViewBox=function(a,b,c,d){this.viewBox=[a," ",b," ",c," ",d].join("")},this.compress=function(a){return Common.Utilities.compressSVG(a)},this.decompress=function(a){return Common.Utilities.decompressSVG(a)}}]),impakt.common.ui.controller("scenarioThumbnail.ctrl",["$scope",function(a){a.scenario}]).directive("scenarioThumbnail",[function(){return{restrict:"E",controller:"scenarioThumbnail.ctrl",scope:{scenario:"="},compile:function(a,b,c){return{pre:function(a,b,c,d){},post:function(a,b,c,d){a.$element=b;var e=b.height(),f=document.createElement("img");f.src=a.scenario.png;var g=$(f);a.$element.append(g),f.addEventListener("load",function(){var a=g.height(),b=-(.5*a)+e/2+"px";g.css({top:b})},!1)}}}}}]),impakt.common.ui.controller("scoutCardItem.ctrl",["$scope","$state","_details","_planning","_associations",function(a,b,c,d,e){a.scoutCard,a.element,a.toggleSelection=function(a){c.toggleSelection(a)},a.hoverIn=function(){Common.Utilities.isNullOrUndefined(a.scoutCard)||a.scoutCard.hoverIn()},a.hoverOut=function(){Common.Utilities.isNullOrUndefined(a.scoutCard)||a.scoutCard.hoverOut()},a.edit=function(){d.toScoutCardEditor(a.scoutCard)}}]).directive("scoutCardItem",["_associations",function(a){return{restrict:"E",controller:"scoutCardItem.ctrl",scope:{scoutCard:"="},templateUrl:"common/ui/scout-card-item/scout-card-item.tpl.html",transclude:!0,replace:!0,compile:function(b,c,d){return{pre:function(a,b,c,d){},post:function(b,c,d,e){b.$element=c;var f=a.getAssociated(b.scoutCard);Common.Utilities.isNotNullOrUndefined(f)}}}}}]),impakt.common.ui.directive("search",[function(){return{restrict:"E",templateUrl:"common/ui/search/search.tpl.html",transclude:!0,replace:!0,link:function(a,b,c){}}}]),impakt.common.ui.controller("seasonItem.ctrl",["$scope","$state","_details","_season","_associations",function(a,b,c,d,e){a.season,a.element,a.toggleSelection=function(a){b.is("season.drilldown.season")?c.toggleSelection(a):(c.selectedElements.deselectAll(),d.toSeasonDrilldown(a))}}]).directive("seasonItem",["_associations",function(a){return{restrict:"E",controller:"seasonItem.ctrl",scope:{season:"="},templateUrl:"common/ui/season-item/season-item.tpl.html",transclude:!0,replace:!0,compile:function(b,c,d){return{pre:function(a,b,c,d){},post:function(b,c,d,e){b.$element=c;var f=a.getAssociated(b.season);Common.Utilities.isNotNullOrUndefined(f)}}}}}]),impakt.common.ui.controller("stepper.ctrl",["$scope",function(a){console.info("stepper directive controller"),a.index=0,a.steps=[],a.$element=null,a.to=function(b){$(a.$element.find("step")[b]).show(),$(a.$element.find("step")[a.index]).hide(),a.index=b},a.prev=function(){a.index-1>=0&&a.to(a.index-1)},a.next=function(){a.index+1<a.steps.length&&a.to(a.index+1)},a.isVisible=function(){return!0}}]).directive("stepper",["$compile",function(a){return{restrict:"E",controller:"stepper.ctrl",compile:function(b,c,d){return{pre:function(a,b,c,d){},post:function(b,c,d,e){var f=(d.mode,'<step-nav>									<step-nav-item ng-repeat="step in steps track by $index" 										class="gray-bg-7-hover"										ng-click="to($index)">										{{$index + 1}}									</step-nav-item>								</step-nav>');angular.element(a(f)(b));b.$element=c}}}}}]).directive("step",["$compile",function(a){return{restrict:"E",compile:function(a,b,c){return{pre:function(a,b,c,d){var e=Common.Utilities.guid();b.attr("guid",e);var f=a.steps.length,g={guid:e,visible:!1,index:f};a.steps.push(g),0!=f&&b.hide()},post:function(a,b,c,d){}}}}}]).directive("stepNav",[function(){return{restrict:"E",compile:function(a,b,c){return{pre:function(a,b,c,d){},post:function(a,b,c,d){}}}}}]).directive("stepNavItem",[function(){return{restrict:"E",compile:function(a,b,c){return{pre:function(a,b,c,d){},post:function(a,b,c,d){}}}}}]),impakt.common.ui.directive("camelCaseToSpace",[function(){return{restrict:"A",scope:{string:"@",capitalize:"@"},link:function(a,b,c){a.string&&(a.capitalize=Boolean(a.capitalize),a.string=Common.Utilities.camelCaseToSpace(a.string,a.capitalize),b.html(a.string))}}}]),impakt.common.ui.controller("teamItem.ctrl",["$scope","$state","_details","_league","_associations",function(a,b,c,d,e){a.team,a.element,a.getConference=function(a){return Common.Utilities.isNotNullOrUndefined(a)&&Common.Utilities.isNotNullOrUndefined(a.division)?a.division.name:"No division"},a.toggleSelection=function(a){b.is("league.drilldown.team")?c.toggleSelection(a):(c.selectedElements.deselectAll(),d.toTeamDrilldown(a))}}]).directive("teamItem",["_associations",function(a){return{restrict:"E",controller:"teamItem.ctrl",scope:{team:"="},templateUrl:"common/ui/team-item/team-item.tpl.html",transclude:!0,replace:!0,compile:function(b,c,d){return{pre:function(a,b,c,d){},post:function(b,c,d,e){b.$element=c;var f=a.getAssociated(b.team);Common.Utilities.isNotNullOrUndefined(f)&&f.divisions.hasElements()&&b.team.setDivision(f.divisions.first())}}}}}]),impakt.common.ui.controller("weekItem.ctrl",["$scope","$state","_details","_season","_associations",function(a,b,c,d,e){a.week,a.season,a.element,a.toggleSelection=function(a){b.is("season.drilldown.week")?c.toggleSelection(a):(c.selectedElements.deselectAll(),d.toWeekDrilldown(a))}}]).directive("weekItem",["_associations",function(a){return{restrict:"E",controller:"weekItem.ctrl",scope:{week:"="},templateUrl:"common/ui/week-item/week-item.tpl.html",transclude:!0,replace:!0,compile:function(a,b,c){return{pre:function(a,b,c,d){},post:function(a,b,c,d){a.$element=b}}}}}]),impakt.modules=angular.module("impakt.modules",["impakt.main","impakt.home","impakt.league","impakt.season","impakt.planning","impakt.analysis","impakt.playbook","impakt.nav","impakt.user","impakt.search","impakt.team","impakt.sidebar","impakt.details"]).config(["$stateProvider","$urlRouterProvider",function(a,b){console.debug("impakt.modules - config")}]).run(function(){console.debug("impakt.modules - run")}),impakt.analysis=angular.module("impakt.analysis",[]).config([function(){console.debug("impakt.analysis - config")}]).run([function(){console.debug("impakt.analysis - run")}]),impakt.details=angular.module("impakt.details",[]).config(function(){console.debug("impakt.details - config")}).run(function(){console.debug("impakt.details - run")}),impakt.details.controller("details.ctrl",["$scope","$rootScope","$q","$timeout","__context","__modals","_details","_associations",function(a,b,c,d,e,f,g,h){function i(){a.selectedElements.hasListeners()||a.selectedElements.onModified(function(b){Common.Utilities.isNotNullOrUndefined(a.expandable)&&(a.selectedElements.isEmpty()?!a.expandable.collapsed&&a.expandable.close():a.expandable.collapsed&&a.expandable.open()),j()}),j()}function j(){Common.Utilities.isNullOrUndefined(a.selectedElements)||a.selectedElements.isEmpty()||(a.selectedElement=a.selectedElements.first(),Common.Utilities.isNotNullOrUndefined(a.selectedElement)&&(a.associations=h.getAssociated(a.selectedElement),Common.Utilities.isNotNullOrUndefined(a.associations)&&(a.populatedAssociationKeys=a.associations.getPopulatedAssociationKeys())))}a.expandable=a.expandable,a.selectedElements=g.selectedElements,a.selectedElement=null,a.associations=new Common.Models.AssociationResults,a.populatedAssociationKeys=[],a.playbooks,a._details=g,a.collapsed=Common.Utilities.isNotNullOrUndefined(a.expandable)?a.expandable.collapsed:!0;var k=!1;e.onReady(function(){a.playbooks=impakt.context.Playbook.playbooks});var l=b.$on("create-entity",function(a,b){k=!1,i()}),m=b.$on("associations-updated",function(a){i()});a.$on("$destroy",function(){a.selectedElements.clearListeners(),l(),m()}),a["delete"]=function(b){g["delete"](b).then(function(){j(),a.selectedElements.remove(a.selectedElement.guid)})},a.update=function(a){g.update(a).then(function(){})},i()}]),impakt.details.service("_details",["$q","_league","_playbook","_team","_season","_planning",function(a,b,c,d,e,f){this.selectedElements=impakt.context.Actionable.selected,this.state={collapsed:!0};var g=this;this.selectedElements.onModified(function(a){a.hasElements()&&(g.state.collapsed=!1)}),this.toggleSelection=function(a){this.selectedElements.deselectAll(),this.selectedElements.contains(a.guid)?this.selectedElements.empty():(a.select(),this.selectedElements.only(a))},this.updatePlay=function(a){c.updatePlay(a)},this["delete"]=function(a){switch(a.impaktDataType){case Common.Enums.ImpaktDataTypes.Play:case Common.Enums.ImpaktDataTypes.Formation:case Common.Enums.ImpaktDataTypes.AssignmentGroup:case Common.Enums.ImpaktDataTypes.Scenario:case Common.Enums.ImpaktDataTypes.Playbook:return c.deleteEntityByType(a);case Common.Enums.ImpaktDataTypes.Conference:case Common.Enums.ImpaktDataTypes.League:case Common.Enums.ImpaktDataTypes.Division:case Common.Enums.ImpaktDataTypes.Location:return b.deleteEntityByType(a);case Common.Enums.ImpaktDataTypes.Team:case Common.Enums.ImpaktDataTypes.PersonnelGroup:return d.deleteEntityByType(a);case Common.Enums.ImpaktDataTypes.Season:case Common.Enums.ImpaktDataTypes.Game:return e.deleteEntityByType(a);case Common.Enums.ImpaktDataTypes.Plan:case Common.Enums.ImpaktDataTypes.PracticePlan:case Common.Enums.ImpaktDataTypes.PracticeSchedule:case Common.Enums.ImpaktDataTypes.GamePlan:case Common.Enums.ImpaktDataTypes.ScoutCard:case Common.Enums.ImpaktDataTypes.QBWristband:return f.deleteEntityByType(a);default:throw new Error("_details delete(): entity ImpaktDataType not supported "+a.impaktDataType)}},this.update=function(a){switch(a.impaktDataType){case Common.Enums.ImpaktDataTypes.Play:case Common.Enums.ImpaktDataTypes.Formation:case Common.Enums.ImpaktDataTypes.AssignmentGroup:case Common.Enums.ImpaktDataTypes.Scenario:case Common.Enums.ImpaktDataTypes.Playbook:return c.updateEntityByType(a);case Common.Enums.ImpaktDataTypes.Conference:case Common.Enums.ImpaktDataTypes.League:case Common.Enums.ImpaktDataTypes.Division:case Common.Enums.ImpaktDataTypes.Location:return b.updateEntityByType(a);case Common.Enums.ImpaktDataTypes.Team:case Common.Enums.ImpaktDataTypes.PersonnelGroup:return d.updateEntityByType(a);case Common.Enums.ImpaktDataTypes.Season:case Common.Enums.ImpaktDataTypes.Game:return e.updateEntityByType(a);case Common.Enums.ImpaktDataTypes.Plan:case Common.Enums.ImpaktDataTypes.PracticePlan:case Common.Enums.ImpaktDataTypes.PracticeSchedule:case Common.Enums.ImpaktDataTypes.GamePlan:case Common.Enums.ImpaktDataTypes.ScoutCard:case Common.Enums.ImpaktDataTypes.QBWristband:return f.updateEntityByType(a);default:throw new Error("_details update(): entity ImpaktDataType not supported "+a.impaktDataType)}}}]),impakt.home=angular.module("impakt.home",[]).config([function(){console.debug("impakt.home - config")}]).run(function(){console.debug("impakt.home - run")}),impakt.home.controller("home.ctrl",["$scope","$state","__context","_home",function(a,b,c,d){a.currentOrganization,a.menuItems=d.menuItems,a.goTo=function(b){a.menuItems.activate(b)},c.onReady(function(){a.currentOrganization=impakt.context.Organization.current})}]),impakt.home.service("_home",["$state","__nav",function(a,b){this.menuItems=b.menuItems}]),impakt.league=angular.module("impakt.league",["impakt.league.browser","impakt.league.drilldown","impakt.league.modals"]).config(["$stateProvider","$urlRouterProvider",function(a,b){console.debug("impakt.league - config"),a.state("league",{url:"/league",templateUrl:"modules/league/league.tpl.html",controller:"league.ctrl"})}]).run(function(){console.debug("impakt.league - run")}),impakt.league.browser=angular.module("impakt.league.browser",[]).config(["$stateProvider",function(a){console.debug("impakt.league.browser - config"),a.state("league.browser",{url:"/browser",templateUrl:"modules/league/browser/league-browser.tpl.html",controller:"league.browser.ctrl"})}]).run(function(){console.debug("impakt.league.browser - run")}),impakt.league.browser.controller("league.browser.ctrl",["$scope","_league","_leagueModals","_teamModals",function(a,b,c,d){a.leagues=impakt.context.League.leagues,a.teams=impakt.context.Team.teams,a.conferences=impakt.context.League.conferences,a.createLeague=function(){c.createLeague()},a.createTeam=function(){d.createTeam()},a.teamDrilldown=function(a){b.toTeamDrilldown(a)}}]),impakt.league.drilldown=angular.module("impakt.league.drilldown",["impakt.league.drilldown.league","impakt.league.drilldown.conference","impakt.league.drilldown.division","impakt.league.drilldown.team"]).config(["$stateProvider",function(a){console.debug("impakt.league.drilldown - config"),a.state("league.drilldown",{url:"/drilldown",templateUrl:"modules/league/drilldown/league-drilldown.tpl.html",controller:"league.drilldown.ctrl"})}]).run(function(){console.debug("impakt.league.drilldown - run")}),impakt.league.drilldown.conference=angular.module("impakt.league.drilldown.conference",[]).config(["$stateProvider",function(a){console.debug("impakt.league.drilldown.conference - config"),a.state("league.drilldown.conference",{url:"/conference",templateUrl:"modules/league/drilldown/conference/league-drilldown-conference.tpl.html",controller:"league.drilldown.conference.ctrl"})}]).run(function(){console.debug("impakt.league.drilldown.conference - run")}),impakt.league.drilldown.conference.controller("league.drilldown.conference.ctrl",["$scope","$rootScope","_associations","_league","_leagueModals","_teamModals",function(a,b,c,d,e,f){function g(){var b=c.getAssociated(a.conference);a.conference.setLeague(a.league),Common.Utilities.isNotNullOrUndefined(b)&&(a.divisions=b.divisions,a.divisions.forEach(function(b,d){c.getAssociated(b);b.setConference(a.conference)}))}a.league=d.drilldown.league,a.conference=d.drilldown.conference,a.divisions=new League.Models.DivisionCollection;var h=b.$on("delete-division",function(b,c){a.divisions.remove(c.guid)}),i=b.$on("associations-updated",function(a){g()});a.$on("$destroy",function(){h(),i()}),a.createDivision=function(a){e.createDivision(a).then(function(){g()})},a.toDivisionDrilldown=function(a){d.toDivisionDrilldown(a)},g()}]),impakt.league.drilldown.division=angular.module("impakt.league.drilldown.division",[]).config(["$stateProvider",function(a){console.debug("impakt.league.drilldown.division - config"),a.state("league.drilldown.division",{url:"/division",templateUrl:"modules/league/drilldown/division/league-drilldown-division.tpl.html",controller:"league.drilldown.division.ctrl"})}]).run(function(){console.debug("impakt.league.drilldown.division - run")}),impakt.league.drilldown.division.controller("league.drilldown.division.ctrl",["$scope","$rootScope","_associations","_league","_leagueModals","_teamModals",function(a,b,c,d,e,f){function g(){var b=c.getAssociated(a.division);a.division.setConference(a.conference),Common.Utilities.isNotNullOrUndefined(b)&&(a.teams=b.teams,a.teams.forEach(function(b,d){c.getAssociated(b);b.setDivision(a.division)}))}a.league=d.drilldown.league,a.conference=d.drilldown.conference,a.division=d.drilldown.division,a.teams=new Team.Models.TeamModelCollection;var h=b.$on("delete-team",function(b,c){a.teams.remove(c.guid)}),i=b.$on("associations-updated",function(a){g()});a.$on("$destroy",function(){i(),h()}),a.createTeam=function(a){f.createTeam(a).then(function(){g()})},g()}]),impakt.league.drilldown.controller("league.drilldown.ctrl",["$scope","_details","_league",function(a,b,c){a.drilldown=c.drilldown,a.toLeagueDrilldown=function(a){c.toLeagueDrilldown(a)},a.toConferenceDrilldown=function(a){c.toConferenceDrilldown(a)},a.toDivisionDrilldown=function(a){c.toDivisionDrilldown(a)},a.toTeamDrilldown=function(a){c.toTeamDrilldown(a)},a.toBrowser=function(){b.selectedElements.deselectAll(),c.toBrowser()}}]),impakt.league.drilldown.league=angular.module("impakt.league.drilldown.league",[]).config(["$stateProvider",function(a){console.debug("impakt.league.drilldown.league - config"),a.state("league.drilldown.league",{url:"/league",templateUrl:"modules/league/drilldown/league/league-drilldown-league.tpl.html",controller:"league.drilldown.league.ctrl"})}]).run(function(){console.debug("impakt.league.drilldown.league - run")}),impakt.league.drilldown.league.controller("league.drilldown.league.ctrl",["$scope","$rootScope","_associations","_league","_leagueModals",function(a,b,c,d,e){function f(){var b=c.getAssociated(a.league);Common.Utilities.isNotNullOrUndefined(b)&&(a.conferences=b.conferences,a.conferences.forEach(function(b,d){c.getAssociated(b);b.setLeague(a.league)}))}a.league=d.drilldown.league,a.conferences=new League.Models.ConferenceCollection;var g=b.$on("delete-conference",function(b,c){a.conferences.remove(c.guid)}),h=b.$on("associations-updated",function(a){f()});a.$on("$destroy",function(){g(),h()}),a.createConference=function(){e.createConference(a.league).then(function(){f()})},f()}]),impakt.league.drilldown.team=angular.module("impakt.league.drilldown.team",[]).config(["$stateProvider",function(a){console.debug("impakt.league.drilldown.team - config"),a.state("league.drilldown.team",{url:"/team",templateUrl:"modules/league/drilldown/team/league-drilldown-team.tpl.html",controller:"league.drilldown.team.ctrl"})}]).run(function(){console.debug("impakt.league.drilldown.team - run")}),impakt.league.drilldown.team.controller("league.drilldown.team.ctrl",["$scope","_league","_teamModals",function(a,b,c){a.team=b.drilldown.team,a.conferences=impakt.context.League.conferences,a["delete"]=function(){c.deleteTeam(a.team)}}]),impakt.league.constant("LEAGUE",{ENDPOINT:"/teamInfo",GENERAL_ENDPOINT:"/general",CREATE_LEAGUE:"/createLeague",GET_LEAGUES:"/getLeagues",GET_LEAGUE:"/getLeague",DELETE_LEAGUE:"/deleteLeague",CREATE_TEAM:"/createTeam",GET_TEAMS:"/getTeams",GET_TEAM:"/getTeam",DELETE_TEAM:"/deleteTeam",CREATE_CONFERENCE:"/createConference",GET_CONFERENCES:"/getConferences",GET_CONFERENCE:"/getConference",DELETE_CONFERENCE:"/deleteConference",UPDATE_CONFERENCE:"/updateConference",CREATE_DIVISION:"/createDivision",GET_DIVISIONS:"/getDivisions",GET_DIVISION:"/getDivision",DELETE_DIVISION:"/deleteDivision",UPDATE_DIVISION:"/updateDivision",CREATE_LOCATION:"/createLocation",GET_LOCATIONS:"/getLocations",GET_LOCATION:"/getLocation",DELETE_LOCATION:"/deleteLocation",UPDATE_LOCATION:"/updateLocation"}),impakt.league.controller("league.ctrl",["$scope","$state","_league",function(a,b,c){b.go("league.browser")}]),impakt.league.service("_league",["LEAGUE","$rootScope","$q","$state","__api","__localStorage","__notifications","_leagueModals",function(a,b,c,d,e,f,g,h){function i(a,b,c,d){a&&impakt.context.League.leagues.deselectAll(),b&&impakt.context.League.conferences.deselectAll(),c&&impakt.context.League.divisions.deselectAll(),d&&impakt.context.Team.teams.deselectAll()}var j=this;this.drilldown={league:null,conference:null,division:null,team:null},this.getLeagues=function(){var b=c.defer(),d=g.pending("Getting leagues...");return e.get(e.path(a.ENDPOINT,a.GET_LEAGUES)).then(function(a){var c=new League.Models.LeagueModelCollection;if(a&&a.data&&a.data.results)for(var e=Common.Utilities.parseData(a.data.results),f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.model){var h=new League.Models.LeagueModel;g.data.model.key=g.key,h.fromJson(g.data.model),c.add(h,!1)}}d.success([c.size()," Leagues successfully retreived"].join("")),b.resolve(c)},function(a){d.error("Failed to retieve Leagues"),console.error(a),b.reject(a)}),b.promise},this.getLeague=function(b){var d=c.defer();return e.get(e.path(a.ENDPOINT,a.GET_LEAGUE,"/"+b)).then(function(a){var b=Common.Utilities.parseData(a.data.results);d.resolve(b)},function(a){d.reject(a)}),d.promise},this.createLeague=function(d){var f=c.defer();if(Common.Utilities.isNotNullOrUndefined(d)){var i=impakt.context.League.leagues.hasElementWhich(function(a,b){return a.name==d.name});if(i){g.warning('Failed to create league. League "',d.name,'" already exists.');return void h.createLeagueDuplicate(d)}}d.key=-1;var j=d.toJson(),k=g.pending('Creating league "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_LEAGUE),{version:1,name:d.name,data:{version:1,model:j}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),d=new League.Models.LeagueModel;if(!(c&&c.data&&c.data.model))throw new Error("CreateLeague did not return a valid league model");c.data.model.key=c.key,d.fromJson(c.data.model),impakt.context.League.leagues.add(d,!1),k.success('Successfully created league "',d.name,'"'),b.$broadcast("create-entity",d),f.resolve(d)},function(a){k.error('Failed to create league "',d.name,'"'),f.reject(a)}),f.promise},this.deleteLeague=function(b){var f=c.defer(),h=g.pending('Deleting league "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_LEAGUE),{key:b.key}).then(function(a){impakt.context.League.leagues.remove(b.guid),h.success('Deleted league "',b.name,'"'),d.is("league.drilldown.league")&&j.toBrowser(),f.resolve(b)},function(a){h.error('Failed to delete league "',b.name,'"'),f.reject(a)}),f.promise},this.updateLeague=function(b){var d=c.defer(),f=b.toJson(),h=g.pending('Updating league "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.UPDATE_LEAGUE),{version:1,name:f.name,key:f.key,data:{version:1,key:f.key,model:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=new League.Models.LeagueModel;c&&c.data&&c.data.model&&(e.fromJson(c.data.model),impakt.context.League.leagues.set(e.guid,e)),h.success('Successfully updated league "',b.name,'"'),d.resolve(e)},function(a){h.error('Failed to update league "',b.name,'"'),d.reject(a)}),d.promise},this.getConferences=function(){var b=c.defer(),d=g.pending("Getting conferences...");return e.get(e.path(a.ENDPOINT,a.GET_CONFERENCES)).then(function(a){var c=new League.Models.ConferenceCollection;if(a&&a.data&&a.data.results)for(var e=Common.Utilities.parseData(a.data.results),f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.conference){var h=new League.Models.Conference;g.data.conference.key=g.key,h.fromJson(g.data.conference),c.add(h,!1)}}d.success([c.size()," Conferences successfully retreived"].join("")),b.resolve(c)},function(a){d.error("Failed to retieve Conferences"),console.error(a),b.reject(a)}),b.promise},this.getConference=function(b){var d=c.defer();return e.get(e.path(a.ENDPOINT,a.GET_CONFERENCE,"/"+b)).then(function(a){var b=Common.Utilities.parseData(a.data.results);d.resolve(b)},function(a){d.reject(a)}),d.promise},this.createConference=function(d){var f=c.defer();if(Common.Utilities.isNotNullOrUndefined(d)){var i=impakt.context.League.conferences.hasElementWhich(function(a,b){return a.name==d.name});if(i){g.warning('Failed to create conference. Conference "',d.name,'" already exists.');return void h.createConferenceDuplicate(d)}}d.key=-1;var j=d.toJson(),k=g.pending('Creating conference "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_CONFERENCE),{version:1,name:d.name,data:{version:1,conference:j}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),d=new League.Models.Conference;if(!(c&&c.data&&c.data.conference))throw new Error("CreateConference did not return a valid conference");c.data.conference.key=c.key,d.fromJson(c.data.conference),impakt.context.League.conferences.add(d,!1),k.success('Successfully created conference "',d.name,'"'),b.$broadcast("create-entity",d),f.resolve(d)},function(a){k.error('Failed to create conference "',d.name,'"'),f.reject(a)}),f.promise},this.deleteConference=function(b){var d=c.defer(),f=g.pending('Deleting conference "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_CONFERENCE),{key:b.key}).then(function(a){impakt.context.League.conferences.remove(b.guid),f.success('Deleted conference "',b.name,'"'),d.resolve(b)},function(a){f.error('Failed to delete conference "',b.name,'"'),d.reject(a)}),d.promise},this.updateConference=function(b){var d=c.defer(),f=b.toJson(),h=g.pending('Updating conference "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.UPDATE_CONFERENCE),{version:1,name:f.name,key:f.key,data:{version:1,key:f.key,conference:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=new League.Models.Conference;c&&c.data&&c.data.conference&&(e.fromJson(c.data.conference),impakt.context.League.conferences.set(e.guid,e)),h.success('Successfully updated conference "',b.name,'"'),d.resolve(e)},function(a){h.error('Failed to update conference "',b.name,'"'),d.reject(a)}),d.promise},this.getDivisions=function(){var b=c.defer(),d=g.pending("Getting divisions...");return e.get(e.path(a.ENDPOINT,a.GET_DIVISIONS)).then(function(a){var c=new League.Models.DivisionCollection;if(a&&a.data&&a.data.results)for(var e=Common.Utilities.parseData(a.data.results),f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.division){var h=new League.Models.Division;g.data.division.key=g.key,h.fromJson(g.data.division),c.add(h,!1)}}d.success([c.size()," Divisions successfully retreived"].join("")),b.resolve(c)},function(a){d.error("Failed to retieve Divisions"),console.error(a),b.reject(a)}),b.promise},this.getDivision=function(b){var d=c.defer();return e.get(e.path(a.ENDPOINT,a.GET_DIVISION,"/"+b)).then(function(a){var b=Common.Utilities.parseData(a.data.results);d.resolve(b)},function(a){d.reject(a)}),d.promise},this.createDivision=function(d){var f=c.defer();if(Common.Utilities.isNotNullOrUndefined(d)){var i=impakt.context.League.divisions.hasElementWhich(function(a,b){return a.name==d.name});if(i){g.warning('Failed to create division. Division "',d.name,'" already exists.');return void h.createDivisionDuplicate(d)}}d.key=-1;var j=d.toJson(),k=g.pending('Creating division "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_DIVISION),{version:1,name:d.name,data:{version:1,division:j}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),d=new League.Models.Division;if(!(c&&c.data&&c.data.division))throw new Error("CreateDivision did not return a valid division");c.data.division.key=c.key,d.fromJson(c.data.division),impakt.context.League.divisions.add(d,!1),k.success('Successfully created division "',d.name,'"'),b.$broadcast("create-entity",d),f.resolve(d)},function(a){k.error('Failed to create division "',d.name,'"'),f.reject(a)}),f.promise},this.deleteDivision=function(b){var d=c.defer(),f=g.pending('Deleting division "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_DIVISION),{key:b.key}).then(function(a){impakt.context.League.divisions.remove(b.guid),f.success('Deleted division "',b.name,'"'),d.resolve(b)},function(a){f.error('Failed to delete division "',b.name,'"'),d.reject(a)}),d.promise},this.updateDivision=function(b){var d=c.defer(),f=b.toJson(),h=g.pending('Updating division "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.UPDATE_DIVISION),{version:1,name:f.name,key:f.key,data:{version:1,key:f.key,division:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=new League.Models.Division;c&&c.data&&c.data.division&&(e.fromJson(c.data.division),impakt.context.League.divisions.set(e.guid,e)),h.success('Successfully updated division "',b.name,'"'),d.resolve(e)},function(a){h.error('Failed to update division "',b.name,'"'),d.reject(a)}),d.promise},this.getLocations=function(){var b=c.defer(),d=g.pending("Getting locations...");return e.get(e.path(a.GENERAL_ENDPOINT,a.GET_LOCATIONS)).then(function(a){var c=new League.Models.LocationCollection;if(a&&a.data&&a.data.results)for(var e=Common.Utilities.parseData(a.data.results),f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.location){var h=new League.Models.Location;g.data.location.key=g.key,h.fromJson(g.data.location),c.add(h,!1)}}d.success([c.size()," Locations successfully retreived"].join("")),b.resolve(c)},function(a){d.error("Failed to retieve Locations"),console.error(a),b.reject(a)}),b.promise},this.getLocation=function(b){var d=c.defer();return e.get(e.path(a.GENERAL_ENDPOINT,a.GET_LOCATION,"/"+b)).then(function(a){var b=Common.Utilities.parseData(a.data.results);d.resolve(b)},function(a){d.reject(a)}),d.promise},this.createLocation=function(d){var f=c.defer();if(Common.Utilities.isNotNullOrUndefined(d)){var i=impakt.context.League.locations.hasElementWhich(function(a,b){return a.name==d.name});if(i){g.warning('Failed to create location. Location "',d.name,'" already exists.');return void h.createLocationDuplicate(d)}}d.key=-1;var j=d.toJson(),k=g.pending('Creating location "',d.name,'"...');return e.post(e.path(a.GENERAL_ENDPOINT,a.CREATE_LOCATION),{version:1,name:d.name,data:{version:1,location:j}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),d=new League.Models.Location;if(!(c&&c.data&&c.data.location))throw new Error("CreateLocation did not return a valid location");c.data.location.key=c.key,d.fromJson(c.data.location),impakt.context.League.locations.add(d,!1),k.success('Successfully created location "',d.name,'"'),b.$broadcast("create-entity",d),f.resolve(d)},function(a){k.error('Failed to create location "',d.name,'"'),f.reject(a)}),f.promise},this.deleteLocation=function(b){var d=c.defer(),f=g.pending('Deleting location "',b.name,'"...');return e.post(e.path(a.GENERAL_ENDPOINT,a.DELETE_LOCATION),{key:b.key}).then(function(a){impakt.context.League.locations.remove(b.guid),f.success('Deleted location "',b.name,'"'),d.resolve(b)},function(a){f.error('Failed to delete location "',b.name,'"'),d.reject(a)}),d.promise},this.updateLocation=function(b){var d=c.defer(),f=b.toJson(),h=g.pending('Updating location "',b.name,'"...');return e.post(e.path(a.GENERAL_ENDPOINT,a.UPDATE_LOCATION),{version:1,name:f.name,key:f.key,data:{version:1,key:f.key,location:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=new League.Models.Location;c&&c.data&&c.data.location&&(e.fromJson(c.data.location),impakt.context.League.locations.set(e.guid,e)),h.success('Successfully updated location "',b.name,'"'),d.resolve(e)},function(a){h.error('Failed to update location "',b.name,'"'),d.reject(a)}),d.promise},this.deleteEntityByType=function(a){if(!Common.Utilities.isNullOrUndefined(a)){var b=c.defer();switch(a.impaktDataType){case Common.Enums.ImpaktDataTypes.League:return h.deleteLeague(a);case Common.Enums.ImpaktDataTypes.Conference:return h.deleteConference(a);case Common.Enums.ImpaktDataTypes.Division:return h.deleteDivision(a);default:b.reject(new Error("_league deleteEntityByType: impaktDataType not supported"))}return b.promise}},this.updateEntityByType=function(a){if(!Common.Utilities.isNullOrUndefined(a)){
var b=c.defer();switch(a.impaktDataType){case Common.Enums.ImpaktDataTypes.League:return h.saveLeague(a);case Common.Enums.ImpaktDataTypes.Conference:return h.saveConference(a);case Common.Enums.ImpaktDataTypes.Division:return h.saveDivision(a);default:b.reject(new Error("_league saveEntityByType: impaktDataType not supported"))}return b.promise}},this.toBrowser=function(){this.drilldown.league=null,this.drilldown.team=null,d.transitionTo("league.browser")},this.toLeagueDrilldown=function(a){this.drilldown.league=a,this.drilldown.conference=null,this.drilldown.division=null,this.drilldown.team=null,impakt.context.League.leagues.select(a),i(!1,!0,!0,!0),impakt.context.Actionable.selected.only(a),d.transitionTo("league.drilldown.league")},this.toConferenceDrilldown=function(a){this.drilldown.conference=a,this.drilldown.division=null,this.drilldown.team=null,impakt.context.League.conferences.select(a),i(!0,!1,!0,!0),impakt.context.Actionable.selected.only(a),d.transitionTo("league.drilldown.conference")},this.toDivisionDrilldown=function(a){this.drilldown.division=a,this.drilldown.team=null,impakt.context.League.divisions.select(a),i(!0,!0,!1,!0),impakt.context.Actionable.selected.only(a),d.transitionTo("league.drilldown.division")},this.toTeamDrilldown=function(a){this.drilldown.team=a,impakt.context.Team.teams.select(a),i(!0,!0,!0,!1),impakt.context.Actionable.selected.only(a),d.transitionTo("league.drilldown.team")}}]),impakt.league.modals=angular.module("impakt.league.modals",[]).config(function(){console.debug("impakt.league.modals - config")}).run(function(){console.debug("impakt.league.modals - run")}),impakt.league.modals.controller("league.modals.createConferenceDuplicateError.ctrl",["$scope","$uibModalInstance","_league","conference",function(a,b,c,d){a.conference=d,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}]),impakt.league.modals.controller("league.modals.createConference.ctrl",["$scope","$uibModalInstance","_associations","_league","league",function(a,b,c,d,e){function f(){Common.Utilities.isNotNullOrUndefined(a.newConference)&&impakt.context.League.creation.conferences.remove(a.newConference.guid)}a.leagues=impakt.context.League.leagues,a.newConference=new League.Models.Conference,a.selectedLeague=e?e:a.leagues.first(),a.ok=function(){d.createConference(a.newConference).then(function(d){c.createAssociations(d,[a.selectedLeague]),f(),b.close(d)},function(a){f(),console.error(a),b.close(a)})},a.cancel=function(){f(),b.dismiss()}}]),impakt.league.modals.controller("league.modals.createDivisionDuplicateError.ctrl",["$scope","$uibModalInstance","_league","division",function(a,b,c,d){a.division=d,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}]),impakt.league.modals.controller("league.modals.createDivision.ctrl",["$scope","$uibModalInstance","_associations","_league","conference",function(a,b,c,d,e){function f(){Common.Utilities.isNotNullOrUndefined(a.selectedConference)&&a.newDivision.setConference(a.selectedConference)}function g(){Common.Utilities.isNotNullOrUndefined(a.newDivision)&&impakt.context.League.creation.divisions.remove(a.newDivision.guid)}a.conferences=impakt.context.League.conferences,a.newDivision=new League.Models.Division,a.selectedConference=e?e:a.conferences.first(),a.selectConference=function(){a.newDivision.setConference(a.selectedConference)},a.ok=function(){Common.Utilities.isNullOrUndefined(a.selectedConference)||d.createDivision(a.newDivision).then(function(d){var e=[a.selectedConference];Common.Utilities.isNotNullOrUndefined(a.selectedConference.league)&&e.push(a.selectedConference.league),c.createAssociations(d,e),g(),b.close(d)},function(a){g(),console.error(a),b.close(a)})},a.cancel=function(){g(),b.dismiss()},f()}]),impakt.league.modals.controller("league.modals.createLeagueDuplicateError.ctrl",["$scope","$uibModalInstance","_league","league",function(a,b,c,d){a.league=d,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}]),impakt.league.modals.controller("league.modals.createLeague.ctrl",["$scope","$uibModalInstance","_league",function(a,b,c){a.newLeagueModel=new League.Models.LeagueModel,a.ok=function(){c.createLeague(a.newLeagueModel).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.league.modals.controller("league.modals.createLocationDuplicateError.ctrl",["$scope","$uibModalInstance","_league","location",function(a,b,c,d){a.location=d,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}]),impakt.league.modals.controller("league.modals.createLocation.ctrl",["$scope","$rootScope","$uibModalInstance","_associations","_league","associatedEntity",function(a,b,c,d,e,f){a.newLocation=new League.Models.Location,a.associatedEntity=f,a.ok=function(){e.createLocation(a.newLocation).then(function(b){Common.Utilities.isNotNullOrUndefined(a.associatedEntity)&&d.createAssociation(b,a.associatedEntity),c.close(b)},function(a){console.error(a),c.close(a)})},a.cancel=function(){c.dismiss()}}]),impakt.league.modals.controller("league.modals.deleteConference.ctrl",["$scope","$rootScope","$uibModalInstance","_league","conference",function(a,b,c,d,e){a.conference=e,a.ok=function(){d.deleteConference(a.conference).then(function(d){b.$broadcast("delete-conference",a.conference),c.close(d)},function(a){console.error(a),c.close(a)})},a.cancel=function(){c.dismiss()}}]),impakt.league.modals.controller("league.modals.deleteDivision.ctrl",["$scope","$rootScope","$uibModalInstance","_league","division",function(a,b,c,d,e){a.division=e,a.ok=function(){d.deleteDivision(a.division).then(function(d){b.$broadcast("delete-division",a.division),c.close(d)},function(a){console.error(a),c.close(a)})},a.cancel=function(){c.dismiss()}}]),impakt.league.modals.controller("league.modals.deleteLeague.ctrl",["$scope","$uibModalInstance","_league","league",function(a,b,c,d){a.league=d,a.ok=function(){c.deleteLeague(a.league).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.league.modals.controller("league.modals.deleteLocation.ctrl",["$scope","$uibModalInstance","_league","location",function(a,b,c,d){a.location=d,a.ok=function(){c.deleteLocation(a.location).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.league.modals.service("_leagueModals",["$q","__modals",function(a,b){this.createLeague=function(){var c=a.defer(),d=b.open("","modules/league/modals/create-league/create-league.tpl.html","league.modals.createLeague.ctrl",{});return d.result.then(function(a){console.log(a),c.resolve()},function(a){console.log("dismissed"),c.reject()}),c.promise},this.createLeagueDuplicate=function(c){var d=a.defer(),e=b.open("","modules/league/modals/create-league-duplicate-error/create-league-duplicate-error.tpl.html","league.modals.createLeagueDuplicateError.ctrl",{league:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deleteLeague=function(c){var d=a.defer(),e=b.open("","modules/league/modals/delete-league/delete-league.tpl.html","league.modals.deleteLeague.ctrl",{league:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.saveLeague=function(c){var d=a.defer(),e=b.open("","modules/league/modals/save-league/save-league.tpl.html","league.modals.saveLeague.ctrl",{league:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createConference=function(c){var d=a.defer(),e=b.open("","modules/league/modals/create-conference/create-conference.tpl.html","league.modals.createConference.ctrl",{league:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createConferenceDuplicate=function(c){var d=a.defer(),e=b.open("","modules/league/modals/create-conference-duplicate-error/create-conference-duplicate-error.tpl.html","league.modals.createConferenceDuplicateError.ctrl",{conference:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deleteConference=function(c){var d=a.defer(),e=b.open("","modules/league/modals/delete-conference/delete-conference.tpl.html","league.modals.deleteConference.ctrl",{conference:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.saveConference=function(c){var d=a.defer(),e=b.open("","modules/league/modals/save-conference/save-conference.tpl.html","league.modals.saveConference.ctrl",{conference:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createDivision=function(c){var d=a.defer(),e=b.open("","modules/league/modals/create-division/create-division.tpl.html","league.modals.createDivision.ctrl",{conference:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createDivisionDuplicate=function(c){var d=a.defer(),e=b.open("","modules/league/modals/create-division-duplicate-error/create-division-duplicate-error.tpl.html","league.modals.createDivisionDuplicateError.ctrl",{division:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deleteDivision=function(c){var d=a.defer(),e=b.open("","modules/league/modals/delete-division/delete-division.tpl.html","league.modals.deleteDivision.ctrl",{division:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.saveDivision=function(c){var d=a.defer(),e=b.open("","modules/league/modals/save-division/save-division.tpl.html","league.modals.saveDivision.ctrl",{division:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createLocation=function(c){var d=a.defer(),e=b.open("","modules/league/modals/create-location/create-location.tpl.html","league.modals.createLocation.ctrl",{associatedEntity:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve(a)},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createLocationDuplicate=function(c){var d=a.defer(),e=b.open("","modules/league/modals/create-location-duplicate-error/create-location-duplicate-error.tpl.html","league.modals.createLocationDuplicateError.ctrl",{location:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deleteLocation=function(c){var d=a.defer(),e=b.open("","modules/league/modals/delete-location/delete-location.tpl.html","league.modals.deleteLocation.ctrl",{location:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.saveLocation=function(c){var d=a.defer(),e=b.open("","modules/league/modals/save-location/save-location.tpl.html","league.modals.saveLocation.ctrl",{location:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise}}]),impakt.league.modals.controller("league.modals.saveConference.ctrl",["$scope","$uibModalInstance","_league","conference",function(a,b,c,d){a.conference=d,a.ok=function(){c.updateConference(a.conference).then(function(a){b.close(a)},function(a){b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.league.modals.controller("league.modals.saveDivision.ctrl",["$scope","$uibModalInstance","_league","division",function(a,b,c,d){a.division=d,a.ok=function(){c.updateDivision(a.division).then(function(a){b.close(a)},function(a){b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.league.modals.controller("league.modals.saveLeague.ctrl",["$scope","$uibModalInstance","_league","league",function(a,b,c,d){a.league=d,a.ok=function(){c.updateLeague(a.league).then(function(a){b.close(a)},function(a){b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.league.modals.controller("league.modals.saveLocation.ctrl",["$scope","$uibModalInstance","_league","location",function(a,b,c,d){a.location=d,a.ok=function(){c.updateLocation(a.location).then(function(a){b.close(a)},function(a){b.close(a)})},a.cancel=function(){b.dismiss()}}]);var League;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this,Common.Enums.ImpaktDataTypes.Location),this.associable=["games","teams"]}return __extends(c,b),c.prototype.copy=function(c){var d=c||new a.Models.Location;return b.prototype.copy.call(this,d,this)},c.prototype.toJson=function(){return $.extend({name:this.name},b.prototype.toJson.call(this))},c.prototype.fromJson=function(a){a&&(this.name=a.name,b.prototype.fromJson.call(this,a))},c}(Common.Models.AssociableEntity);b.Location=c}(b=a.Models||(a.Models={}))}(League||(League={}));var League;!function(a){var b;!function(b){var c=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.toJson=function(){return{guid:this.guid,locations:b.prototype.toJson.call(this)}},c.prototype.fromJson=function(b){if(b){this.guid=b.guid;for(var c=b.locations||[],d=0;d<c.length;d++){var e=c[d];if(!Common.Utilities.isNullOrUndefined(e)){var f=new a.Models.Location;f.fromJson(e),this.add(f)}}}},c}(Common.Models.ActionableCollection);b.LocationCollection=c}(b=a.Models||(a.Models={}))}(League||(League={})),impakt.main=angular.module("impakt.main",[]).config([function(){console.debug("impakt.main - config")}]).run([function(){console.debug("impakt.main - run")}]),impakt.main.controller("main.ctrl",["$scope","__context",function(a,b){a.appVisible=!1,b.onReady(function(){a.appVisible=!0,a.$$phase||a.$apply()})}]),impakt.nav=angular.module("impakt.nav",["impakt.user","impakt.playbook.nav"]).config(function(){console.debug("impakt.nav - config")}).run(function(){console.debug("impakt.nav - run")}),impakt.nav.controller("nav.ctrl",["$scope","$location","__nav","__notifications","appConfigurator",function(a,b,c,d,e){function f(){var b=a.menuItems.getActive();return b?b.label:null}a.appVer=e.appVer,a.isMenuCollapsed=!0,a.notifications=d.notifications,a.currentYear=(new Date).getFullYear(),a.menuItems=c.menuItems,a.notificationsMenuItem=c.notificationsMenuItem,a.searchMenuItem=c.searchMenuItem,b.path("/home"),a.navigatorNavSelection=f(),a.searchItemClick=function(){a.searchMenuItem.toggleActivation()},a.notificationItemClick=function(){a.notificationsMenuItem.isActive=!a.notificationsMenuItem.isActive,a.menuVisibilityToggle(a.notificationsMenuItem,!1)},a.menuVisibilityToggle=function(b,c){a.isMenuCollapsed=!a.isMenuCollapsed,c&&a.menuItemClick(b)},a.menuItemClick=function(b){a.menuItems.activate(b),a.navigatorNavSelection=b.label}}]),impakt.nav.factory("__nav",["$http","$q","$state",function(a,b,c){var d=new Navigation.Models.NavigationItemCollection;d.add(new Navigation.Models.NavigationItem("home","Home","home","/home",!0,function(a){c.transitionTo("home")})),d.add(new Navigation.Models.NavigationItem("league","League","globe","/league",!1,function(a){c.transitionTo("league.browser")})),d.add(new Navigation.Models.NavigationItem("season","Season","calendar","/season",!1,function(a){c.transitionTo("season")})),d.add(new Navigation.Models.NavigationItem("playbook","Playbook","book","/playbook/browser",!1,function(a){c.transitionTo("playbook.browser")})),d.add(new Navigation.Models.NavigationItem("planning","Planning","blackboard","/planning",!1,function(a){c.transitionTo("planning")})),d.add(new Navigation.Models.NavigationItem("analysis","Analysis","facetime-video","/analysis",!1,function(a){c.transitionTo("analysis")})),d.add(new Navigation.Models.NavigationItem("team","Team","list-alt","/team",!1,function(a){c.transitionTo("team")})),d.add(new Navigation.Models.NavigationItem("profile","Profile","user","/profile",!1,function(a){c.transitionTo("profile")}));var e=new Navigation.Models.NavigationItem("search","Search","search",null,!1,function(a){}),f=new Navigation.Models.NavigationItem("notifications","Notifications","bell",null,!1,function(a){});return{menuItems:d,searchMenuItem:e,notificationsMenuItem:f}}]),impakt.planning=angular.module("impakt.planning",["impakt.planning.browser","impakt.planning.editor","impakt.planning.drilldown","impakt.planning.modals"]).config(["$stateProvider","$urlRouterProvider",function(a,b){console.debug("impakt.planning - config"),a.state("planning",{url:"/planning",templateUrl:"modules/planning/planning.tpl.html",controller:"planning.ctrl"})}]).run(function(){console.debug("impakt.planning - run")}),impakt.planning.browser=angular.module("impakt.planning.browser",[]).config(["$stateProvider",function(a){console.debug("impakt.planning.browser - config"),a.state("planning.browser",{url:"/browser",templateUrl:"modules/planning/browser/planning-browser.tpl.html",controller:"planning.browser.ctrl"})}]).run(function(){console.debug("impakt.planning.browser - run")}),impakt.planning.browser.controller("planning.browser.ctrl",["$scope","_planning","_planningModals",function(a,b,c,d){a.plans=impakt.context.Planning.plans,a.createPlan=function(){c.createPlan()},a.planDrilldown=function(a){b.toPlanDrilldown(a)}}]),impakt.planning.drilldown=angular.module("impakt.planning.drilldown",["impakt.planning.drilldown.plan"]).config(["$stateProvider",function(a){console.debug("impakt.planning.drilldown - config"),a.state("planning.drilldown",{url:"/drilldown",templateUrl:"modules/planning/drilldown/planning-drilldown.tpl.html",controller:"planning.drilldown.ctrl"})}]).run(function(){console.debug("impakt.planning.drilldown - run")}),impakt.planning.drilldown.plan=angular.module("impakt.planning.drilldown.plan",[]).config(["$stateProvider",function(a){console.debug("impakt.planning.drilldown.plan - config"),a.state("planning.drilldown.plan",{url:"/plan",templateUrl:"modules/planning/drilldown/plan/planning-drilldown-plan.tpl.html",controller:"planning.drilldown.plan.ctrl"})}]).run(function(){console.debug("impakt.planning.drilldown.plan - run")}),impakt.planning.drilldown.plan.controller("planning.drilldown.plan.ctrl",["$scope","$rootScope","_associations","_planning","_planningModals",function(a,b,c,d,e){function f(){var b=c.getAssociated(a.plan);Common.Utilities.isNotNullOrUndefined(b)&&(a.practicePlans=b.practicePlans,a.practicePlans.forEach(function(b,c){b.setPlan(a.plan)}),a.gamePlans=b.gamePlans,a.gamePlans.forEach(function(b,c){b.setPlan(a.plan)}),a.scoutCards=b.scoutCards,a.scoutCards.forEach(function(b,c){b.setPlan(a.plan)}))}a.plan=d.drilldown.plan,a.practicePlans=new Planning.Models.PracticePlanCollection,a.gamePlans=new Planning.Models.GamePlanCollection,a.scoutCards=new Planning.Models.ScoutCardCollection;var g=b.$on("delete-practicePlan",function(b,c){a.practicePlans.remove(c.guid)}),h=b.$on("delete-gamePlan",function(b,c){a.gamePlans.remove(c.guid)}),i=b.$on("delete-scoutCard",function(b,c){a.scoutCard.remove(c.guid)}),j=b.$on("associations-updated",function(a){f()});a.$on("$destroy",function(){g(),h(),i(),j()}),a.createPracticePlan=function(){e.createPracticePlan(a.plan).then(function(){f()})},a.createGamePlan=function(){e.createGamePlan(a.plan).then(function(){f()})},a.createScoutCard=function(){e.createScoutCard(a.plan).then(function(){f()})},f()}]),impakt.planning.drilldown.controller("planning.drilldown.ctrl",["$scope","_details","_planning",function(a,b,c){a.drilldown=c.drilldown,a.toPlanDrilldown=function(a){c.toPlanDrilldown(a)},a.toBrowser=function(){b.selectedElements.deselectAll(),c.toBrowser()}}]),impakt.planning.editor=angular.module("impakt.planning.editor",["impakt.planning.editor.practicePlan"]).config(["$stateProvider",function(a){console.info("impakt.planning.editor  config"),a.state("planning.editor",{url:"/editor",templateUrl:"modules/planning/editor/planning-editor.tpl.html",controller:"planning.editor.ctrl"})}]).run(function(){console.info("impakt.planning.editor  run")}),impakt.planning.editor.controller("planning.editor.ctrl",["$scope","_planning","_planningEditor","_planningModals",function(a,b,c,d){function e(){c.init()}a.tabs=c.tabs,a.toPlanDrilldown=function(){b.toPlanDrilldown(b.drilldown.plan)},a.newTab=function(){d.newPlanningEditorTab()},e()}]),impakt.planning.editor.service("_planningEditor",["_planning",function(a){var b=this;this.practicePlans=impakt.context.Planning.editor.practicePlans,this.tabs=new Planning.Models.PlanningEditorTabCollection,this.currentTab=null,this.init=function(){Common.Utilities.isNotNullOrUndefined(this.practicePlans)&&Common.Utilities.isNotNullOrUndefined(this.tabs)&&(this.practicePlans.forEach(function(a,c){var d=b.tabs.filterFirst(function(b,c){return b.data.guid==a.guid});Common.Utilities.isNullOrUndefined(d)&&b.addTab(a)}),this.activateTab(this.tabs.first()))},this.addTab=function(a){if(!Common.Utilities.isNullOrUndefined(a)){var b=this.tabs.filterFirst(function(b,c){return b.data.guid==a.guid});Common.Utilities.isNotNullOrUndefined(b)||this.tabs.add(new Planning.Models.PlanningEditorTab(a))}},this.close=function(a){var b=a.data.impaktDataType;switch(b){case Common.Enums.ImpaktDataTypes.PracticePlan:this.practicePlans.remove(a.data.guid)}var c=this.tabs.getNext(a.guid)||this.tabs.getPrevious(a.guid),d=this.tabs.remove(a.guid);d.selected&&Common.Utilities.isNotNullOrUndefined(c)&&this.activateTab(c)},this.activateTab=function(a){Common.Utilities.isNullOrUndefined(a)||(this.tabs.select(a),this.currentTab=a)}}]),impakt.planning.editor.practicePlan=angular.module("impakt.planning.editor.practicePlan",[]).config(["$stateProvider",function(a){console.info("impakt.planning.editor.practicePlan  config"),a.state("planning.editor.practicePlan",{url:"/practicePlan",templateUrl:"modules/planning/editor/practice-plan/planning-editor-practice-plan.tpl.html",controller:"planning.editor.practicePlan.ctrl"})}]).run(function(){console.info("impakt.planning.editor.practicePlan  run")}),impakt.planning.editor.practicePlan.controller("planning.editor.practicePlan.details.ctrl",["$scope","_planningModals","_planningEditor",function(a,b,c){function d(){Common.Utilities.isNotNullOrUndefined(c.currentTab)&&(a.practicePlan=c.currentTab.data,Common.Utilities.isNotNullOrUndefined(a.practicePlan)&&(a.titleData=a.practicePlan.titleData,a.situationData=a.practicePlan.situationData,a.offensiveData=a.practicePlan.offensiveData,a.defensiveData=a.practicePlan.defensiveData),Common.Utilities.isNotNullOrUndefined(a.titleData)&&(a.titleDataToggles=a.titleData.toCollection()),Common.Utilities.isNotNullOrUndefined(a.situationData)&&(a.situationDataToggles=a.situationData.toCollection()),Common.Utilities.isNotNullOrUndefined(a.offensiveData)&&(a.offensiveDataToggles=a.offensiveData.toCollection()),Common.Utilities.isNotNullOrUndefined(a.defensiveData)&&(a.defensiveDataToggles=a.defensiveData.toCollection()))}a.practicePlan=null,a.titleData=null,a.titleDataToggles=new Planning.Models.PlanningEditorToggleItemCollection,a.situationData=null,a.situationDataToggles=new Planning.Models.PlanningEditorToggleItemCollection,a.offensiveData=null,a.offensiveDataToggles=new Planning.Models.PlanningEditorToggleItemCollection,a.defensiveData=null,a.defensiveDataToggles=new Planning.Models.PlanningEditorToggleItemCollection,a.save=function(){b.savePracticePlan(a.practicePlan)},d()}]),impakt.planning.editor.practicePlan.controller("planning.editor.practicePlan.ctrl",["$scope","_planningEditor",function(a,b){function c(){Common.Utilities.isNotNullOrUndefined(b.currentTab)&&(a.practicePlan=b.currentTab.data,Common.Utilities.isNotNullOrUndefined(a.practicePlan)&&Common.Utilities.isNotNullOrUndefined(a.practicePlan.titleData)&&Common.Utilities.isNotNullOrUndefined(a.practicePlan.titleData.location)&&(a.selectedLocation=a.practicePlan.titleData.location.location||a.locations.first()),Common.Utilities.isNotNullOrUndefined(a.practicePlan)&&Common.Utilities.isNotNullOrUndefined(a.practicePlan.titleData)&&Common.Utilities.isNotNullOrUndefined(a.practicePlan.titleData.opponent)&&(a.selectedOpponent=a.practicePlan.titleData.opponent.opponent||a.opponents.first()))}a.practicePlan=null,a.hashmarkList=Common.Utilities.getEnumerationsOnly(Playbook.Enums.Hashmark),a.downs=[1,2,3,4],a.fieldZones=Common.Utilities.getEnumerationsOnly(Playbook.Enums.FieldZones),a.tempos=Common.Utilities.getEnumerationsOnly(Planning.Enums.Tempo),a.locations=impakt.context.League.locations,a.opponents=impakt.context.Team.teams,a.plays=impakt.context.Playbook.plays,a.formations=impakt.context.Playbook.formations,a.personnelCollection=impakt.context.Team.personnel,a.selectedLocation=null,a.selectedOpponent=null,a.opponentSelected=function(b){Common.Utilities.isNotNullOrUndefined(b)&&Common.Utilities.isNotNullOrUndefined(b.titleData)&&Common.Utilities.isNotNullOrUndefined(b.titleData.opponent)&&b.titleData.opponent.setOpponent(a.selectedOpponent)},a.locationSelected=function(b){Common.Utilities.isNotNullOrUndefined(b)&&Common.Utilities.isNotNullOrUndefined(b.titleData)&&Common.Utilities.isNotNullOrUndefined(b.titleData.location)&&b.titleData.location.setLocation(a.selectedLocation)},c()}]),impakt.planning.modals=angular.module("impakt.planning.modals",[]).config(function(){console.debug("impakt.planning.modals - config")}).run(function(){console.debug("impakt.planning.modals - run")}),impakt.planning.modals.controller("planning.modals.createGamePlanDuplicateError.ctrl",["$scope","$uibModalInstance","_planning","gamePlan",function(a,b,c,d){a.gamePlan=d,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}]),impakt.planning.modals.controller("planning.modals.createGamePlan.ctrl",["$scope","$uibModalInstance","_associations","_planning","plan",function(a,b,c,d,e){function f(){Common.Utilities.isNotNullOrUndefined(a.newGamePlan)&&impakt.context.Planning.creation.gamePlans.remove(a.newGamePlan.guid)}a.plans=impakt.context.Planning.plans,a.newGamePlan=new Planning.Models.GamePlan,a.selectedPlan=e||null,a.selectPlan=function(){Common.Utilities.isNullOrUndefined(a.selectedPlan)||a.newGamePlan.setPlan(a.selectedPlan)},a.updateDatetime=function(){},a.ok=function(){d.createGamePlan(a.newGamePlan).then(function(d){var e=[];Common.Utilities.isNotNullOrUndefined(a.selectedPlan)&&e.push(a.selectedPlan),c.createAssociations(d,e),f(),b.close(d)},function(a){f(),console.error(a),b.close(a)})},a.cancel=function(){f(),b.dismiss()}}]),impakt.planning.modals.controller("planning.modals.createPlanDuplicateError.ctrl",["$scope","$uibModalInstance","_planning","plan",function(a,b,c,d){a.plan=d,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}]),impakt.planning.modals.controller("planning.modals.createPlan.ctrl",["$scope","$uibModalInstance","_associations","_planning","plan",function(a,b,c,d,e){function f(){Common.Utilities.isNotNullOrUndefined(a.newPlan)&&impakt.context.Planning.creation.plans.remove(a.newPlan.guid)}a.plans=impakt.context.Planning.plans,a.allGames=impakt.context.Season.games,a.games=new Season.Models.GameCollection,a.weeks=new Season.Models.WeekCollection,a.newPlan=new Planning.Models.Plan,a.seasons=impakt.context.Season.seasons,a.selectedSeason=null,a.selectedWeek=null,a.selectedGame=null,a.selectSeason=function(){return Common.Utilities.isNullOrUndefined(a.selectedSeason)?(a.selectedWeek=null,void(a.selectedGame=null)):(a.weeks=a.selectedSeason.weeks,a.selectedWeek=a.weeks.first(),void a.selectWeek())},a.selectWeek=function(){return Common.Utilities.isNullOrUndefined(a.selectedWeek)?void(a.selectedGame=null):(a.games.listen(!1),a.games.empty(),a.allGames.forEach(function(b,c){a.selectedWeek.guid==b.weekGuid&&a.games.add(b)}),void a.games.listen(!0))},a.selectGame=function(){a.newPlan.setGame(a.selectedGame)},a.updateDatetime=function(){},a.ok=function(){d.createPlan(a.newPlan).then(function(d){var e=[];Common.Utilities.isNotNullOrUndefined(a.selectedGame)&&e.push(a.selectedGame),c.createAssociations(d,e),f(),b.close(d)},function(a){f(),console.error(a),b.close(a)})},a.cancel=function(){f(),b.dismiss()}}]),impakt.planning.modals.controller("planning.modals.createPracticePlanDuplicateError.ctrl",["$scope","$uibModalInstance","_planning","practicePlan",function(a,b,c,d){a.practicePlan=d,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}]),impakt.planning.modals.controller("planning.modals.createPracticePlan.ctrl",["$scope","$uibModalInstance","_associations","_planning","plan",function(a,b,c,d,e){function f(){Common.Utilities.isNotNullOrUndefined(a.newPracticePlan)&&impakt.context.Planning.creation.practicePlans.remove(a.newPracticePlan.guid)}a.plans=impakt.context.Planning.plans,a.newPracticePlan=new Planning.Models.PracticePlan,a.selectedPlan=e||null,a.selectPlan=function(){Common.Utilities.isNullOrUndefined(a.selectedPlan)||a.newPracticePlan.setPlan(a.selectedPlan)},a.updateDatetime=function(){},a.ok=function(){d.createPracticePlan(a.newPracticePlan).then(function(d){var e=[];Common.Utilities.isNotNullOrUndefined(a.selectedPlan)&&e.push(a.selectedPlan),c.createAssociations(d,e),f(),b.close(d)},function(a){f(),console.error(a),b.close(a)})},a.cancel=function(){f(),b.dismiss()}}]),impakt.planning.modals.controller("planning.modals.createScoutCardDuplicateError.ctrl",["$scope","$uibModalInstance","_planning","scoutCard",function(a,b,c,d){a.scoutCard=d,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}]),impakt.planning.modals.controller("planning.modals.createScoutCard.ctrl",["$scope","$uibModalInstance","_associations","_planning","plan",function(a,b,c,d,e){function f(){Common.Utilities.isNotNullOrUndefined(a.newScoutCard)&&impakt.context.Planning.creation.scoutCards.remove(a.newScoutCard.guid)}a.plans=impakt.context.Planning.plans,a.newScoutCard=new Planning.Models.ScoutCard,a.selectedPlan=e||null,a.selectPlan=function(){Common.Utilities.isNullOrUndefined(a.selectedPlan)||a.newScoutCard.setPlan(a.selectedPlan)},a.updateDatetime=function(){},a.ok=function(){d.createScoutCard(a.newScoutCard).then(function(d){var e=[];Common.Utilities.isNotNullOrUndefined(a.selectedPlan)&&e.push(a.selectedPlan),c.createAssociations(d,e),f(),b.close(d)},function(a){f(),console.error(a),b.close(a)})},a.cancel=function(){f(),b.dismiss()}}]),impakt.planning.modals.controller("planning.modals.deleteGamePlan.ctrl",["$scope","$rootScope","$uibModalInstance","_planning","gamePlan",function(a,b,c,d,e){a.gamePlan=e,a.ok=function(){d.deleteGamePlan(a.gamePlan).then(function(d){b.$broadcast("delete-gamePlan",a.gamePlan),c.close(d)},function(a){console.error(a),c.close(a)})},a.cancel=function(){c.dismiss()}}]),impakt.planning.modals.controller("planning.modals.deletePlan.ctrl",["$scope","$rootScope","$uibModalInstance","_planning","plan",function(a,b,c,d,e){a.plan=e,a.ok=function(){d.deletePlan(a.plan).then(function(d){b.$broadcast("delete-plan",a.plan),c.close(d)},function(a){console.error(a),c.close(a)})},a.cancel=function(){c.dismiss()}}]),impakt.planning.modals.controller("planning.modals.deletePracticePlan.ctrl",["$scope","$rootScope","$uibModalInstance","_planning","practicePlan",function(a,b,c,d,e){a.practicePlan=e,a.ok=function(){d.deletePracticePlan(a.practicePlan).then(function(d){b.$broadcast("delete-practicePlan",a.practicePlan),c.close(d)},function(a){console.error(a),c.close(a)})},a.cancel=function(){c.dismiss()}}]),impakt.planning.modals.controller("planning.modals.deleteScoutCard.ctrl",["$scope","$rootScope","$uibModalInstance","_planning","scoutCard",function(a,b,c,d,e){a.scoutCard=e,a.ok=function(){d.deleteScoutCard(a.scoutCard).then(function(d){b.$broadcast("delete-scoutCard",a.scoutCard),
c.close(d)},function(a){console.error(a),c.close(a)})},a.cancel=function(){c.dismiss()}}]),impakt.planning.modals.controller("planning.modals.newPlanningEditorTab.ctrl",["$scope","$uibModalInstance","_planningEditor",function(a,b,c){a.practicePlans=impakt.context.Planning.practicePlans,a.selectedPracticePlan=null,a.editPracticePlansVisible=!0,a.editPracticePlan=function(){a.editPracticePlansVisible=!0},a.selectPracticePlan=function(){},a.ok=function(){c.addTab(a.selectedPracticePlan),b.close()},a.cancel=function(){b.dismiss()}}]),impakt.planning.modals.service("_planningModals",["$q","__modals",function(a,b){this.createPlan=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/create-plan/create-plan.tpl.html","planning.modals.createPlan.ctrl",{plan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createPlanDuplicate=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/create-plan-duplicate-error/create-plan-duplicate-error.tpl.html","planning.modals.createPlanDuplicateError.ctrl",{plan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deletePlan=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/delete-plan/delete-plan.tpl.html","planning.modals.deletePlan.ctrl",{plan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.savePlan=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/save-plan/save-plan.tpl.html","planning.modals.savePlan.ctrl",{plan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createPracticePlan=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/create-practice-plan/create-practice-plan.tpl.html","planning.modals.createPracticePlan.ctrl",{plan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createPracticePlanDuplicate=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/create-practice-plan-duplicate-error/create-practice-plan-duplicate-error.tpl.html","planning.modals.createPracticePlanDuplicateError.ctrl",{practicePlan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deletePracticePlan=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/delete-practice-plan/delete-practice-plan.tpl.html","planning.modals.deletePracticePlan.ctrl",{practicePlan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.savePracticePlan=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/save-practice-plan/save-practice-plan.tpl.html","planning.modals.savePracticePlan.ctrl",{practicePlan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createGamePlan=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/create-game-plan/create-game-plan.tpl.html","planning.modals.createGamePlan.ctrl",{plan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createGamePlanDuplicate=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/create-game-plan-duplicate-error/create-game-plan-duplicate-error.tpl.html","planning.modals.createGamePlanDuplicateError.ctrl",{gamePlan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deleteGamePlan=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/delete-game-plan/delete-game-plan.tpl.html","planning.modals.deleteGamePlan.ctrl",{gamePlan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.saveGamePlan=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/save-game-plan/save-game-plan.tpl.html","planning.modals.saveGamePlan.ctrl",{gamePlan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createPracticeSchedule=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/create-practice-schedule/create-practice-schedule.tpl.html","planning.modals.createPracticeSchedule.ctrl",{plan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createPracticeScheduleDuplicate=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/create-practice-schedule-duplicate-error/create-practice-schedule-duplicate-error.tpl.html","planning.modals.createPracticeScheduleDuplicateError.ctrl",{practiceSchedule:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deletePracticeSchedule=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/delete-practice-schedule/delete-practice-schedule.tpl.html","planning.modals.deletePracticeSchedule.ctrl",{practiceSchedule:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.savePracticeSchedule=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/save-practice-schedule/save-practice-schedule.tpl.html","planning.modals.savePracticeSchedule.ctrl",{practiceSchedule:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createScoutCard=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/create-scout-card/create-scout-card.tpl.html","planning.modals.createScoutCard.ctrl",{plan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createScoutCardDuplicate=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/create-scout-card-duplicate-error/create-scout-card-duplicate-error.tpl.html","planning.modals.createScoutCardDuplicateError.ctrl",{scoutCard:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deleteScoutCard=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/delete-scout-card/delete-scout-card.tpl.html","planning.modals.deleteScoutCard.ctrl",{scoutCard:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.saveScoutCard=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/save-scout-card/save-scout-card.tpl.html","planning.modals.saveScoutCard.ctrl",{scoutCard:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createQBWristband=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/create-QBWristband/create-QBWristband.tpl.html","planning.modals.createQBWristband.ctrl",{plan:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createQBWristbandDuplicate=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/create-QBWristband-duplicate-error/create-QBWristband-duplicate-error.tpl.html","planning.modals.createQBWristbandDuplicateError.ctrl",{QBWristband:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deleteQBWristband=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/delete-QBWristband/delete-QBWristband.tpl.html","planning.modals.deleteQBWristband.ctrl",{QBWristband:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.saveQBWristband=function(c){var d=a.defer(),e=b.open("","modules/planning/modals/save-QBWristband/save-QBWristband.tpl.html","planning.modals.saveQBWristband.ctrl",{QBWristband:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.newPlanningEditorTab=function(){var c=a.defer(),d=b.open("","modules/planning/modals/new-planning-editor-tab/new-planning-editor-tab.tpl.html","planning.modals.newPlanningEditorTab.ctrl",{});return d.result.then(function(){c.resolve()},function(a){c.reject()}),c.promise}}]),impakt.planning.modals.controller("planning.modals.saveGamePlan.ctrl",["$scope","$uibModalInstance","_planning","gamePlan",function(a,b,c,d){a.gamePlan=d,a.ok=function(){c.updateGamePlan(a.gamePlan).then(function(a){b.close(a)},function(a){b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.planning.modals.controller("planning.modals.savePlan.ctrl",["$scope","$uibModalInstance","_planning","plan",function(a,b,c,d){a.plan=d,a.ok=function(){c.updatePlan(a.plan).then(function(a){b.close(a)},function(a){b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.planning.modals.controller("planning.modals.savePracticePlan.ctrl",["$scope","$uibModalInstance","_planning","practicePlan",function(a,b,c,d){a.practicePlan=d,a.ok=function(){c.updatePracticePlan(a.practicePlan).then(function(a){b.close(a)},function(a){b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.planning.modals.controller("planning.modals.saveScoutCard.ctrl",["$scope","$uibModalInstance","_planning","scoutCard",function(a,b,c,d){a.scoutCard=d,a.ok=function(){c.updateScoutCard(a.scoutCard).then(function(a){b.close(a)},function(a){b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.planning.constant("PLANNING",{ENDPOINT:"/planning",CREATE_PLAN:"/createPlan",GET_PLANS:"/getPlans",GET_PLAN:"/getPlan",DELETE_PLAN:"/deletePlan",UPDATE_PLAN:"/updatePlan",CREATE_PRACTICEPLAN:"/createPracticePlan",GET_PRACTICEPLANS:"/getPracticePlans",GET_PRACTICEPLAN:"/getPracticePlan",DELETE_PRACTICEPLAN:"/deletePracticePlan",UPDATE_PRACTICEPLAN:"/updatePracticePlan",CREATE_PRACTICESCHEDULE:"/createPracticeSchedule",GET_PRACTICESCHEDULES:"/getPracticeSchedules",GET_PRACTICESCHEDULE:"/getPracticeSchedule",DELETE_PRACTICESCHEDULE:"/deletePracticeSchedule",UPDATE_PRACTICESCHEDULE:"/updatePracticeSchedule",CREATE_GAMEPLAN:"/createGamePlan",GET_GAMEPLANS:"/getGamePlans",GET_GAMEPLAN:"/getGamePlan",DELETE_GAMEPLAN:"/deleteGamePlan",UPDATE_GAMEPLAN:"/updatePracticePlan",CREATE_SCOUTCARD:"/createScoutCard",GET_SCOUTCARDS:"/getScoutCards",GET_SCOUTCARD:"/getScoutCard",DELETE_SCOUTCARD:"/deleteScoutCard",UPDATE_SCOUTCARD:"/updateScoutCard",CREATE_QBWRISTBAND:"/createQBWristband",GET_QBWRISTBANDS:"/getQBWristbands",GET_QBWRISTBAND:"/getQBWristband",DELETE_QBWRISTBAND:"/deleteQBWristband",UPDATE_QBWRISTBAND:"/updateQBWristband"}),impakt.planning.controller("planning.ctrl",["$scope","$state","_planning",function(a,b,c){b.go("planning.browser")}]),impakt.planning.service("_planning",["PLANNING","$rootScope","$q","$state","__api","__localStorage","__notifications","_planningModals",function(a,b,c,d,e,f,g,h){var i=this;this.drilldown={plan:null},this.getPlans=function(){var b=c.defer(),d=g.pending("Getting  plans...");return e.get(e.path(a.ENDPOINT,a.GET_PLANS)).then(function(a){var c=new Planning.Models.PlanCollection;if(a&&a.data&&a.data.results)for(var e=Common.Utilities.parseData(a.data.results),f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.plan){var h=new Planning.Models.Plan;g.data.plan.key=g.key,h.fromJson(g.data.plan),c.add(h,!1)}}d.success([c.size()," plans successfully retreived"].join("")),b.resolve(c)},function(a){d.error("Failed to retieve plans"),console.error(a),b.reject(a)}),b.promise},this.getPlan=function(b){var d=c.defer();return e.get(e.path(a.ENDPOINT,a.GET_PLAN,"/"+b)).then(function(a){var b=Common.Utilities.parseData(a.data.results);d.resolve(b)},function(a){d.reject(a)}),d.promise},this.createPlan=function(d){var f=c.defer();if(Common.Utilities.isNotNullOrUndefined(d)){var i=impakt.context.Planning.plans.hasElementWhich(function(a,b){return a.name==d.name});if(i){g.warning('Failed to create plan. Plan "',d.name,'" already exists.');return void h.createPlanDuplicate(d)}}d.key=-1;var j=d.toJson(),k=g.pending('Creating plan "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_PLAN),{version:1,name:d.name,data:{version:1,plan:j}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),d=new Planning.Models.Plan;if(!(c&&c.data&&c.data.plan))throw new Error("createPlan did not return a valid Plan");c.data.plan.key=c.key,d.fromJson(c.data.plan),impakt.context.Planning.plans.add(d,!1),k.success('Successfully created plan "',d.name,'"'),b.$broadcast("create-entity",d),f.resolve(d)},function(a){k.error('Failed to create plan "',d.name,'"'),f.reject(a)}),f.promise},this.deletePlan=function(b){var d=c.defer(),f=g.pending('Deleting plan "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_PLAN),{key:b.key}).then(function(a){impakt.context.Planning.plans.remove(b.guid),f.success('Deleted plan "',b.name,'"'),i.toBrowser(),d.resolve(b)},function(a){f.error('Failed to delete plan "',b.name,'"'),d.reject(a)}),d.promise},this.updatePlan=function(b){var d=c.defer(),f=b.toJson(),h=g.pending('Updating plan "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.UPDATE_PLAN),{version:1,name:f.name,key:f.key,data:{version:1,key:f.key,plan:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=new Planning.Models.Plan;c&&c.data&&c.data.plan&&(e.fromJson(c.data.plan),impakt.context.Planning.plans.set(e.guid,e)),h.success('Successfully updated plan "',b.name,'"'),d.resolve(e)},function(a){h.error('Failed to update plan "',b.name,'"'),d.reject(a)}),d.promise},this.getPracticePlans=function(){var b=c.defer(),d=g.pending("Getting practice plans...");return e.get(e.path(a.ENDPOINT,a.GET_PRACTICEPLANS)).then(function(a){var c=new Planning.Models.PracticePlanCollection;if(a&&a.data&&a.data.results)for(var e=Common.Utilities.parseData(a.data.results),f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.practicePlan){var h=new Planning.Models.PracticePlan;g.data.practicePlan.key=g.key,h.fromJson(g.data.practicePlan),c.add(h,!1)}}d.success([c.size()," practice plans successfully retreived"].join("")),b.resolve(c)},function(a){d.error("Failed to retieve practice plans"),console.error(a),b.reject(a)}),b.promise},this.getPracticePlan=function(b){var d=c.defer();return e.get(e.path(a.ENDPOINT,a.GET_PRACTICEPLAN,"/"+b)).then(function(a){var b=Common.Utilities.parseData(a.data.results);d.resolve(b)},function(a){d.reject(a)}),d.promise},this.createPracticePlan=function(d){var f=c.defer();if(Common.Utilities.isNotNullOrUndefined(d)){var i=impakt.context.Planning.practicePlans.hasElementWhich(function(a,b){return a.name==d.name});if(i){g.warning('Failed to create practice plan. Practice plan "',d.name,'" already exists.');return void h.createPracticePlanDuplicate(d)}}d.key=-1;var j=d.toJson(),k=g.pending('Creating practice plan "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_PRACTICEPLAN),{version:1,name:d.name,data:{version:1,practicePlan:j}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),d=new Planning.Models.PracticePlan;if(!(c&&c.data&&c.data.practicePlan))throw new Error("createPracticePlan did not return a valid PracticePlan");c.data.practicePlan.key=c.key,d.fromJson(c.data.practicePlan),impakt.context.Planning.practicePlans.add(d,!1),k.success('Successfully created practice plan "',d.name,'"'),b.$broadcast("create-entity",d),f.resolve(d)},function(a){k.error('Failed to create practice plan "',d.name,'"'),f.reject(a)}),f.promise},this.deletePracticePlan=function(b){var d=c.defer(),f=g.pending('Deleting practice plan "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_PRACTICEPLAN),{key:b.key}).then(function(a){impakt.context.Planning.practicePlans.remove(b.guid),f.success('Deleted practice plan "',b.name,'"'),d.resolve(b)},function(a){f.error('Failed to delete practice plan "',b.name,'"'),d.reject(a)}),d.promise},this.updatePracticePlan=function(b){var d=c.defer(),f=b.toJson(),h=g.pending('Updating practice plan "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.UPDATE_PRACTICEPLAN),{version:1,name:f.name,key:f.key,data:{version:1,key:f.key,practicePlan:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=new Planning.Models.PracticePlan;c&&c.data&&c.data.practicePlan&&(e.fromJson(c.data.practicePlan),impakt.context.Planning.practicePlans.set(e.guid,e)),h.success('Successfully updated practice plan "',b.name,'"'),d.resolve(e)},function(a){h.error('Failed to update practice plan "',b.name,'"'),d.reject(a)}),d.promise},this.getGamePlans=function(){var b=c.defer(),d=g.pending("Getting game plans...");return e.get(e.path(a.ENDPOINT,a.GET_GAMEPLANS)).then(function(a){var c=new Planning.Models.GamePlanCollection;if(a&&a.data&&a.data.results)for(var e=Common.Utilities.parseData(a.data.results),f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.gamePlan){var h=new Planning.Models.GamePlan;g.data.gamePlan.key=g.key,h.fromJson(g.data.gamePlan),c.add(h,!1)}}d.success([c.size()," game plans successfully retreived"].join("")),b.resolve(c)},function(a){d.error("Failed to retieve game plans"),console.error(a),b.reject(a)}),b.promise},this.getGamePlan=function(b){var d=c.defer();return e.get(e.path(a.ENDPOINT,a.GET_GAMEPLAN,"/"+b)).then(function(a){var b=Common.Utilities.parseData(a.data.results);d.resolve(b)},function(a){d.reject(a)}),d.promise},this.createGamePlan=function(d){var f=c.defer();if(Common.Utilities.isNotNullOrUndefined(d)){var i=impakt.context.Planning.gamePlans.hasElementWhich(function(a,b){return a.name==d.name});if(i){g.warning('Failed to create game plan. Game plan "',d.name,'" already exists.');return void h.createGamePlanDuplicate(d)}}d.key=-1;var j=d.toJson(),k=g.pending('Creating game plan "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_GAMEPLAN),{version:1,name:d.name,data:{version:1,gamePlan:j}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),d=new Planning.Models.GamePlan;if(!(c&&c.data&&c.data.gamePlan))throw new Error("CreateGamePlan did not return a valid game plan");c.data.gamePlan.key=c.key,d.fromJson(c.data.gamePlan),impakt.context.Planning.gamePlans.add(d,!1),k.success('Successfully created game plan "',d.name,'"'),b.$broadcast("create-entity",d),f.resolve(d)},function(a){k.error('Failed to create game pl an "',d.name,'"'),f.reject(a)}),f.promise},this.deleteGamePlan=function(b){var d=c.defer(),f=g.pending('Deleting game plan "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_GAMEPLAN),{key:b.key}).then(function(a){impakt.context.Planning.gamePlans.remove(b.guid),f.success('Deleted game plan "',b.name,'"'),d.resolve(b)},function(a){f.error('Failed to delete game plan "',b.name,'"'),d.reject(a)}),d.promise},this.updateGamePlan=function(b){var d=c.defer(),f=b.toJson(),h=g.pending('Updating gamePlan "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.UPDATE_GAMEPLAN),{version:1,name:f.name,key:f.key,data:{version:1,key:f.key,gamePlan:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=new Planning.Models.GamePlan;c&&c.data&&c.data.gamePlan&&(e.fromJson(c.data.gamePlan),impakt.context.Planning.gamePlans.set(e.guid,e)),h.success('Successfully updated game plan "',b.name,'"'),d.resolve(e)},function(a){h.error('Failed to update game plan "',b.name,'"'),d.reject(a)}),d.promise},this.getPracticeSchedules=function(){var b=c.defer(),d=g.pending("Getting practice schedules...");return e.get(e.path(a.ENDPOINT,a.GET_PRACTICESCHEDULES)).then(function(a){var c=new Planning.Models.PracticeScheduleCollection;if(a&&a.data&&a.data.results)for(var e=Common.Utilities.parseData(a.data.results),f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.practiceSchedule){var h=new Planning.Models.PracticeSchedule;g.data.practiceSchedule.key=g.key,h.fromJson(g.data.practiceSchedule),c.add(h,!1)}}d.success([c.size()," practice schedules successfully retreived"].join("")),b.resolve(c)},function(a){d.error("Failed to retieve practice schedules"),console.error(a),b.reject(a)}),b.promise},this.getPracticeSchedule=function(b){var d=c.defer();return e.get(e.path(a.ENDPOINT,a.GET_PRACTICESCHEDULE,"/"+b)).then(function(a){var b=Common.Utilities.parseData(a.data.results);d.resolve(b)},function(a){d.reject(a)}),d.promise},this.createPracticeSchedule=function(d){var f=c.defer();if(Common.Utilities.isNotNullOrUndefined(d)){var i=impakt.context.Planning.practiceSchedules.hasElementWhich(function(a,b){return a.name==d.name});if(i){g.warning('Failed to create practice schedule. Practice schedule "',d.name,'" already exists.');return void h.createPracticeScheduleDuplicate(d)}}d.key=-1;var j=d.toJson(),k=g.pending('Creating practiceSchedule "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_PRACTICESCHEDULE),{version:1,name:d.name,data:{version:1,practiceSchedule:j}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),d=new Planning.Models.PracticeSchedule;if(!(c&&c.data&&c.data.practiceSchedule))throw new Error("CreatePracticeSchedule did not return a valid practiceSchedule");c.data.practiceSchedule.key=c.key,d.fromJson(c.data.practiceSchedule),impakt.context.Planning.practiceSchedules.add(d,!1),k.success('Successfully created practice schedule "',d.name,'"'),b.$broadcast("create-entity",d),f.resolve(d)},function(a){k.error('Failed to create practice schedule "',d.name,'"'),f.reject(a)}),f.promise},this.deletePracticeSchedule=function(b){var d=c.defer(),f=g.pending('Deleting practice schedule "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_PRACTICESCHEDULE),{key:b.key}).then(function(a){impakt.context.Planning.practiceSchedules.remove(b.guid),f.success('Deleted practice schedule "',b.name,'"'),d.resolve(b)},function(a){f.error('Failed to delete practice schedule "',b.name,'"'),d.reject(a)}),d.promise},this.updatePracticeSchedule=function(b){var d=c.defer(),f=b.toJson(),h=g.pending('Updating practice schedule "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.UPDATE_PRACTICESCHEDULE),{version:1,name:f.name,key:f.key,data:{version:1,key:f.key,practiceSchedule:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=new Planning.Models.PracticeSchedule;c&&c.data&&c.data.practiceSchedule&&(e.fromJson(c.data.practiceSchedule),impakt.context.Planning.practiceSchedules.set(e.guid,e)),h.success('Successfully updated practice schedule "',b.name,'"'),d.resolve(e)},function(a){h.error('Failed to update practice schedule "',b.name,'"'),d.reject(a)}),d.promise},this.getScoutCards=function(){var b=c.defer(),d=g.pending("Getting scout cards...");return e.get(e.path(a.ENDPOINT,a.GET_SCOUTCARDS)).then(function(a){var c=new Planning.Models.ScoutCardCollection;if(a&&a.data&&a.data.results)for(var e=Common.Utilities.parseData(a.data.results),f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.scoutCard){var h=new Planning.Models.ScoutCard;g.data.scoutCard.key=g.key,h.fromJson(g.data.scoutCard),c.add(h,!1)}}d.success([c.size()," scout cards successfully retreived"].join("")),b.resolve(c)},function(a){d.error("Failed to retieve scout cards"),console.error(a),b.reject(a)}),b.promise},this.getScoutCard=function(b){var d=c.defer();return e.get(e.path(a.ENDPOINT,a.GET_SCOUTCARD,"/"+b)).then(function(a){var b=Common.Utilities.parseData(a.data.results);d.resolve(b)},function(a){d.reject(a)}),d.promise},this.createScoutCard=function(d){var f=c.defer();if(Common.Utilities.isNotNullOrUndefined(d)){var i=impakt.context.Planning.scoutCards.hasElementWhich(function(a,b){return a.name==d.name});if(i){g.warning('Failed to create scout card. Scout card "',d.name,'" already exists.');return void h.createScoutCardDuplicate(d)}}d.key=-1;var j=d.toJson(),k=g.pending('Creating scoutCard "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_SCOUTCARD),{version:1,name:d.name,data:{version:1,scoutCard:j}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),d=new Planning.Models.ScoutCard;if(!(c&&c.data&&c.data.scoutCard))throw new Error("CreateScoutCard did not return a valid scoutCard");c.data.scoutCard.key=c.key,d.fromJson(c.data.scoutCard),impakt.context.Planning.scoutCards.add(d,!1),k.success('Successfully created scout card "',d.name,'"'),b.$broadcast("create-entity",d),f.resolve(d)},function(a){k.error('Failed to create scout card "',d.name,'"'),f.reject(a)}),f.promise},this.deleteScoutCard=function(b){var d=c.defer(),f=g.pending('Deleting scout card "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_SCOUTCARD),{key:b.key}).then(function(a){impakt.context.Planning.scoutCards.remove(b.guid),f.success('Deleted scout card "',b.name,'"'),d.resolve(b)},function(a){f.error('Failed to delete scout card "',b.name,'"'),d.reject(a)}),d.promise},this.updateScoutCard=function(b){var d=c.defer(),f=b.toJson(),h=g.pending('Updating scout card "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.UPDATE_SCOUTCARD),{version:1,name:f.name,key:f.key,data:{version:1,key:f.key,scoutCard:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=new Planning.Models.ScoutCard;c&&c.data&&c.data.scoutCard&&(e.fromJson(c.data.scoutCard),impakt.context.Planning.scoutCards.set(e.guid,e)),h.success('Successfully updated scout card "',b.name,'"'),d.resolve(e)},function(a){h.error('Failed to update scout card "',b.name,'"'),d.reject(a)}),d.promise},this.getQBWristbands=function(){var b=c.defer(),d=g.pending("Getting QB wristbands...");return e.get(e.path(a.ENDPOINT,a.GET_QBWRISTBANDS)).then(function(a){var c=new Planning.Models.QBWristbandCollection;if(a&&a.data&&a.data.results)for(var e=Common.Utilities.parseData(a.data.results),f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.QBWristband){var h=new Planning.Models.QBWristband;g.data.QBWristband.key=g.key,h.fromJson(g.data.QBWristband),c.add(h,!1)}}d.success([c.size()," QB wristbands successfully retreived"].join("")),b.resolve(c)},function(a){d.error("Failed to retieve QB wristbands"),console.error(a),b.reject(a)}),b.promise},this.getQBWristband=function(b){var d=c.defer();return e.get(e.path(a.ENDPOINT,a.GET_QBWRISTBAND,"/"+b)).then(function(a){var b=Common.Utilities.parseData(a.data.results);d.resolve(b)},function(a){d.reject(a)}),d.promise},this.createQBWristband=function(d){var f=c.defer();if(Common.Utilities.isNotNullOrUndefined(d)){var i=impakt.context.Planning.QBWristbands.hasElementWhich(function(a,b){return a.name==d.name});if(i){g.warning('Failed to create QB wristband. QB wristband "',d.name,'" already exists.');return void h.createQBWristbandDuplicate(d)}}d.key=-1;var j=d.toJson(),k=g.pending('Creating QBWristband "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_QBWRISTBAND),{version:1,name:d.name,data:{version:1,QBWristband:j}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),d=new Planning.Models.QBWristband;if(!(c&&c.data&&c.data.QBWristband))throw new Error("CreateQBWristband did not return a valid QBWristband");c.data.QBWristband.key=c.key,d.fromJson(c.data.QBWristband),impakt.context.Planning.QBWristbands.add(d,!1),k.success('Successfully created QB wristband "',d.name,'"'),b.$broadcast("create-entity",d),f.resolve(d)},function(a){k.error('Failed to create QB wristband "',d.name,'"'),f.reject(a)}),f.promise},this.deleteQBWristband=function(b){var d=c.defer(),f=g.pending('Deleting QB wristband "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_QBWRISTBAND),{key:b.key}).then(function(a){impakt.context.Planning.QBWristbands.remove(b.guid),f.success('Deleted QB wristband "',b.name,'"'),d.resolve(b)},function(a){f.error('Failed to delete QB wristband "',b.name,'"'),d.reject(a)}),d.promise},this.updateQBWristband=function(b){var d=c.defer(),f=b.toJson(),h=g.pending('Updating QB wristband "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.UPDATE_QBWRISTBAND),{version:1,name:f.name,key:f.key,data:{version:1,key:f.key,QBWristband:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=new Planning.Models.QBWristband;c&&c.data&&c.data.QBWristband&&(e.fromJson(c.data.QBWristband),impakt.context.Planning.QBWristbands.set(e.guid,e)),h.success('Successfully updated QB wristband "',b.name,'"'),d.resolve(e)},function(a){h.error('Failed to update QB wristband "',b.name,'"'),d.reject(a)}),d.promise},this.deleteEntityByType=function(a){if(!Common.Utilities.isNullOrUndefined(a)){var b=c.defer();switch(a.impaktDataType){case Common.Enums.ImpaktDataTypes.Plan:return h.deletePlan(a);case Common.Enums.ImpaktDataTypes.PracticePlan:return h.deletePracticePlan(a);case Common.Enums.ImpaktDataTypes.GamePlan:return h.deleteGamePlan(a);case Common.Enums.ImpaktDataTypes.PracticeSchedule:return h.deletePracticeSchedule(a);case Common.Enums.ImpaktDataTypes.ScoutCard:return h.deleteScoutCard(a);case Common.Enums.ImpaktDataTypes.QBWristband:return h.deleteQBWristband(a);default:b.reject(new Error("_planning deleteEntityByType: impaktDataType not supported"))}return b.promise}},this.updateEntityByType=function(a){if(!Common.Utilities.isNullOrUndefined(a)){var b=c.defer();switch(a.impaktDataType){case Common.Enums.ImpaktDataTypes.Plan:return h.savePlan(a);case Common.Enums.ImpaktDataTypes.PracticePlan:return h.savePracticePlan(a);case Common.Enums.ImpaktDataTypes.GamePlan:return h.saveGamePlan(a);case Common.Enums.ImpaktDataTypes.PracticeSchedule:return h.savePracticeSchedule(a);case Common.Enums.ImpaktDataTypes.ScoutCard:return h.saveScoutCard(a);case Common.Enums.ImpaktDataTypes.QBWristband:return h.saveQBWristband(a);default:b.reject(new Error("_planning saveEntityByType: impaktDataType not supported"))}return b.promise}},this.toBrowser=function(){d.transitionTo("planning.browser")},this.toPracticePlanEditor=function(a){impakt.context.Planning.editor.practicePlans.add(a,!1),d.transitionTo("planning.editor.practicePlan")},this.toGamePlanEditor=function(a){impakt.context.Planning.editor.gamePlans.add(a,!1),d.transitionTo("planning.editor")},this.toPracticeScheduleEditor=function(a){impakt.context.Planning.editor.practiceSchedules.add(a,!1),d.transitionTo("planning.editor")},this.toScoutCardEditor=function(a){impakt.context.Planning.editor.scoutCards.add(a,!1),d.transitionTo("planning.editor")},this.toQBWristbandEditor=function(a){impakt.context.Planning.editor.QBWristbands.add(a,!1),d.transitionTo("planning.editor")},this.toPlanDrilldown=function(a){this.drilldown.plan=a,impakt.context.Planning.plans.select(a),impakt.context.Actionable.selected.only(a),d.transitionTo("planning.drilldown.plan")}}]),impakt.playbook=angular.module("impakt.playbook",["ui.router","impakt.common","impakt.playbook.contextmenus","impakt.playbook.modals","impakt.playbook.browser","impakt.playbook.drilldown","impakt.playbook.editor","impakt.playbook.layout","impakt.playbook.nav"]).config(["$stateProvider","$urlRouterProvider",function(a,b){console.debug("impakt.playbook - config"),a.state("playbook",{url:"/playbook",templateUrl:"modules/playbook/playbook.tpl.html",controller:"playbook.ctrl"})}]).run([function(){console.debug("impakt.playbook - run")}]),impakt.playbook.browser=angular.module("impakt.playbook.browser",[]).config(["$stateProvider",function(a){console.debug("impakt.playbook.browser - config"),a.state("playbook.browser",{url:"/browser",templateUrl:"modules/playbook/browser/playbook-browser.tpl.html",controller:"playbook.browser.ctrl"
})}]).run(function(){console.debug("impakt.playbook.browser - run")}),impakt.playbook.browser.controller("playbook.browser.ctrl",["$scope","__context","_details","_associations","_playbook","_playbookModals",function(a,b,c,d,e,f){a.editor=impakt.context.Playbook.editor,a.playbooks=impakt.context.Playbook.playbooks,a.test=a.playbooks.first(),c.selectedPlay=null,a.getEditorTypeClass=function(a){return e.getEditorTypeClass(a)},a.openEditor=function(){e.toEditor()},a.createPlaybook=function(){f.createPlaybook()},a.deletePlaybook=function(b){f.deletePlaybook(b).then(function(b){a.goToAll()},function(a){})},a.getAssociationsCountForPlaybook=function(a){var b=d.getAssociated(a);return b.count()}}]),impakt.playbook.browser.service("_playbookBrowser",[function(){}]),impakt.playbook.contextmenus=angular.module("impakt.playbook.contextmenus",["impakt.playbook.contextmenus.routeNode","impakt.playbook.contextmenus.play"]).config(function(){console.debug("impakt.playbook.contextmenus - config")}).run(function(){console.debug("impakt.playbook.contextmenus - run")}),impakt.playbook.contextmenus.play=angular.module("impakt.playbook.contextmenus.play",[]).config(function(){console.debug("impakt.playbook.contextmenus.play - config")}).run(function(){console.debug("impakt.playbook.contextmenus.play - run")}),impakt.playbook.contextmenus.play.controller("impakt.playbook.contextmenus.play.ctrl",["$scope",function(a){}]),impakt.playbook.contextmenus.player=angular.module("impakt.playbook.contextmenus.player",[]).config(function(){console.debug("impakt.playbook.contextmenus.player - config")}).run(function(){console.debug("impakt.playbook.contextmenus.player - run")}),impakt.playbook.contextmenus.player.controller("impakt.playbook.contextmenus.player.ctrl",["$scope",function(a){}]),impakt.playbook.contextmenus.routeNode=angular.module("impakt.playbook.contextmenus.routeNode",[]).config(function(){console.debug("impakt.playbook.contextmenus.routeNode - config")}).run(function(){console.debug("impakt.playbook.contextmenus.routeNode - run")}),impakt.playbook.contextmenus.routeNode.controller("impakt.playbook.contextmenus.routeNode.ctrl",["$scope","_contextmenu",function(a,b){a.routeNode=b.getData()}]),impakt.playbook.drilldown=angular.module("impakt.playbook.drilldown",["impakt.playbook.drilldown.playbook"]).config(["$stateProvider",function(a){console.debug("impakt.playbook.drilldown - config"),a.state("playbook.drilldown",{url:"/drilldown",templateUrl:"modules/playbook/drilldown/playbook-drilldown.tpl.html",controller:"playbook.drilldown.ctrl"})}]).run(function(){console.debug("impakt.playbook.drilldown - run")}),impakt.playbook.drilldown.controller("playbook.drilldown.ctrl",["$scope","_playbook",function(a,b){function c(){Common.Utilities.isNotNullOrUndefined(b.drilldown)&&(a.playbook=b.drilldown.playbook)}a.playbook=null,a.toBrowser=function(){b.toBrowser()},c()}]),impakt.playbook.drilldown.playbook=angular.module("impakt.playbook.drilldown.playbook",[]).config(["$stateProvider",function(a){console.debug("impakt.playbook.drilldown.playbook - config"),a.state("playbook.drilldown.playbook",{url:"/playbook",templateUrl:"modules/playbook/drilldown/playbook/playbook-drilldown-playbook.tpl.html",controller:"playbook.drilldown.playbook.ctrl"})}]).run(function(){console.debug("impakt.playbook.drilldown.playbook - run")}),impakt.playbook.drilldown.playbook.controller("playbook.drilldown.playbook.ctrl",["$scope","$rootScope","_associations","_playbook","_playbookModals",function(a,b,c,d,e){function f(){var b=c.getAssociated(a.playbook);Common.Utilities.isNotNullOrUndefined(b)&&(a.plays=b.plays,a.formations=b.formations,a.scenarios=b.scenarios,a.assignmentGroups=b.assignmentGroups)}a.playbook=d.drilldown.playbook,a.scenarios=impakt.context.Playbook.scenarios,a.plays=impakt.context.Playbook.plays,a.formations=impakt.context.Playbook.formations,a.personnelCollection=impakt.context.Team.personnel,a.assignmentGroups=impakt.context.Playbook.assignmentGroups;var g=b.$on("delete-scenario",function(b,c){a.scenarios.remove(c.guid)}),h=b.$on("delete-play",function(b,c){a.plays.remove(c.guid)}),i=b.$on("delete-formation",function(b,c){a.formations.remove(c.guid)}),j=b.$on("delete-assignmentGroup",function(b,c){a.assignmentGroups.remove(c.guid)}),k=b.$on("associations-updated",function(a){f()});a.$on("$destroy",function(){g(),h(),i(),j(),k()}),a.createScenario=function(){e.createScenario()},a.createPlay=function(){e.createPlay()},a.createFormation=function(){e.createFormation()},a.createAssignmentGroup=function(){},a.alertDataRequired=function(b){a.formations.isEmpty()&&alert("Please create the required base data in order to begin creating "+b+".")},a.toTeam=function(){var a=confirm("You are about to navigate to the Team module. Continue?");a&&d.toTeam()},f()}]),impakt.playbook.editor=angular.module("impakt.playbook.editor",["impakt.playbook.editor.tabs","impakt.playbook.editor.tools","impakt.playbook.editor.mode","impakt.playbook.editor.canvas","impakt.playbook.editor.details","impakt.playbook.editor.applicator"]).config(["$stateProvider",function(a){console.debug("impakt.playbook.editor - config"),a.state("playbook.editor",{url:"/editor",templateUrl:"modules/playbook/editor/playbook-editor.tpl.html",controller:"playbook.editor.ctrl"})}]).run(function(){console.debug("impakt.playbook.editor - run")}),impakt.playbook.editor.applicator=angular.module("impakt.playbook.editor.applicator",[]).config(function(){console.debug("impakt.playbook.editor.applicator - config")}).run(function(){console.debug("impakt.playbook.editor.applicator - run")}),impakt.playbook.editor.applicator.controller("playbook.editor.applicator.ctrl",["$scope","$timeout","_playbookEditor",function(a,b,c){function d(){impakt.context.Playbook.formations.onModified(function(){a.formations=impakt.context.Playbook.formations}),impakt.context.Team.personnel.onModified(function(){a.personnelCollection=impakt.context.Team.personnel}),impakt.context.Playbook.assignmentGroups.onModified(function(){a.assignmentGroups=impakt.context.Playbook.assignmentGroups}),Common.Utilities.isNullOrUndefined(c.canvas)||(c.canvas.state==Common.Enums.State.Ready?e():c.canvas.setListener("ready",f),c.component.loadDependency(h))}function e(){Common.Utilities.isNullOrUndefined(c.canvas.field)||(f(),c.canvas.field.clearListeners(),c.canvas.field.setListener("onload",f,!0),c.canvas.field.setListener("onclear",g,!0))}function f(){if(c.canvas.field.state==Common.Enums.State.Ready){if(a.scenario=c.canvas.field.scenario,Common.Utilities.isNullOrUndefined(a.scenario))return;a.scenario.clearListeners(),a.scenario.onModified(function(){b(function(){a.$apply()},1)})}}function g(){a.scenario=null}var h=new Common.Base.Component("playbook.editor.applicator.ctrl",Common.Base.ComponentType.Controller);a.scenario=new Common.Models.Scenario,a.formations=impakt.context.Playbook.formations,a.personnelCollection=impakt.context.Team.personnel,a.assignmentGroups=impakt.context.Playbook.assignmentGroups,a.editorModeClass="",a.$on("$destroy",function(){}),a.switchToPlayMode=function(){console.log("switch from formation mode to play mode",a.tab.scenario),a.tab.scenario.editorType=Playbook.Enums.EditorTypes.Play},a.getEditorTypeClass=function(a){return c.getEditorTypeClass(parseInt(a))},a.applyFormation=function(a,b){c.applyFormation(a,b)},a.applyPersonnel=function(a,b){c.applyPersonnel(a,b)},a.applyAssignmentGroup=function(a,b){c.applyAssignmentGroup(a,b)},a.flipScenario=function(){c.flipScenario()},a.isNameVisible=function(){return Common.Utilities.isNotNullOrUndefined(a.scenario)},a.isUnitTypeVisible=function(){return Common.Utilities.isNotNullOrUndefined(a.scenario)},a.isFormationVisible=function(){if(Common.Utilities.isNullOrUndefined(a.scenario))return!1;var b=a.scenario.editorType;return b==Playbook.Enums.EditorTypes.Formation||b==Playbook.Enums.EditorTypes.Play||b==Playbook.Enums.EditorTypes.Scenario},a.isPersonnelVisible=function(){if(Common.Utilities.isNullOrUndefined(a.scenario))return!1;var b=a.scenario.editorType;return b==Playbook.Enums.EditorTypes.Assignment||b==Playbook.Enums.EditorTypes.Play||b==Playbook.Enums.EditorTypes.Scenario},a.isAssignmentGroupsVisible=function(){if(Common.Utilities.isNullOrUndefined(a.scenario))return!1;var b=a.scenario.editorType;return b==Playbook.Enums.EditorTypes.Assignment||b==Playbook.Enums.EditorTypes.Play||b==Playbook.Enums.EditorTypes.Scenario},a.isOpponentBarVisible=function(){if(Common.Utilities.isNullOrUndefined(a.scenario))return!1;var b=a.scenario.editorType;return b==Playbook.Enums.EditorTypes.Scenario},a.toBrowser=function(){c.toBrowser()},d()}]),impakt.playbook.editor.canvas=angular.module("impakt.playbook.editor.canvas",[]).config(function(){console.debug("impakt.playbook.editor.canvas - config")}).run(function(){console.debug("impakt.playbook.editor.canvas - run")}),impakt.playbook.editor.canvas.controller("playbook.editor.canvas.ctrl",["$scope","$timeout","_playbookEditor",function(a,b,c){a.tab=c.getActiveTab(),a.tabs=c.tabs,a.hasOpenTabs=c.hasTabs(),Common.Utilities.isNotNullOrUndefined(a.tab)&&a.tab.onclose(function(){a.hasOpenTabs=c.hasTabs()}),Common.Utilities.isNotNullOrUndefined(a.tabs)&&a.tabs.onModified(function(b){a.hasOpenTabs=b.hasElements()})}]).directive("playbookEditorCanvas",["$rootScope","$compile","$templateCache","$timeout","_contextmenu","_playPreview","_playbookEditor","_scrollable",function(a,b,c,d,e,f,g,h){return console.debug("directive: impakt.playbook.editor.canvas - register"),{restrict:"E",controller:"",link:function(a,b,c){console.debug("directive: impakt.playbook.editor.canvas - link");var f=new Common.Base.Component("playbookEditorCanvas",Common.Base.ComponentType.Directive);a.canvas=g.canvas,d(function(){a.canvas&&(a.canvas.setListener("onready",function(){var c=a.canvas.field.getLOSAbsolute()-b.height()/2;b.scrollTop(c),g.refreshScenario()}),a.canvas.initialize(b),a.canvas.listener.listen(Playbook.Enums.Actions.RouteNodeContextmenu,function(a){e.open(a)}))},0),g.component.loadDependency(f)}}}]),impakt.playbook.editor.canvas.service("_playbookEditorCanvas",["$rootScope","$timeout","_base","_contextmenu","_playPreview","_playbook","_playbookEditor",function(a,b,c,d,e,f,g){console.debug("service: impakt.playbook.editor.canvas");this.readyCallbacks=[function(){console.log("canvas ready")}],this.component=new Common.Base.Component("_playbookEditorCanvas",Common.Base.ComponentType.Service,[])}]),impakt.playbook.editor.details=angular.module("impakt.playbook.editor.details",[]).config(function(){console.debug("impakt.playbook.editor.details - config")}).run(function(){console.debug("impakt.playbook.editor.details - run")}),impakt.playbook.editor.details.controller("playbook.editor.details.ctrl",["$scope","$timeout","_playbookModals","_playbookEditorDetails",function(a,b,c,d){a.canvas=d.canvas,a.field,a.grid,a.scenario,a.layers,a.selectedElements,a.players,a.canvas.setListener("onready",function(){a.field=a.canvas.field,a.grid=a.canvas.grid,a.scenario=a.canvas.scenario,a.layers=a.field.layer.layers,a.selectedElements=a.field.selectedElements,a.players=a.field.primaryPlayers,a.field.onModified(function(){b(function(){a.$apply()},0)})}),a.refreshPreview=function(){}}]),impakt.playbook.editor.details.service("_playbookEditorDetails",["_playbookEditor",function(a){console.debug("service: impakt.playbook.browser"),this.canvas=a.canvas,this.closeActiveTab=function(){a.closeTab(a.activeTab)}}]),impakt.playbook.editor.mode=angular.module("impakt.playbook.editor.mode",[]).config(function(){console.debug("impakt.playbook.editor.mode - config")}).run(function(){console.debug("impakt.playbook.editor.mode - run")}),impakt.playbook.editor.mode.controller("playbook.editor.mode.ctrl",["$scope","_playbookEditor",function(a,b){a.canvas=b.canvas,a.canvas.setListener("onready",function(){a.cursorCoordinates=a.canvas.field.cursorCoordinates,a.canvas.field.onModified(function(b){a.cursorCoordinates.x=b.cursorCoordinates.x,a.cursorCoordinates.y=b.cursorCoordinates.y,a.$$phase||a.$apply()})})}]),impakt.playbook.editor.controller("playbook.editor.ctrl",["$scope","$stateParams","_playbookEditor",function(a,b,c){a.canvas=c.canvas,c.init();var d="modules/playbook/editor/";a.templates={tools:[d,"tools/playbook-editor-tools.tpl.html"].join(""),tabs:[d,"tabs/playbook-editor-tabs.tpl.html"].join(""),canvas:[d,"canvas/playbook-editor-canvas.tpl.html"].join(""),mode:[d,"mode/playbook-editor-mode.tpl.html"].join(""),applicator:[d,"applicator/playbook-editor-applicator.tpl.html"].join("")},a.toBrowser=function(){c.toBrowser()}}]),impakt.playbook.editor.service("_playbookEditor",["$rootScope","$q","_base","_associations","_playbook","_playbookModals",function(a,b,c,d,e,f){console.debug("service: impakt.playbook.editor");var g=this;this.component=new Common.Base.Component("_playbookEditor",Common.Base.ComponentType.Service,["_playbookEditorTools","playbookEditorCanvas","playbook.editor.applicator.ctrl"]),this.tabs=impakt.context.Playbook.editor.tabs,this.scenarios=impakt.context.Playbook.editor.scenarios,this.activeTab=null,this.canvas=null,this.toolMode=Playbook.Enums.ToolModes[Playbook.Enums.ToolModes.None],a.$on("playbook-editor.refresh",function(a,b){g.scenarios=impakt.context.Playbook.editor.scenarios,g.loadTabs()}),this.readyCallback=function(){console.log("Playbook editor ready default callback")};var h=!1;this.ready=function(){this.readyCallback()},this.init=function(){h=!0,(g.tabs.isEmpty()||g.tabs.size()!=g.scenarios.size())&&g.loadTabs(),g.canvas||(g.canvas=new Playbook.Models.EditorCanvas),g.canvas.clearListeners(),g.canvas.setListener("onready",function(){g.loadTabs(),g.tabs.forEach(function(a,b){if(a.active){var c=g.scenarios.filterFirst(function(b,c){return b.guid==a.scenario.guid});g.loadScenario(c)}}),g.ready()}),c.loadComponent(g.component)},this.onready=function(a){this.readyCallback=a},this.getEditorType=function(){return this.editorType},this.loadTabs=function(){this.scenarios.forEach(function(a,b){var c=!1;if(g.tabs.forEach(function(b,d){b.scenario.guid==a.guid&&(c=!0)}),!c){var d=new Common.Models.Tab(a);d.active=0==b,g.addTab(d)}})},this.addTab=function(a){return this.tabs.contains(a.guid)?void this.activateTab(a,!0):(this.tabs.add(a,!1),void this.activateTab(a,!1))},this.activateTab=function(a){this.inactivateOtherTabs(a),a.active=!0,this.activeTab=a,this.canvas&&this.loadScenario(this.activeTab.scenario)},this.closeTab=function(a){this.tabs.close(a),this.scenarios.remove(a.scenario.guid),this.tabs.hasElements()?this.activateTab(this.tabs.getLast()):(this.activeTab=null,this.canvas.clear()),a.close()},this.inactivateOtherTabs=function(a){this.tabs.forEach(function(b,c){b.guid!=a.guid&&(b.active=!1)})},this.hasTabs=function(){return this.tabs.hasElements()},this.getEditorTypeClass=function(a){return e.getEditorTypeClass(a)},this.refreshScenario=function(){Common.Utilities.isNotNullOrUndefined(this.activeTab)&&this.loadScenario(this.activeTab.scenario)},this.loadScenario=function(a){Common.Utilities.isNotNullOrUndefined(this.canvas)&&Common.Utilities.isNotNullOrUndefined(this.canvas.field)&&this.canvas.field.updateScenario(a)},this.flipScenario=function(){Common.Utilities.isNotNullOrUndefined(this.canvas)&&(this.canvas.field.primaryPlayers.forEach(function(a,b){a.flip()}),this.canvas.field.opponentPlayers.forEach(function(a,b){a.flip()}))},this.toggleMenu=function(){},this.addPlayer=function(){a.$broadcast("playbook-editor-canvas.addPlayer")},this.save=function(){var a=this.activeTab;if(Common.Utilities.isNotNullOrUndefined(a)){var b=a.scenario;switch(b.editorType){case Playbook.Enums.EditorTypes.Formation:f.saveFormation(b.playPrimary);break;case Playbook.Enums.EditorTypes.Play:f.savePlay(b.playPrimary);break;case Playbook.Enums.EditorTypes.Scenario:f.saveScenario(b)}}},this.zoomIn=function(){a.$broadcast("playbook-editor-canvas.zoomIn")},this.zoomOut=function(){a.$broadcast("playbook-editor-canvas.zoomOut")},this.setCursor=function(a){this.canvas&&this.canvas.$container&&this.canvas.$container.css({cursor:a})},this.setToolMode=function(a){console.log("Change editor tool mode: ",a,Playbook.Enums.ToolModes[a]),this.canvas&&(this.canvas.toolMode=a,this.toolMode=Playbook.Enums.ToolModes[a])},this.toBrowser=function(){e.toBrowser()},this.editScenario=function(a){e.editScenario(a),this.loadTabs()},this.editPlay=function(a){e.editPlay(a),this.loadTabs()},this.editFormation=function(a){e.editFormation(a),this.loadTabs()},this.applyFormation=function(a,b){Common.Utilities.isNotNullOrUndefined(this.canvas)&&Common.Utilities.isNotNullOrUndefined(this.canvas.field)&&this.canvas.field.applyFormation(a,b)},this.applyPersonnel=function(a,b){Common.Utilities.isNotNullOrUndefined(this.canvas)&&Common.Utilities.isNotNullOrUndefined(this.canvas.field)&&this.canvas.field.applyPersonnel(a,b)},this.applyAssignmentGroup=function(a,b){Common.Utilities.isNotNullOrUndefined(this.canvas)&&Common.Utilities.isNotNullOrUndefined(this.canvas.field)&&this.canvas.field.applyAssignmentGroup(a,b)},a.$on("playbook-editor.loadTabs",function(a,b){g.loadTabs()})}]),impakt.playbook.editor.tabs=angular.module("impakt.playbook.editor.tabs",["impakt.playbook.editor.canvas"]).config(function(){console.debug("impakt.playbook.editor.tabs - config")}).run(function(){console.debug("impakt.playbook.editor.tabs - run")}),impakt.playbook.editor.tabs.controller("playbook.editor.tabs.ctrl",["$scope","_base","_playbookModals","_playbookEditor",function(a,b,c,d){a.tabs=d.tabs,a.getEditorTypeClass=function(a){return d.getEditorTypeClass(parseInt(a))},a["new"]=function(){c.openNewEditorTab()},a.close=function(a){var b=confirm("Are you sure you want to close?");b&&d.closeTab(a)},a.activate=function(a){d.activateTab(a,!0)},a.toBrowser=function(){d.toBrowser()}}]),impakt.playbook.editor.tools=angular.module("impakt.playbook.editor.tools",[]).config(function(){console.debug("impakt.playbook.editor.tools - config")}).run(function(){console.debug("impakt.playbook.editor.tools - run")}),impakt.playbook.editor.tools.controller("playbook.editor.tools.ctrl",["$scope","$rootScope","_playbookEditorTools",function(a,b,c){function d(a){c.component.loadDependency(a.component)}console.debug("controller: playbook.editor.tools"),this.component=new Common.Base.Component("playbook.editor.tools.ctrl",Common.Base.ComponentType.Controller),a.tools=c.tools,a.expanded=!1,a.toolClick=function(a){c.invoke(a)},b.$on("playbook-editor-canvas.toggleMenu",function(b,c){a.expanded=!a.expanded}),d(this)}]),impakt.playbook.editor.tools.service("_playbookEditorTools",["$rootScope","_base","_playbookEditor",function(a,b,c){function d(a){c.component.loadDependency(a.component)}console.debug("service: impakt.Playbook.Models.tools"),this.component=new Common.Base.Component("_playbookEditorTools",Common.Base.ComponentType.Service,["Playbook.Models.tools.ctrl"]),this.tools=[new Playbook.Models.Tool("Toggle menu",Playbook.Enums.ToolActions.ToggleMenu,"menu-hamburger"),new Playbook.Models.Tool("Save",Playbook.Enums.ToolActions.Save,"floppy-disk"),new Playbook.Models.Tool("Select",Playbook.Enums.ToolActions.Select,"hand-up","Select",Common.Enums.CursorTypes.pointer,Playbook.Enums.ToolModes.Select,!0),new Playbook.Models.Tool("Assignment",Playbook.Enums.ToolActions.Assignment,"screenshot","",Common.Enums.CursorTypes.crosshair,Playbook.Enums.ToolModes.Assignment)],this.deselectAll=function(){for(var a=0;a<this.tools.length;a++)this.tools[a].selected=!1},this.invoke=function(a){switch(this.deselectAll(),a.selected=!0,a.action){case Playbook.Enums.ToolActions.Select:break;case Playbook.Enums.ToolActions.ToggleMenu:this.toggleMenu();break;case Playbook.Enums.ToolActions.AddPlayer:this.addPlayer();break;case Playbook.Enums.ToolActions.Save:this.save();break;case Playbook.Enums.ToolActions.ZoomIn:this.zoomIn();break;case Playbook.Enums.ToolActions.ZoomOut:this.zoomOut();break;case Playbook.Enums.ToolActions.Assignment:}this.setCursor(a.cursor),this.setToolMode(a.mode)},this.toggleMenu=function(){a.$broadcast("playbook-editor-canvas.toggleMenu")},this.addPlayer=function(){c.addPlayer()},this.save=function(){c.save()},this.zoomIn=function(){c.zoomIn()},this.zoomOut=function(){c.zoomOut()},this.setCursor=function(a){c.setCursor(a)},this.setToolMode=function(a){c.setToolMode(a)},d(this)}]),impakt.playbook.layout=angular.module("impakt.playbook.layout",[]).config(["$stateProvider",function(a){console.debug("impakt.playbook.layout - config"),a.state("playbook.layout",{url:"/layout",views:{sidebar:{},main:{templateUrl:"modules/playbook/layout/playbook-layout.tpl.html"},details:{}}})}]).run(function(){console.debug("impakt.playbook.layout - run")}),impakt.playbook.modals=angular.module("impakt.playbook.modals",[]).config(function(){console.debug("impakt.playbook.modals - config")}).run(function(){console.debug("impakt.playbook.modals - run")}),impakt.playbook.modals.controller("playbook.modals.createFormation.ctrl",["$scope","$uibModalInstance","_associations","_playbook",function(a,b,c,d){function e(){Common.Utilities.isNotNullOrUndefined(a.play.formation)&&impakt.context.Playbook.creation.formations.remove(a.play.formation.guid)}function f(){Common.Utilities.isNotNullOrUndefined(a.play.formation)&&a.formations.remove(a.play.formation.guid)}a.unitTypeCollection=impakt.context.Team.unitTypes,a.selectedUnitType=a.unitTypeCollection.getByUnitType(Team.Enums.UnitTypes.Offense).toJson(),a.playbooks=impakt.context.Playbook.playbooks,a.play=new Common.Models.PlayPrimary(a.selectedUnitType.unitType),a.play.formation=new Common.Models.Formation(a.selectedUnitType.unitType),a.formations=impakt.context.Playbook.formations,a.selectedPlaybook=a.playbooks.first(),a.formations.add(a.play.formation),a.selectedBaseFormation=a.play.formation,impakt.context.Playbook.creation.plays.add(a.play),a.selectedPlaybook,a.selectPlaybook=function(b){a.selectedPlaybook=b},a.selectBaseFormation=function(b){""!=a.selectedBaseFormation&&Common.Utilities.isNotNullOrUndefined(a.selectedBaseFormation)&&a.play.formation.setPlacements(a.selectedBaseFormation.placements)},a.selectUnitType=function(){a.play.setUnitType(a.selectedUnitType.unitType)},a.ok=function(){a.play.formation.parentRK=1,d.createFormation(a.play.formation).then(function(d){c.createAssociation(d,a.selectedPlaybook),e(),b.close(d)},function(a){e(),f(),b.close(a)})},a.cancel=function(){e(),f(),b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.createPlay.ctrl",["$scope","$uibModalInstance","_associations","_playbook",function(a,b,c,d){function e(){Common.Utilities.isNotNullOrUndefined(a.newPlay)&&impakt.context.Playbook.creation.plays.remove(a.newPlay.guid)}a.unitTypeCollection=impakt.context.Team.unitTypes,a.playbooks=impakt.context.Playbook.playbooks,a.formations=impakt.context.Playbook.formations,a.assignmentGroups=impakt.context.Playbook.assignmentGroups,a.selectedPlaybook=a.playbooks.first(),a.selectedFormation=a.formations.first(),a.selectedAssignmentGroup=null,a.personnelCollection=impakt.context.Team.personnel,a.selectedPersonnel=a.personnelCollection.first(),a.selectedUnitType=a.unitTypeCollection.getByUnitType(a.selectedPersonnel.unitType).toJson(),a.newPlay=new Common.Models.PlayPrimary(a.selectedUnitType.unitType),a.newPlay.setFormation(a.selectedFormation),a.newPlay.setAssignmentGroup(a.selectedAssignmentGroup),a.newPlay.setPersonnel(a.selectedPersonnel),impakt.context.Playbook.creation.plays.add(a.newPlay),a.selectUnitType=function(){a.newPlay.unitType=a.selectedUnitType.unitType},a.selectPlaybook=function(b){a.newPlay.setPlaybook(a.playbooks.get(b.guid))},a.selectFormation=function(b){a.newPlay.setFormation(a.formations.get(b.guid))},a.selectAssignmentGroup=function(b){Common.Utilities.isNotNullOrUndefined(b)?a.newPlay.setAssignmentGroup(a.assignmentGroups.get(b.guid)):a.newPlay.setAssignmentGroup(null)},a.selectPersonnel=function(b){a.newPlay.setPersonnel(a.personnelCollection.get(b.guid)),a.selectedUnitType=a.unitTypeCollection.getByUnitType(b.unitType),a.selectUnitType(a.selectedUnitType)},a.ok=function(){d.createPlay(a.newPlay).then(function(d){c.createAssociations(d,[a.selectedPlaybook,a.selectedFormation,a.selectedPersonnel,a.selectedAssignmentGroup]),e(),b.close(d)},function(a){e(),console.error(a),b.close(a)})},a.cancel=function(){e(),b.dismiss()},a.toTeam=function(){var b=confirm("You are about to navigate to the Team module. Continue?");b&&(a.cancel(),d.toTeam())}}]),impakt.playbook.modals.controller("playbook.modals.createPlaybookDuplicateError.ctrl",["$scope","$uibModalInstance","_playbook","playbook",function(a,b,c,d){a.playbook=d,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.createPlaybook.ctrl",["$scope","$uibModalInstance","_playbook",function(a,b,c){a.unitTypeCollection=impakt.context.Team.unitTypes,a.selectedUnitType=a.unitTypeCollection.getByUnitType(Team.Enums.UnitTypes.Offense),a.newPlaybookModel=new Common.Models.PlaybookModel(a.selectedUnitType),a.ok=function(){a.newPlaybookModel.unitType=a.selectedUnitType.unitType,c.createPlaybook(a.newPlaybookModel).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.createScenario.ctrl",["$scope","$uibModalInstance","_associations","_playbook",function(a,b,c,d){function e(){Common.Utilities.isNotNullOrUndefined(a.newScenario)&&impakt.context.Playbook.creation.scenarios.remove(a.newScenario.guid)}a.newScenario=new Common.Models.Scenario,a.playbooks=impakt.context.Playbook.playbooks,a.plays=impakt.context.Playbook.plays,a.selectedPlaybook=a.playbooks.first(),a.selectedPrimaryPlay=null,a.selectedOpponentPlay=null,impakt.context.Playbook.creation.scenarios.add(a.newScenario),a.selectPlaybook=function(b){a.newPlay.setPlaybook(a.playbooks.get(b.guid))},a.selectPrimaryPlay=function(b){d.setPlayAssociations(a.selectedPrimaryPlay),a.newScenario.setPlayPrimary(a.selectedPrimaryPlay)},a.selectOpponentPlay=function(b){d.setPlayAssociations(a.selectedOpponentPlay),a.newScenario.setPlayOpponent(a.selectedOpponentPlay)},a.ok=function(){d.createScenario(a.newScenario).then(function(d){c.createAssociations(d,[a.selectedPlaybook,a.selectedPrimaryPlay,a.selectedOpponentPlay]),e(),b.close(d)},function(a){e(),console.error(a),b.close(a)})},a.cancel=function(){e(),b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.deleteAssignmentGroup.ctrl",["$scope","$uibModalInstance","_playbook","assignmentGroup",function(a,b,c,d){a.assignmentGroup=d,a.ok=function(){c.deleteAssignmentGroup(a.assignmentGroup).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.deleteFormation.ctrl",["$scope","$uibModalInstance","_playbook","formation",function(a,b,c,d){a.formation=d,a.ok=function(){c.deleteFormation(a.formation).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.deletePlay.ctrl",["$scope","$uibModalInstance","_playbook","play",function(a,b,c,d){a.play=d,a.ok=function(){c.deletePlay(a.play).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.deletePlaybook.ctrl",["$scope","$uibModalInstance","_playbook","playbook",function(a,b,c,d){a.playbook=d,a.ok=function(){c.deletePlaybook(a.playbook).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.deleteScenario.ctrl",["$scope","$uibModalInstance","_playbook","scenario",function(a,b,c,d){a.scenario=d,a.ok=function(){c.deleteScenario(a.scenario).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.newEditor.ctrl",["$scope","$uibModalInstance","_playbookEditor","data",function(a,b,c,d){a.scenarios=impakt.context.Playbook.scenarios,a.plays=impakt.context.Playbook.plays,a.formations=impakt.context.Playbook.formations,a.selectedScenario=a.scenarios.first(),a.selectedPlay=a.plays.first(),a.selectedFormation=a.formations.first(),a.editScenarioSelected=!1,a.editPlaySelected=!1,a.editFormationSelected=!1,a.selectScenario=function(){},a.selectPlay=function(){},a.selectFormation=function(){},a.editScenario=function(){a.editScenarioSelected=!0,a.editPlaySelected=!1,a.editFormationSelected=!1,a.selectedPlay=null,a.selectedFormation=null},a.editPlay=function(){a.editScenarioSelected=!1,a.editPlaySelected=!0,a.editFormationSelected=!1,a.selectedScenario=null,a.selectedFormation=null},a.editFormation=function(){a.editScenarioSelected=!1,a.editPlaySelected=!1,a.editFormationSelected=!0,a.selectedScenario=null,a.selectedPlay=null},a.ok=function(){a.selectedScenario&&c.editScenario(a.selectedScenario),a.selectedPlay&&c.editPlay(a.selectedPlay),a.selectedFormation&&c.editFormation(a.selectedFormation),b.close()},a.cancel=function(){b.dismiss()}}]),impakt.playbook.modals.service("_playbookModals",["$q","__modals",function(a,b){this.createPlaybook=function(){var c=a.defer();console.log("create playbook");var d=b.open("","modules/playbook/modals/create-playbook/create-playbook.tpl.html","playbook.modals.createPlaybook.ctrl",{});return d.result.then(function(a){console.log(a),c.resolve()},function(a){console.log("dismissed"),c.reject()}),c.promise},this.createPlaybookDuplicate=function(c){var d=a.defer(),e=b.open("","modules/playbook/modals/create-playbook-duplicate-error/create-playbook-duplicate-error.tpl.html","playbook.modals.createPlaybookDuplicateError.ctrl",{playbook:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deletePlaybook=function(c){var d=a.defer(),e=b.open("","modules/playbook/modals/delete-playbook/delete-playbook.tpl.html","playbook.modals.deletePlaybook.ctrl",{playbook:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.updatePlaybook=function(c){var d=a.defer(),e=b.open("","modules/playbook/modals/update-playbook/update-playbook.tpl.html","playbook.modals.updatePlaybook.ctrl",{playbook:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createScenario=function(){var c=a.defer();console.log("create scenario");var d=b.open("lg","modules/playbook/modals/create-scenario/create-scenario.tpl.html","playbook.modals.createScenario.ctrl",{});return d.result.then(function(a){console.log(a),c.resolve()},function(a){console.log("dismissed"),c.reject()}),c.promise},this.saveScenario=function(c){var d=a.defer(),e=b.open("lg","modules/playbook/modals/save-scenario/save-scenario.tpl.html","playbook.modals.saveScenario.ctrl",{scenario:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deleteScenario=function(c){var d=a.defer(),e=b.open("","modules/playbook/modals/delete-scenario/delete-scenario.tpl.html","playbook.modals.deleteScenario.ctrl",{scenario:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.updateScenario=function(c){var d=a.defer(),e=b.open("","modules/playbook/modals/update-scenario/update-scenario.tpl.html","playbook.modals.updateScenario.ctrl",{scenario:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createPlay=function(){var c=a.defer();console.log("create play");var d=b.open("lg","modules/playbook/modals/create-play/create-play.tpl.html","playbook.modals.createPlay.ctrl",{});
return d.result.then(function(a){console.log(a),c.resolve()},function(a){console.log("dismissed"),c.reject()}),c.promise},this.savePlay=function(c){var d=a.defer(),e=b.open("lg","modules/playbook/modals/save-play/save-play.tpl.html","playbook.modals.savePlay.ctrl",{play:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deletePlay=function(c){var d=a.defer(),e=b.open("","modules/playbook/modals/delete-play/delete-play.tpl.html","playbook.modals.deletePlay.ctrl",{play:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.updatePlay=function(c){var d=a.defer(),e=b.open("","modules/playbook/modals/update-play/update-play.tpl.html","playbook.modals.updatePlay.ctrl",{play:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createFormation=function(){var c=a.defer(),d=b.open("lg","modules/playbook/modals/create-formation/create-formation.tpl.html","playbook.modals.createFormation.ctrl",{});return d.result.then(function(a){c.resolve()},function(a){c.reject()}),c.promise},this.saveFormation=function(c){var d=a.defer(),e=b.open("lg","modules/playbook/modals/save-formation/save-formation.tpl.html","playbook.modals.saveFormation.ctrl",{play:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deleteFormation=function(c){var d=a.defer(),e=b.open("","modules/playbook/modals/delete-formation/delete-formation.tpl.html","playbook.modals.deleteFormation.ctrl",{formation:function(){return c}});return e.result.then(function(a){d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.updateFormation=function(c){var d=a.defer(),e=b.open("","modules/playbook/modals/update-formation/update-formation.tpl.html","playbook.modals.updateFormation.ctrl",{formation:function(){return c}});return e.result.then(function(a){d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deleteAssignmentGroup=function(c){var d=a.defer(),e=b.open("","modules/playbook/modals/delete-assignmentGroup/delete-assignmentGroup.tpl.html","playbook.modals.deleteAssignmentGroup.ctrl",{assignmentGroup:function(){return c}});return e.result.then(function(a){d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.updateAssignmentGroup=function(c){var d=a.defer(),e=b.open("","modules/playbook/modals/update-assignmentGroup/update-assignmentGroup.tpl.html","playbook.modals.updateAssignmentGroup.ctrl",{assignmentGroup:function(){return c}});return e.result.then(function(a){d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.openNewEditorTab=function(){var c=a.defer();console.log("new editor tab");var d=b.open("","modules/playbook/modals/new-editor/new-editor.tpl.html","playbook.modals.newEditor.ctrl",{data:function(){return 1}});return d.result.then(function(a){console.log(a),c.resolve()},function(a){console.log("dismissed"),c.reject()}),c.promise}}]),impakt.playbook.modals.controller("playbook.modals.saveFormation.ctrl",["$scope","$uibModalInstance","_playbook","play",function(a,b,c,d){function e(){}a.play=d.copy(),a.playbooks=impakt.context.Playbook.playbooks,a.formation=d.formation.copy(),a.play.formation=a.formation,a.copyFormation=!1,a.associatedPlaybook;var f=a.formation.key,g=a.formation.name,h=a.formation.guid;a.copyFormationChange=function(){a.formation.key=a.copyFormation?-1:f,a.formation.name=a.copyFormation?a.formation.name+" (copy)":g,a.formation.guid=a.copyFormation?Common.Utilities.guid():h},a.ok=function(){var d={formation:{action:Common.API.Actions.Overwrite}};Common.Utilities.isNullOrUndefined(a.formation.key)&&(d.formation.action=Common.API.Actions.Create),a.copyFormation&&(d.formation.action=Common.API.Actions.Copy),c.saveFormation(a.formation,d).then(function(d){if(a.copyFormation){var e=impakt.context.Playbook.formations.get(d.guid);e&&c.editFormation(e)}console.log(d),b.close(d)},function(a){console.error(a),b.close(a)})},a.cancel=function(){a.formation.key=f,a.formation.name=g,b.dismiss()},e()}]),impakt.playbook.modals.controller("playbook.modals.savePlay.ctrl",["$scope","$uibModalInstance","_playbook","play",function(a,b,c,d){a.play=d.copy();var e=new Playbook.Models.PlaybookAPIOptions;a.copyPlay=!1,a.copyFormation=!1,a.copyPersonnel=!1,a.copyAssignmentGroup=!1;var f=a.play.key,g=a.play.formation.key,h=a.play.assignmentGroup.key;a.copyPlayChange=function(){a.play.key=a.copyPlay?-1:f},a.copyFormationChange=function(){a.play.formation.key=a.copyFormation?-1:g},a.copyAssignmentGroupChange=function(){a.play.assignmentGroup.key=a.copyAssignmentGroup?-1:h},a.ok=function(){var d=a.play;e.play=Common.API.Actions.Overwrite,e.formation=Common.API.Actions.Overwrite,e.assignmentGroup=c.getAssignmentGroupAPIActions(a.play.assignmentGroup),a.play&&a.copyPlay&&(f=a.play.key,a.play.key=-1,e.play=Common.API.Actions.Copy,d=a.play),a.play.formation&&a.copyFormation&&(g=a.play.formation.key,a.play.formation.key=-1,e.formation=Common.API.Actions.Copy,d.formation=a.formation),a.play.assignmentGroup&&a.copyAssignmentGroup&&(h=a.play.assignmentGroup.key,a.play.assignmentGroup.key=-1,e.assignmentGroup=Common.API.Actions.Copy,d.assignmentGroup=a.assignmentGroup),c.savePlay(d,e).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.saveScenario.ctrl",["$scope","$uibModalInstance","_playbook","scenario",function(a,b,c,d){a.scenario=d.copy();var e=new Playbook.Models.PlaybookAPIOptions,f=new Playbook.Models.PlaybookAPIOptions;a.ok=function(){Common.Utilities.isNotNullOrUndefined(a.scenario.playPrimary)&&(e.play=Common.API.Actions.Overwrite,e.formation=Common.API.Actions.Overwrite,e.assignmentGroup=c.getAssignmentGroupAPIActions(a.scenario.playPrimary.assignmentGroup)),Common.Utilities.isNotNullOrUndefined(a.scenario.playOpponent)&&(f.play=Common.API.Actions.Overwrite,f.formation=Common.API.Actions.Overwrite,f.assignmentGroup=c.getAssignmentGroupAPIActions(a.scenario.playOpponent.assignmentGroup)),c.saveScenario(d,e,f).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)}),b.close(null)},a.cancel=function(){b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.updateAssignmentGroup.ctrl",["$scope","$uibModalInstance","_playbook","assignmentGroup",function(a,b,c,d){a.assignmentGroup=d,a.ok=function(){c.updateAssignmentGroup(a.assignmentGroup).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.updateFormation.ctrl",["$scope","$uibModalInstance","_playbook","formation",function(a,b,c,d){a.formation=d,a.ok=function(){c.updateFormation(a.formation).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.updatePlay.ctrl",["$scope","$uibModalInstance","_playbook","play",function(a,b,c,d){a.play=d,a.ok=function(){c.updatePlay(a.play).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.updatePlaybook.ctrl",["$scope","$uibModalInstance","_playbook","playbook",function(a,b,c,d){a.playbook=d,a.ok=function(){c.updatePlaybook(a.playbook).then(function(a){b.close(a)},function(a){b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.playbook.modals.controller("playbook.modals.updateScenario.ctrl",["$scope","$uibModalInstance","_playbook","scenario",function(a,b,c,d){a.scenario=d,a.ok=function(){c.updateScenario(a.scenario).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.playbook.nav=angular.module("impakt.playbook.nav",[]).config(function(){console.debug("impakt.playbook.nav - config")}).run(function(){console.debug("impakt.playbook.nav - run")}),impakt.playbook.nav.controller("playbook.nav.ctrl",["$scope","$location","_playbook","_playbookNav",function(a,b,c,d){}]),impakt.playbook.nav.service("_playbookNav",["__nav","_playbook",function(a,b){console.log("_playbookNav (component service)")}]),impakt.playbook.constant("PLAYBOOK",{ENDPOINT:"/playbook",CREATE_PLAYBOOK:"/createPlaybook",GET_PLAYBOOKS:"/getPlaybooks",GET_PLAYBOOK:"/getPlaybook",DELETE_PLAYBOOK:"/deletePlaybook",UPDATE_PLAYBOOK:"/updatePlaybook",CREATE_FORMATION:"/createFormation",GET_FORMATIONS:"/getFormations",GET_FORMATION:"/getFormation",DELETE_FORMATION:"/deleteFormation",UPDATE_FORMATION:"/updateFormation",CREATE_ASSIGNMENTGROUP:"/createAssignmentGroup",GET_ASSIGNMENTGROUPS:"/getAssignmentGroups",UPDATE_ASSIGNMENTGROUP:"/updateAssignmentGroup",DELETE_ASSIGNMENTGROUP:"/deleteAssignmentGroup",CREATE_PLAY:"/createPlay",UPDATE_PLAY:"/updatePlay",GET_PLAY:"/getPlay",GET_PLAYS:"/getPlays",DELETE_PLAY:"/deletePlay",CREATE_SCENARIO:"/createScenario",UPDATE_SCENARIO:"/updateScenario",GET_SCENARIO:"/getScenario",GET_SCENARIOS:"/getScenarios",DELETE_SCENARIO:"/deleteScenario"}),impakt.playbook.controller("playbook.ctrl",["$scope","$state","$stateParams","_playbook",function(a,b,c,d){}]),impakt.playbook.service("_playbook",["PLAYBOOK","$rootScope","$q","$state","__api","__localStorage","__notifications","_associations","_playbookModals",function(a,b,c,d,e,f,g,h,i){var j=this;this.drilldown={playbook:null},this.getPlaybooks=function(){var b=c.defer(),d=g.pending("Getting playbooks...");return e.get(e.path(a.ENDPOINT,a.GET_PLAYBOOKS)).then(function(a){var c=new Common.Models.PlaybookModelCollection(Team.Enums.UnitTypes.Mixed);if(a&&a.data&&a.data.results)for(var e=Common.Utilities.parseData(a.data.results),f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.model){var h=new Common.Models.PlaybookModel(Team.Enums.UnitTypes.Other);g.data.model.key=g.key,h.fromJson(g.data.model),c.add(h,!1)}}d.success([c.size()," Playbooks successfully retreived"].join("")),b.resolve(c)},function(a){d.error("Failed to retieve Playbooks"),console.error(a),b.reject(a)}),b.promise},this.getPlaybook=function(b){var d=c.defer();return e.get(e.path(a.ENDPOINT,a.GET_PLAYBOOK,"/"+b)).then(function(a){var b=Common.Utilities.parseData(a.data.results);d.resolve(b)},function(a){d.reject(a)}),d.promise},this.createPlaybook=function(d){var f=c.defer();if(Common.Utilities.isNotNullOrUndefined(d)){var h=impakt.context.Playbook.playbooks.hasElementWhich(function(a,b){return a.name==d.name});if(h){g.warning('Failed to create playbook. Playbook "',d.name,'" already exists.');return void i.createPlaybookDuplicate(d)}}d.key=-1;var j=d.toJson(),k=g.pending('Creating playbook "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_PLAYBOOK),{version:1,name:d.name,data:{version:1,model:j}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=new Common.Models.PlaybookModel(d.unitType);if(!(c&&c.data&&c.data.model))throw new Error("CreatePlaybook did not return a valid playbook model");c.data.model.key=c.key,e.fromJson(c.data.model),impakt.context.Playbook.playbooks.add(e,!1),k.success('Successfully created playbook "',e.name,'"'),b.$broadcast("create-entity",e),f.resolve(e)},function(a){k.error('Failed to create playbook "',d.name,'"'),f.reject(a)}),f.promise},this.deletePlaybook=function(b){var d=c.defer(),f=g.pending('Deleting playbook "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_PLAYBOOK),{key:b.key}).then(function(a){impakt.context.Playbook.playbooks.remove(b.guid),f.success('Deleted playbook "',b.name,'"'),h.deleteAssociations(b.associationKey),d.resolve(b)},function(a){f.error('Failed to delete playbook "',b.name,'"'),d.reject(a)}),d.promise},this.updatePlaybook=function(b){var d=c.defer(),f=g.pending('Updating playbook "',b.name,'"...'),h=b.toJson();return e.post(e.path(a.ENDPOINT,a.UPDATE_PLAYBOOK),{version:1,name:b.name,key:b.key,data:{version:1,name:b.name,key:b.key,model:h}}).then(function(a){var b=Common.Utilities.parseData(a.data.results),c=new Common.Models.PlaybookModel(Team.Enums.UnitTypes.Other);b&&b.data&&b.data.model&&(c.fromJson(b.data.model),impakt.context.Playbook.playbooks.set(c.guid,c)),f.success('Successfully updated playbook "',c.name,'"'),d.resolve(c)},function(a){f.error('Failed to update playbook "',b.name,'"'),d.reject(a)}),d.promise},this.createFormation=function(d){var f=c.defer();if(d.key>0)throw new Error("The formation you are trying to create already exists (key > 0) key: "+d.key);var h=g.pending('Creating formation "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_FORMATION),{version:1,name:d.name,ownerRK:1,parentRK:1,data:{version:1,name:d.name,ownerRK:1,parentRK:1,formation:d.toJson()}}).then(function(a){var c=Common.Utilities.parseData(a.data.results);c&&c.data&&c.data.formation||f.reject("Create playbook result was invalid");var d=new Common.Models.Formation(Team.Enums.UnitTypes.Other);c.data.formation.key=c.key,d.fromJson(c.data.formation),console.log(d),impakt.context.Playbook.formations.add(d,!1),h.success('Successfully created formation "',d.name,'"'),b.$broadcast("create-entity",d),f.resolve(d)},function(a){h.error('Failed to create formation "',d.name,'"'),f.reject(a)}),f.promise},this.deleteFormation=function(d){var f=c.defer(),i=g.pending('Deleting formation "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_FORMATION),{key:d.key}).then(function(a){var c=a.data.results.key;impakt.context.Playbook.formations.remove(d.guid),i.success('Successfully deleted formation "',d.name,'"'),b.$broadcast("delete-formation",d),h.deleteAssociations(d.associationKey),f.resolve(c)},function(a){i.error('Failed to delete formation "',d.name,'"'),f.reject(a)}),f.promise},this.getFormations=function(){var b=c.defer(),d=g.pending("Getting Formations...");return e.get(e.path(a.ENDPOINT,a.GET_FORMATIONS,"?$filter=ParentRK gt 0")).then(function(a){for(var c=Common.Utilities.parseData(a.data.results),e=new Common.Models.FormationCollection(Team.Enums.UnitTypes.Mixed),f=0;f<c.length;f++){var g=c[f];if(!(g&&g.data&&g.data.formation))throw new Error("An invalid formation was retrieved");var h=g.data.formation;h.key=g.key;var i=new Common.Models.Formation(Team.Enums.UnitTypes.Other);i.fromJson(h),e.add(i,!1)}d.success(e.size()," Formations successfully retrieved"),b.resolve(e)},function(a){d.error("Failed to retrieve Formations"),b.reject(a)}),b.promise},this.getFormation=function(b){var d=c.defer();return e.get(e.path(a.ENDPOINT,a.GET_FORMATION,"?Key="+b)).then(function(a){var b=Common.Utilities.parseData(a.data.results),c=JSON.parse(b.data).formation,e=new Common.Models.Formation(Team.Enums.UnitTypes.Other);e.fromJson(c),d.resolve(e)},function(a){d.reject(a)}),d.promise},this.newFormation=function(){},this.editFormation=function(a,b){var c=(g.info('Opened formation "',a.name,'" for editing.'),b?b:impakt.context.Playbook.editor.scenarios.hasElementWhich(function(b){return Common.Utilities.isNullOrUndefined(b.playPrimary)||Common.Utilities.isNullOrUndefined(b.playPrimary.formation)?!1:b.editorType==Playbook.Enums.EditorTypes.Formation&&b.playPrimary.formation.guid==a.guid}));if(!c){var e=new Common.Models.PlayPrimary(a.unitType),f=a.copy();e.setFormation(f),e.name=a.name,this.setFormationAssociations(e);var h=new Common.Models.Scenario;h.setPlayPrimary(e),h.setPlayOpponent(null),h.editorType=Playbook.Enums.EditorTypes.Formation,h.name=a.name,impakt.context.Playbook.editor.scenarios.add(h,!1)}d.transitionTo("playbook.editor")},this.updateFormation=function(b){var d=c.defer(),f=b.toJson(),h=g.pending("Updating formation");return e.post(e.path(a.ENDPOINT,a.UPDATE_FORMATION),{version:1,name:f.name,key:f.key,data:{version:1,name:f.name,key:f.key,formation:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=new Common.Models.Formation(Team.Enums.UnitTypes.Other);c&&c.data&&c.data.formation&&(e.fromJson(c.data.formation),impakt.context.Playbook.formations.set(e.guid,e)),h.success('Successfully updated formation "',b.name,'"'),d.resolve(e)},function(a){h.error('Failed to update formation "',b.name,'"'),d.reject(a)}),d.promise},this.saveFormation=function(a,b){var d=c.defer(),e=g.pending('Saving formation "',a.name,'"...');return b.formation.action==Common.API.Actions.Create||b.formation.action==Common.API.Actions.Copy?(a.key=-1,a.guid=Common.Utilities.guid(),j.createFormation(a).then(function(b){e.success('Successfully created and saved formation "',a.name,'"'),d.resolve(b)},function(b){e.error('Failed to save formation "',a.name,'"'),d.reject(b)})):b.formation.action==Common.API.Actions.Overwrite&&(a.modified?j.updateFormation(a).then(function(b){e.success('Successfully saved formation "',a.name,'"'),d.resolve(b)},function(b){e.error('Failed to save formation "',a.name,'"'),d.reject(b)}):(e.warning('Formation "',a.name,'" was not saved; no changes were detected.'),d.reject(null))),d.promise},this.getAssignmentGroups=function(){var b=c.defer(),d=g.pending("Getting Assignments...");return e.get(e.path(a.ENDPOINT,a.GET_ASSIGNMENTGROUPS)).then(function(a){for(var c=Common.Utilities.parseData(a.data.results),e=new Common.Models.AssignmentGroupCollection(Team.Enums.UnitTypes.Mixed),f=0;f<c.length;f++){var g=c[f];if(g&&g.data&&g.data.assignmentGroup){var h=new Common.Models.AssignmentGroup(Team.Enums.UnitTypes.Other);h.key=g.key,g.data.assignmentGroup.key=g.key,h.fromJson(g.data.assignmentGroup),e.add(h,!1)}}d.success(e.size()," Assignment groups successfully retrieved"),b.resolve(e)},function(a){d.error("Failed to retrieve Assignment groups"),b.reject(a)}),b.promise},this.deleteAssignmentGroup=function(d){var f=c.defer(),i=g.pending('Deleting assignment group "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_ASSIGNMENTGROUP),{key:d.key}).then(function(a){var c=a.data.results.key;impakt.context.Playbook.assignmentGroups.remove(d.guid),i.success('Successfully deleted assignment group "',d.name,'"'),b.$broadcast("delete-assignmentGroup",d),h.deleteAssociations(d.associationKey),f.resolve(c)},function(a){i.error('Failed to delete assignment group "',d.name,'"'),f.reject(a)}),f.promise},this.createAssignmentGroup=function(d){var f=c.defer(),h=g.pending('Creating assignment group "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_ASSIGNMENTGROUP),{version:1,name:d.name,ownerRK:1,parentRK:1,data:{version:1,name:d.name,ownerRK:1,parentRK:1,assignmentGroup:d.toJson()}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),d=new Common.Models.AssignmentGroup(Team.Enums.UnitTypes.Other);if(c&&c.data&&c.data.assignmentGroup){var e=c.data.assignmentGroup;e.key=c.key,d.fromJson(e),impakt.context.Playbook.assignmentGroups.add(d,!1),h.success('Successfully created assignment group "',d.name,'"'),b.$broadcast("create-entity",d),f.resolve(d)}else h.warning('Created assignment group "',d.name,'" but an error may have occurred                          in the process. You may need to refresh your browser if you experience issues.'),f.reject(null)},function(a){h.success('Failed to create assignment group "',d.name,'"'),f.reject(a)}),f.promise},this.updateAssignmentGroup=function(b){var d=c.defer(),f=b.toJson(),h=g.pending('Updating assignment group "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.UPDATE_ASSIGNMENTGROUP),{version:1,name:f.name,key:f.key,data:{version:1,name:f.name,key:f.key,assignmentGroup:b.toJson()}}).then(function(a){var b=Common.Utilities.parseData(a.data.results),c=new Common.Models.AssignmentGroup(Team.Enums.UnitTypes.Other);b&&b.data&&b.data.assignmentGroup&&(c.fromJson(b.data.assignmentGroup),impakt.context.Playbook.assignmentGroups.set(c.guid,c)),h.success('Successfully updated assignment group "',c.name,'"'),d.resolve(c)},function(a){h.error('Failed to update assignment group "',b.name,'"'),d.reject(a)}),d.promise},this.createPlay=function(d){var f=d.toJson(),h=c.defer(),i=g.pending('Creating play "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_PLAY),{version:1,name:d.name,ownerRK:1,parentRK:1,data:{version:1,name:d.name,ownerRK:1,parentRK:1,play:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=null;c&&c.data&&c.data.play&&(e=new Common.Models.PlayPrimary(Team.Enums.UnitTypes.Other),c.data.play.key=c.key,e.fromJson(c.data.play),impakt.context.Playbook.plays.add(e,!1)),i.success('Successfully created play "',d.name,'"'),b.$broadcast("create-entity",e),h.resolve(e)},function(a){i.error('Failed to create play "',d.name,'"'),h.reject(a)}),h.promise},this.savePlay=function(a,b){var d=c.defer(),e=g.pending('Saving play "',a.name,'"...');return async.parallel([function(c){b.formation==Common.API.Actions.Create||b.formation==Common.API.Actions.Copy?(a.formation.key=-1,j.createFormation(a.formation).then(function(b){a.formation=b,c(null,a)},function(a){c(a)})):b.formation==Common.API.Actions.Overwrite?j.updateFormation(a.formation).then(function(b){c(null,a)},function(a){c(a)}):c(null,a)},function(c){Common.Utilities.isNullOrUndefined(a.assignmentGroup)&&c(null,a),b.assignmentGroup==Common.API.Actions.Create||b.assignmentGroup==Common.API.Actions.Copy?(a.assignmentGroup.key=-1,j.createAssignmentGroup(a.assignmentGroup).then(function(b){h.associationExists(a.associationKey,b.associationKey)||h.createAssociation(a,b).then(function(){c(null,a)},function(a){c(a)})},function(a){c(a)})):b.assignmentGroup==Common.API.Actions.Overwrite?j.updateAssignmentGroup(a.assignmentGroup).then(function(a){c(null,a)},function(a){c(a)}):c(null,a)},function(c){b.play==Common.API.Actions.Create||b.play==Common.API.Actions.Copy?(a.key=-1,j.createPlay(a).then(function(a){c(null,a)},function(a){c(a)})):b.play==Common.API.Actions.Overwrite?j.updatePlay(a).then(function(a){c(null,a)},function(a){c(a)}):c(null,a)}],function(b,c){b?(e.error('Failed to save play "',a.name,'"'),d.reject(b)):(e.success('Successfully saved play "',a.name,'"'),d.resolve(c))}),d.promise},this.updatePlay=function(b){var d=c.defer(),f=g.pending('Updating play "',b.name,'"...'),h=b.toJson();return e.post(e.path(a.ENDPOINT,a.UPDATE_PLAY),{version:1,name:b.name,key:b.key,data:{version:1,name:b.name,key:b.key,play:h}}).then(function(a){var b=Common.Utilities.parseData(a.data.results),c=new Common.Models.PlayPrimary(Team.Enums.UnitTypes.Other);b&&b.data&&b.data.play&&(c.fromJson(b.data.play),impakt.context.Playbook.plays.set(c.guid,c)),f.success('Successfully updated play "',c.name,'"'),d.resolve(c)},function(a){f.error('Failed to update play "',b.name,'"'),d.reject(a)}),d.promise},this.getPlays=function(){var b=c.defer(),d=g.pending("Getting Plays...");return e.get(e.path(a.ENDPOINT,a.GET_PLAYS)).then(function(a){var c=new Common.Models.PlayCollection(Team.Enums.UnitTypes.Mixed);if(a&&a.data&&a.data.results){var e=Common.Utilities.parseData(a.data.results);if(e)for(var f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.play){var h=g.data.play,i=new Common.Models.PlayPrimary(Team.Enums.UnitTypes.Other);h.key=g.key,i.fromJson(h),c.add(i,!1)}}}d.success(c.size()," Plays successfully retrieved"),b.resolve(c)},function(a){d.error("Failed to retrieve Plays"),b.reject(a)}),b.promise},this.editPlay=function(a){var b=(g.info('Opened play "',a.name,'" for editing.'),new Common.Models.Scenario),c=a.copy();a.playType!=Playbook.Enums.PlayTypes.Primary&&(c=Common.Models.Play.toPrimary(c)),b.setPlayPrimary(c),b.setPlayOpponent(null),b.name=c.name,b.editorType=Playbook.Enums.EditorTypes.Play,this.setPlayAssociations(b.playPrimary),impakt.context.Playbook.editor.scenarios.add(b,!1),d.transitionTo("playbook.editor")},this.deletePlay=function(d){var f=c.defer(),i=g.pending('Deleting play "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_PLAY),{key:d.key}).then(function(a){a.data.results.key;impakt.context.Playbook.plays.remove(d.guid),i.success('Successfully deleted play "',d.name,'"'),b.$broadcast("delete-play",d),h.deleteAssociations(d.associationKey),f.resolve(d)},function(a){i.error('Failed to delete play "',d.name,'"'),f.reject(a)}),f.promise},this.createScenario=function(d){var f=d.toJson(),h=c.defer(),i=g.pending('Creating scenario "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_SCENARIO),{version:1,name:d.name,ownerRK:1,parentRK:1,data:{version:1,name:d.name,ownerRK:1,parentRK:1,scenario:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=null;c&&c.data&&c.data.scenario&&(e=new Common.Models.Scenario,c.data.scenario.key=c.key,e.fromJson(c.data.scenario),impakt.context.Playbook.scenarios.add(e,!1)),i.success('Successfully created scenario "',d.name,'"'),b.$broadcast("create-entity",e),h.resolve(e)},function(a){i.error('Failed to create scenario "',d.name,'"'),h.reject(a)}),h.promise},this.saveScenario=function(a,b,d){var e=c.defer(),f=g.pending('Saving scenario "',a.name,'"...');return async.parallel([function(c){Common.Utilities.isNotNullOrUndefined(a.playPrimary)?j.savePlay(a.playPrimary,b).then(function(a){c(null,a)},function(a){c(a)}):c(null,null)},function(b){Common.Utilities.isNotNullOrUndefined(a.playOpponent)?j.savePlay(a.playOpponent,d).then(function(a){b(null,a)},function(a){b(a)}):b(null,null)}],function(b,c){b?(f.error('Failed to save scenario "',a.name,'"'),e.reject(b)):(f.success('Successfully saved scenario "',a.name,'"'),e.resolve(c))}),e.promise},this.updateScenario=function(b){var d=c.defer(),f=g.pending('Updating scenario "',b.name,'"...'),h=b.toJson();return e.post(e.path(a.ENDPOINT,a.UPDATE_SCENARIO),{version:1,name:b.name,key:b.key,data:{version:1,name:b.name,key:b.key,scenario:h}}).then(function(a){var b=Common.Utilities.parseData(a.data.results),c=new Common.Models.PlayPrimary(Team.Enums.UnitTypes.Other);b&&b.data&&b.data.scenario&&(c.fromJson(b.data.scenario),impakt.context.Playbook.scenarios.set(c.guid,c)),f.success('Successfully updated scenario "',c.name,'"'),d.resolve(c)},function(a){f.error('Failed to update scenario "',b.name,'"'),d.reject(a)}),d.promise},this.getScenarios=function(){var b=c.defer(),d=g.pending("Getting Scenarios...");return e.get(e.path(a.ENDPOINT,a.GET_SCENARIOS)).then(function(a){var c=new Common.Models.ScenarioCollection(Team.Enums.UnitTypes.Mixed);if(a&&a.data&&a.data.results){var e=Common.Utilities.parseData(a.data.results);if(e)for(var f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.scenario){var h=g.data.scenario,i=new Common.Models.Scenario;h.key=g.key,i.fromJson(h),c.add(i,!1)}}}d.success(c.size()," Scenarios successfully retrieved"),b.resolve(c)},function(a){d.error("Failed to retrieve Scenarios"),b.reject(a)}),b.promise},this.editScenario=function(a){var b=(g.info('Opened scenario "',a.name,'" for editing.'),a.copy());b.editorType=Playbook.Enums.EditorTypes.Scenario,this.setScenarioAssociations(b),impakt.context.Playbook.editor.scenarios.add(b,!1),d.transitionTo("playbook.editor")},this.deleteScenario=function(d){var f=c.defer(),i=g.pending('Deleting scenario "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_SCENARIO),{key:d.key}).then(function(a){a.data.results.key;impakt.context.Playbook.scenarios.remove(d.guid),i.success('Successfully deleted scenario "',d.name,'"'),b.$broadcast("delete-scenario",d),h.deleteAssociations(d.associationKey),f.resolve(d)},function(a){i.error('Failed to delete scenario "',d.name,'"'),f.reject(a)}),f.promise},this.getUnitTypes=function(){return new Team.Models.UnitTypeCollection},this.getUnitTypesEnum=function(){var a={};for(var b in Team.Enums.UnitTypes){var c=parseInt(b);c>=0&&(a[c]=Common.Utilities.camelCaseToSpace(Team.Enums.UnitTypes[c],!0))}return a},this.getEditorTypeClass=function(a){var b="";switch(a){case Playbook.Enums.EditorTypes.Formation:b="playbook-editor-type-formation";break;case Playbook.Enums.EditorTypes.Assignment:b="playbook-editor-type-assignment";break;case Playbook.Enums.EditorTypes.Play:b="playbook-editor-type-play";break;case Playbook.Enums.EditorTypes.Scenario:b="playbook-editor-type-scenario"}return b},this.toEditor=function(){d.transitionTo("playbook.editor")},this.refreshEditor=function(){b.$broadcast("playbook-editor.refresh")},this.toBrowser=function(){this.drilldown.playbook=null,impakt.context.Playbook.playbooks.deselectAll(),impakt.context.Actionable.selected.deselectAll(),d.transitionTo("playbook.browser")},this.toPlaybookDrilldown=function(a){this.drilldown.playbook=a,impakt.context.Playbook.playbooks.select(a),impakt.context.Actionable.selected.only(a),d.transitionTo("playbook.drilldown.playbook")},this.toTeam=function(){d.transitionTo("team")},this.deleteEntityByType=function(a){var b=c.defer();switch(a.impaktDataType){case Common.Enums.ImpaktDataTypes.Playbook:return i.deletePlaybook(a);case Common.Enums.ImpaktDataTypes.Play:return i.deletePlay(a);case Common.Enums.ImpaktDataTypes.Formation:return i.deleteFormation(a);case Common.Enums.ImpaktDataTypes.AssignmentGroup:return i.deleteAssignmentGroup(a);case Common.Enums.ImpaktDataTypes.Scenario:return i.deleteScenario(a);default:b.reject(new Error("_playbook deleteEntityByType: impaktDataType not supported"))}return b.promise},this.updateEntityByType=function(a){var b=c.defer();switch(a.impaktDataType){case Common.Enums.ImpaktDataTypes.Playbook:return i.updatePlaybook(a);case Common.Enums.ImpaktDataTypes.Play:return i.updatePlay(a);case Common.Enums.ImpaktDataTypes.Formation:return i.updateFormation(a);case Common.Enums.ImpaktDataTypes.AssignmentGroup:return i.updateAssignmentGroup(a);case Common.Enums.ImpaktDataTypes.Scenario:return i.updateScenario(a);default:b.reject(new Error("_playbook deleteEntityByType: impaktDataType not supported"))}return b.promise},this.setScenarioAssociations=function(a){var b=h.getAssociated(a),c=b.plays;if(Common.Utilities.isNotNullOrUndefined(c)){var d=c.filterFirst(function(b,c){return b.guid==a.playPrimaryGuid}),e=c.filterFirst(function(b,c){return b.guid==a.playOpponentGuid});Common.Utilities.isNotNullOrUndefined(d)&&(this.setPlayAssociations(d),a.setPlayPrimary(d)),Common.Utilities.isNotNullOrUndefined(e)&&(this.setPlayAssociations(e),a.setPlayOpponent(e))}return a},this.setPlayAssociations=function(a){var b=h.getAssociated(a),c=b.formations.first();a.formation=c&&c.copy();var d=b.assignmentGroups.first();a.assignmentGroup=d&&d.copy();var e=b.personnel.first();return a.personnel=e&&e.copy(),a},this.setFormationAssociations=function(a){if(!Common.Utilities.isNullOrUndefined(a)){var b=h.getAssociated(a.formation),c=b.personnel.first();a.personnel=c&&c.copy()}},this.getAssignmentGroupAPIActions=function(a){return Common.Utilities.isNullOrUndefined(a)||Common.Utilities.isNullOrUndefined(a.assignments)?Common.API.Actions.Nothing:a.assignments.hasElements()?-1==a.key?Common.API.Actions.Create:Common.API.Actions.Overwrite:Common.API.Actions.Nothing}}]),impakt.playbook.sidebar=angular.module("impakt.playbook.sidebar",[]).config(["$stateProvider",function(a){console.debug("impakt.playbook.sidebar - config")}]).run([function(){console.debug("impakt.playbook.sidebar - run")}]),impakt.playbook.sidebar.controller("playbook.sidebar.ctrl",["$scope","__router","_playbook","_playbookModals",function(a,b,c,d){var e="playbook.sidebar";b.push(e,[new Common.Models.Template("playbook.sidebar.playbooks","modules/playbook/sidebar/playbook/playbook-sidebar-playbooks.tpl.html"),new Common.Models.Template("playbook.sidebar.plays","modules/playbook/sidebar/play/playbook-sidebar-plays.tpl.html"),new Common.Models.Template("playbook.sidebar.formations","modules/playbook/sidebar/formation/playbook-sidebar-formations.tpl.html")]),a.template={},a.plays=impakt.context.Playbook.plays,a.formations=impakt.context.Playbook.formations,a.playbooks=impakt.context.Playbook.playbooks,a.goToPlaybooks=function(){a.template=b.get(e,"playbook.sidebar.playbooks")},a.goToPlays=function(){a.template=b.get(e,"playbook.sidebar.plays")},a.goToFormations=function(){a.template=b.get(e,"playbook.sidebar.formations");
},a.refreshPlays=function(){a.plays=impakt.context.Playbook.plays},a.refreshFormations=function(){a.formations=impakt.context.Playbook.formations},a.refreshPlaybooks=function(){a.playbooks=impakt.context.Playbook.playbooks},a.createPlay=function(){d.createPlay()},a.createFormation=function(){d.createFormation()},a.createPlaybook=function(){d.createPlaybook()},a.openFormationInEditor=function(a){c.editFormation(a),c.refreshEditor()},a.openPlayInEditor=function(a){c.editPlay(a),c.refreshEditor()},a.goToPlays()}]),impakt.search=angular.module("impakt.search",[]).filter("globalSearchFilter",function(){return function(a,b){}}),impakt.search.controller("search.ctrl",["$scope","__context",function(a,b){a.title="Results",a.query="",a.playbooks,a.formations,a.plays,b.onReady(function(){a.playbooks=impakt.context.Playbook.playbooks,a.formations=impakt.context.Playbook.formations,a.plays=impakt.context.Playbook.plays}),a.$on("$destroy",function(){})}]),impakt.season=angular.module("impakt.season",["impakt.season.browser","impakt.season.drilldown","impakt.season.modals"]).config(["$stateProvider","$urlRouterProvider",function(a,b){console.debug("impakt.season - config"),a.state("season",{url:"/season",templateUrl:"modules/season/season.tpl.html",controller:"season.ctrl"})}]).run(function(){console.debug("impakt.season - run")}),impakt.season.browser=angular.module("impakt.season.browser",[]).config(["$stateProvider",function(a){console.debug("impakt.season.browser - config"),a.state("season.browser",{url:"/browser",templateUrl:"modules/season/browser/season-browser.tpl.html",controller:"season.browser.ctrl"})}]).run(function(){console.debug("impakt.season.browser - run")}),impakt.season.browser.controller("season.browser.ctrl",["$scope","_season","_seasonModals",function(a,b,c){a.seasons=impakt.context.Season.seasons,a.createSeason=function(){c.createSeason()}}]),impakt.season.drilldown=angular.module("impakt.season.drilldown",["impakt.season.drilldown.season","impakt.season.drilldown.week","impakt.season.drilldown.game"]).config(["$stateProvider",function(a){console.debug("impakt.season.drilldown - config"),a.state("season.drilldown",{url:"/drilldown",templateUrl:"modules/season/drilldown/season-drilldown.tpl.html",controller:"season.drilldown.ctrl"})}]).run(function(){console.debug("impakt.season.drilldown - run")}),impakt.season.drilldown.game=angular.module("impakt.season.drilldown.game",[]).config(["$stateProvider",function(a){console.debug("impakt.season.drilldown.game - config"),a.state("season.drilldown.game",{url:"/game",templateUrl:"modules/season/drilldown/game/season-drilldown-game.tpl.html",controller:"season.drilldown.game.ctrl"})}]).run(function(){console.debug("impakt.season.drilldown.game - run")}),impakt.season.drilldown.game.controller("season.drilldown.game.ctrl",["$scope","$rootScope","_associations","_season","_seasonModals","_teamModals",function(a,b,c,d,e,f){function g(){var b=c.getAssociated(a.game);a.game.setSeason(a.season),Common.Utilities.isNotNullOrUndefined(b)&&(a.teams=b.teams,a.teams.forEach(function(a,b){c.getAssociated(a)}))}a.season=d.drilldown.season,a.game=d.drilldown.game,a.teams=new Team.Models.TeamModelCollection,a.homeTeam=null,a.awayTeam=null;var h=b.$on("delete-game",function(a,b){Common.Utilities.isNullOrUndefined(d.drilldown.week)||d.toWeekDrilldown(d.drilldown.week)}),i=b.$on("associations-updated",function(a){g()});a.$on("$destroy",function(){h(),i()}),g()}]),impakt.season.drilldown.controller("season.drilldown.ctrl",["$scope","_details","_season",function(a,b,c){a.drilldown=c.drilldown,a.toSeasonDrilldown=function(a){c.toSeasonDrilldown(a)},a.toWeekDrilldown=function(a){c.toWeekDrilldown(a)},a.toBrowser=function(){b.selectedElements.deselectAll(),c.toBrowser()}}]),impakt.season.drilldown.season=angular.module("impakt.season.drilldown.season",[]).config(["$stateProvider",function(a){console.debug("impakt.season.drilldown.season - config"),a.state("season.drilldown.season",{url:"/season",templateUrl:"modules/season/drilldown/season/season-drilldown-season.tpl.html",controller:"season.drilldown.season.ctrl"})}]).run(function(){console.debug("impakt.season.drilldown.season - run")}),impakt.season.drilldown.season.controller("season.drilldown.season.ctrl",["$scope","$rootScope","_associations","_season","_seasonModals",function(a,b,c,d,e){function f(){var b=c.getAssociated(a.season);Common.Utilities.isNotNullOrUndefined(b)&&(a.games=b.games,a.games.forEach(function(a,b){c.getAssociated(a)})),a.season.weeks.forEach(function(a,b){})}a.season=d.drilldown.season,a.games=new Season.Models.GameCollection;var g=b.$on("delete-game",function(b,c){a.games.remove(c.guid)}),h=b.$on("associations-updated",function(a){f()});a.$on("$destroy",function(){g(),h()}),a.createGame=function(){e.createGame(a.season).then(function(){f()})},f()}]),impakt.season.drilldown.week=angular.module("impakt.season.drilldown.week",[]).config(["$stateProvider",function(a){console.debug("impakt.season.drilldown.week - config"),a.state("season.drilldown.week",{url:"/week",templateUrl:"modules/season/drilldown/week/season-drilldown-week.tpl.html",controller:"season.drilldown.week.ctrl"})}]).run(function(){console.debug("impakt.season.drilldown.week - run")}),impakt.season.drilldown.week.controller("season.drilldown.week.ctrl",["$scope","$rootScope","_associations","_season","_seasonModals",function(a,b,c,d,e){function f(){Common.Utilities.isNullOrUndefined(a.week)||Common.Utilities.isNullOrUndefined(a.games)||a.allGames.forEach(function(b,d){if(b.weekGuid==a.week.guid){var e=c.getAssociated(b);Common.Utilities.isNotNullOrUndefined(e.locations)&&b.setLocation(e.locations.first()),Common.Utilities.isNotNullOrUndefined(e.teams)&&(b.setAway(e.teams.get(b.awayGuid)),b.setHome(e.teams.get(b.homeGuid))),b.setWeek(a.week),a.games.add(b)}})}a.season=d.drilldown.season,a.week=d.drilldown.week,a.allGames=impakt.context.Season.games,a.games=new Season.Models.GameCollection,a.teams=impakt.context.Team.teams,a.location=impakt.context.League.locations;var g=b.$on("delete-game",function(b,c){a.games.remove(c.guid)}),h=b.$on("associations-updated",function(a){f()});a.$on("$destroy",function(){h(),g()}),a.createGame=function(){e.createGame(a.season,a.week).then(function(){f()})},f()}]),impakt.season.modals=angular.module("impakt.season.modals",[]).config(function(){console.debug("impakt.season.modals - config")}).run(function(){console.debug("impakt.season.modals - run")}),impakt.season.modals.controller("season.modals.createGameDuplicateError.ctrl",["$scope","$uibModalInstance","_season","game",function(a,b,c,d){a.game=d,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}]),impakt.season.modals.controller("season.modals.createGame.ctrl",["$scope","$uibModalInstance","_associations","_season","_leagueModals","season","week",function(a,b,c,d,e,f,g){function h(){Common.Utilities.isNotNullOrUndefined(g)&&(a.newGame.weekGuid=g.guid)}function i(){Common.Utilities.isNotNullOrUndefined(a.newGame)&&impakt.context.Season.creation.games.remove(a.newGame.guid)}a.seasons=impakt.context.Season.seasons,a.newGame=new Season.Models.Game,a.selectedSeason=f||a.seasons.first(),a.teams=impakt.context.Team.teams,a.locations=impakt.context.League.locations,a.selectedHomeTeam=new Team.Models.TeamModel,a.selectedAwayTeam=new Team.Models.TeamModel,a.selectedWeek=g||new Season.Models.Week,a.selectedLocation=a.selectedHomeTeam&&a.selectedHomeTeam.location?a.selectedHomeTeam.location:a.locations.first(),a.teamChange=function(){a.newGame.setHome(a.selectedHomeTeam),a.newGame.setAway(a.selectedAwayTeam)},a.selectLocation=function(){Common.Utilities.isNotNullOrUndefined(a.selectedLocation)&&a.newGame.setLocation(a.selectedLocation)},a.selectWeek=function(){a.newGame.weekGuid=a.selectedWeek.guid},a.createLocation=function(){e.createLocation().then(function(b){a.locations=impakt.context.League.locations,a.selectedLocation=b,a.selectLocation()})},a.updateDatetime=function(){},a.ok=function(){d.createGame(a.newGame).then(function(d){var e=[a.selectedHomeTeam,a.selectedAwayTeam,a.selectedSeason,a.selectedLocation];c.createAssociations(d,e),b.close(d)},function(a){b.close(a)}),b.close()},a.cancel=function(){i(),b.dismiss()},h()}]),impakt.season.modals.controller("season.modals.createSeasonDuplicateError.ctrl",["$scope","$uibModalInstance","_season","season",function(a,b,c,d){a.season=d,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}]),impakt.season.modals.controller("season.modals.createSeason.ctrl",["$scope","$timeout","$uibModalInstance","_season",function(a,b,c,d){function e(){for(var b=0;b<a.numberOfWeeks;b++)a.newSeasonModel.weeks.add(f(b+1),!1)}function f(b){var c=new Season.Models.Week;return c.name="Week",c.number=b,c.incrementWeek(a.newSeasonModel.start,a.newSeasonModel.weeks.size()),c}a.newSeasonModel=new Season.Models.SeasonModel,a.numberOfWeeks=32,a.maxWeeks=64,a.minWeeks=1,a.debounce=null;var g=500;a.setWeeks=function(){Common.Utilities.isNotNullOrUndefined(a.debounce)&&b.cancel(a.debounce),a.debounce=b(function(){if(!Common.Utilities.isNullOrUndefined(a.numberOfWeeks)&&""!=a.numberOfWeeks&&!isNaN(a.numberOfWeeks)&&0!=a.numberOfWeeks){var b=a.numberOfWeeks-a.newSeasonModel.weeks.size();if(0!=b){if(a.numberOfWeeks>a.maxWeeks&&(a.numberOfWeeks=a.maxWeeks),a.numberOfWeeks<a.minWeeks&&(a.numberOfWeeks=a.minWeeks),a.newSeasonModel.weeks.listen(!1),0>b)for(;a.newSeasonModel.weeks.size()>a.numberOfWeeks;)a.newSeasonModel.weeks.pop();else for(;a.newSeasonModel.weeks.size()<a.numberOfWeeks;)a.newSeasonModel.weeks.add(f(a.newSeasonModel.weeks.size()+1));a.newSeasonModel.weeks.listen(!0)}}},g)},a.weekBlur=function(){a.numberOfWeeks=a.newSeasonModel.weeks.size()},a.updateDatetime=function(){a.newSeasonModel.start.date;a.newSeasonModel.weeks.forEach(function(b,c){b.incrementWeek(a.newSeasonModel.start,c)})},a.ok=function(){d.createSeason(a.newSeasonModel).then(function(a){c.close(a)},function(a){console.error(a),c.close(a)})},a.cancel=function(){c.dismiss()},e()}]),impakt.season.modals.controller("season.modals.deleteGame.ctrl",["$scope","$rootScope","$uibModalInstance","_season","game",function(a,b,c,d,e){a.game=e,a.ok=function(){d.deleteGame(a.game).then(function(d){b.$broadcast("delete-game",a.game),c.close(d)},function(a){console.error(a),c.close(a)})},a.cancel=function(){c.dismiss()}}]),impakt.season.modals.controller("season.modals.deleteSeason.ctrl",["$scope","$uibModalInstance","_season","season",function(a,b,c,d){a.season=d,a.ok=function(){c.deleteSeason(a.season).then(function(a){b.close(a)},function(a){console.error(a),b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.season.modals.controller("season.modals.saveGame.ctrl",["$scope","$uibModalInstance","_season","game",function(a,b,c,d){a.game=d,a.ok=function(){c.updateGame(a.game).then(function(a){b.close(a)},function(a){b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.season.modals.controller("season.modals.saveSeason.ctrl",["$scope","$uibModalInstance","_season","season",function(a,b,c,d){a.season=d,a.ok=function(){c.updateSeason(a.season).then(function(a){b.close(a)},function(a){b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.season.modals.service("_seasonModals",["$q","__modals",function(a,b){this.createSeason=function(){var c=a.defer(),d=b.open("","modules/season/modals/create-season/create-season.tpl.html","season.modals.createSeason.ctrl",{});return d.result.then(function(a){console.log(a),c.resolve()},function(a){console.log("dismissed"),c.reject()}),c.promise},this.createSeasonDuplicate=function(c){var d=a.defer(),e=b.open("","modules/season/modals/create-season-duplicate-error/create-season-duplicate-error.tpl.html","season.modals.createSeasonDuplicateError.ctrl",{season:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deleteSeason=function(c){var d=a.defer(),e=b.open("","modules/season/modals/delete-season/delete-season.tpl.html","season.modals.deleteSeason.ctrl",{season:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.saveSeason=function(c){var d=a.defer(),e=b.open("","modules/season/modals/save-season/save-season.tpl.html","season.modals.saveSeason.ctrl",{season:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createGame=function(c,d){var e=a.defer(),f=b.open("","modules/season/modals/create-game/create-game.tpl.html","season.modals.createGame.ctrl",{season:function(){return c},week:function(){return d}});return f.result.then(function(a){console.log(a),e.resolve()},function(a){console.log("dismissed"),e.reject()}),e.promise},this.createGameDuplicate=function(c){var d=a.defer(),e=b.open("","modules/season/modals/create-game-duplicate-error/create-game-duplicate-error.tpl.html","season.modals.createGameDuplicateError.ctrl",{game:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deleteGame=function(c){var d=a.defer(),e=b.open("","modules/season/modals/delete-game/delete-game.tpl.html","season.modals.deleteGame.ctrl",{game:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.saveGame=function(c){var d=a.defer(),e=b.open("","modules/season/modals/save-game/save-game.tpl.html","season.modals.saveGame.ctrl",{game:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createWeek=function(c){var d=a.defer(),e=b.open("","modules/season/modals/create-week/create-week.tpl.html","season.modals.createWeek.ctrl",{game:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createWeekDuplicate=function(c){var d=a.defer(),e=b.open("","modules/season/modals/create-week-duplicate-error/create-week-duplicate-error.tpl.html","season.modals.createWeekDuplicateError.ctrl",{week:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deleteWeek=function(c){var d=a.defer(),e=b.open("","modules/season/modals/delete-week/delete-week.tpl.html","season.modals.deleteWeek.ctrl",{week:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.saveWeek=function(c){var d=a.defer(),e=b.open("","modules/season/modals/save-week/save-week.tpl.html","season.modals.saveWeek.ctrl",{week:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise}}]),impakt.season.constant("SEASON",{ENDPOINT:"/teamInfo",CREATE_SEASON:"/createSeason",GET_SEASONS:"/getSeasons",GET_SEASON:"/getSeason",DELETE_SEASON:"/deleteSeason",UPDATE_SEASON:"/updateSeason",CREATE_GAME:"/createGame",GET_GAMES:"/getGames",GET_GAME:"/getGame",DELETE_GAME:"/deleteGame",UPDATE_GAME:"/updateGame"}),impakt.season.controller("season.ctrl",["$scope","$state","_season",function(a,b,c){b.go("season.browser")}]),impakt.season.service("_season",["SEASON","$rootScope","$q","$state","__api","__localStorage","__notifications","_seasonModals",function(a,b,c,d,e,f,g,h){function i(a,b){a&&impakt.context.Season.seasons.deselectAll(),b&&impakt.context.Season.games.deselectAll()}var j=this;this.drilldown={season:null,week:null,game:null},this.getSeasons=function(){var b=c.defer(),d=g.pending("Getting seasons...");return e.get(e.path(a.ENDPOINT,a.GET_SEASONS)).then(function(a){var c=new Season.Models.SeasonModelCollection;if(a&&a.data&&a.data.results)for(var e=Common.Utilities.parseData(a.data.results),f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.model){var h=new Season.Models.SeasonModel;g.data.model.key=g.key,h.fromJson(g.data.model),c.add(h,!1)}}d.success([c.size()," Seasons successfully retreived"].join("")),b.resolve(c)},function(a){d.error("Failed to retieve Seasons"),console.error(a),b.reject(a)}),b.promise},this.getSeason=function(b){var d=c.defer();return e.get(e.path(a.ENDPOINT,a.GET_SEASON,"/"+b)).then(function(a){var b=Common.Utilities.parseData(a.data.results);d.resolve(b)},function(a){d.reject(a)}),d.promise},this.createSeason=function(d){var f=c.defer();if(Common.Utilities.isNotNullOrUndefined(d)){var i=impakt.context.Season.seasons.hasElementWhich(function(a,b){return a.name==d.name});if(i){g.warning('Failed to create season. Season "',d.name,'" already exists.');return void h.createSeasonDuplicate(d)}}d.key=-1;var j=d.toJson(),k=g.pending('Creating season "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_SEASON),{version:1,name:d.name,data:{version:1,model:j}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),d=new Season.Models.SeasonModel;if(!(c&&c.data&&c.data.model))throw new Error("CreateSeason did not return a valid season model");c.data.model.key=c.key,d.fromJson(c.data.model),impakt.context.Season.seasons.add(d,!1),k.success('Successfully created season "',d.name,'"'),b.$broadcast("create-entity",d),f.resolve(d)},function(a){k.error('Failed to create season "',d.name,'"'),f.reject(a)}),f.promise},this.deleteSeason=function(b){var f=c.defer(),h=g.pending('Deleting season "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_SEASON),{key:b.key}).then(function(a){impakt.context.Season.seasons.remove(b.guid),h.success('Deleted season "',b.name,'"'),d.is("season.drilldown.season")&&j.toBrowser(),f.resolve(b)},function(a){h.error('Failed to delete season "',b.name,'"'),f.reject(a)}),f.promise},this.updateSeason=function(b){var d=c.defer(),f=b.toJson(),h=g.pending('Updating season "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.UPDATE_SEASON),{version:1,name:f.name,key:f.key,data:{version:1,key:f.key,model:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=new Season.Models.SeasonModel;c&&c.data&&c.data.model&&(e.fromJson(c.data.model),impakt.context.Season.seasons.set(e.guid,e)),h.success('Successfully updated season "',b.name,'"'),d.resolve(e)},function(a){h.error('Failed to update season "',b.name,'"'),d.reject(a)}),d.promise},this.getGames=function(){var b=c.defer(),d=g.pending("Getting games...");return e.get(e.path(a.ENDPOINT,a.GET_GAMES)).then(function(a){var c=new Season.Models.GameCollection;if(a&&a.data&&a.data.results)for(var e=Common.Utilities.parseData(a.data.results),f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.game){var h=new Season.Models.Game;g.data.game.key=g.key,h.fromJson(g.data.game),c.add(h,!1)}}d.success([c.size()," Games successfully retreived"].join("")),b.resolve(c)},function(a){d.error("Failed to retieve Games"),console.error(a),b.reject(a)}),b.promise},this.getGame=function(b){var d=c.defer();return e.get(e.path(a.ENDPOINT,a.GET_GAME,"/"+b)).then(function(a){var b=Common.Utilities.parseData(a.data.results);d.resolve(b)},function(a){d.reject(a)}),d.promise},this.createGame=function(d){var f=c.defer();if(Common.Utilities.isNotNullOrUndefined(d)){var i=impakt.context.Season.games.hasElementWhich(function(a,b){return a.name==d.name});if(i){g.warning('Failed to create game. Game "',d.name,'" already exists.');return void h.createGameDuplicate(d)}}d.key=-1;var j=d.toJson(),k=g.pending('Creating game "',d.name,'"...');return e.post(e.path(a.ENDPOINT,a.CREATE_GAME),{version:1,name:d.name,data:{version:1,game:j}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),d=new Season.Models.Game;if(!(c&&c.data&&c.data.game))throw new Error("CreateGame did not return a valid game");c.data.game.key=c.key,d.fromJson(c.data.game),impakt.context.Season.games.add(d,!1),k.success('Successfully created game "',d.name,'"'),b.$broadcast("create-entity",d),f.resolve(d)},function(a){k.error('Failed to create game "',d.name,'"'),f.reject(a)}),f.promise},this.deleteGame=function(b){var d=c.defer(),f=g.pending('Deleting game "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.DELETE_GAME),{key:b.key}).then(function(a){impakt.context.Season.games.remove(b.guid),f.success('Deleted game "',b.name,'"'),d.resolve(b)},function(a){f.error('Failed to delete game "',b.name,'"'),d.reject(a)}),d.promise},this.updateGame=function(b){var d=c.defer(),f=b.toJson(),h=g.pending('Updating game "',b.name,'"...');return e.post(e.path(a.ENDPOINT,a.UPDATE_GAME),{version:1,name:f.name,key:f.key,data:{version:1,key:f.key,game:f}}).then(function(a){var c=Common.Utilities.parseData(a.data.results),e=new Season.Models.Game;c&&c.data&&c.data.game&&(e.fromJson(c.data.game),impakt.context.Season.games.set(e.guid,e)),h.success('Successfully updated game "',b.name,'"'),d.resolve(e)},function(a){h.error('Failed to update game "',b.name,'"'),d.reject(a)}),d.promise},this.deleteEntityByType=function(a){if(!Common.Utilities.isNullOrUndefined(a)){var b=c.defer();switch(a.impaktDataType){case Common.Enums.ImpaktDataTypes.Season:return h.deleteSeason(a);case Common.Enums.ImpaktDataTypes.Game:return h.deleteGame(a);default:b.reject(new Error("_season deleteEntityByType: impaktDataType not supported"))}return b.promise}},this.updateEntityByType=function(a){if(!Common.Utilities.isNullOrUndefined(a)){var b=c.defer();switch(a.impaktDataType){case Common.Enums.ImpaktDataTypes.Season:return h.saveSeason(a);case Common.Enums.ImpaktDataTypes.Game:return h.saveGame(a);default:b.reject(new Error("_season saveEntityByType: impaktDataType not supported"))}return b.promise}},this.toBrowser=function(){this.drilldown.season=null,this.drilldown.game=null,d.transitionTo("season.browser")},this.toSeasonDrilldown=function(a){this.drilldown.season=a,this.drilldown.week=null,this.drilldown.game=null,impakt.context.Season.seasons.select(a),i(!1,!0),impakt.context.Actionable.selected.only(a),d.transitionTo("season.drilldown.season")},this.toWeekDrilldown=function(a){this.drilldown.week=a,this.drilldown.game=null,this.drilldown.season.weeks.select(a),i(!0,!0),impakt.context.Actionable.selected.only(a),d.transitionTo("season.drilldown.week")},this.toGameDrilldown=function(a){this.drilldown.game=a,impakt.context.Season.games.select(a),i(!0,!1),impakt.context.Actionable.selected.only(a),d.transitionTo("season.drilldown.game")}}]),impakt.sidebar=angular.module("impakt.sidebar",["impakt.playbook.sidebar"]).config(["$stateProvider",function(a){console.debug("impakt.sidebar - config")}]).run([function(){console.debug("impakt.sidebar - run")}]),impakt.sidebar.controller("sidebar.ctrl",["$scope",function(a){}]),impakt.team=angular.module("impakt.team",["impakt.team.personnel","impakt.team.main","impakt.team.unitTypes","impakt.team.modals"]).config([function(){console.debug("impakt.team - config")}]).run(function(){console.debug("impakt.team - run")}),impakt.team.main=angular.module("impakt.team.main",[]).config([function(){console.debug("impakt.team.main - config")}]).run(function(){console.debug("impakt.team.main - run")}),impakt.team.main.controller("team.main.ctrl",["$scope","_team","_teamModals",function(a,b,c){a.createTeam=function(){c.createTeam()}}]),impakt.team.modals=angular.module("impakt.team.modals",[]).config(function(){console.debug("impakt.team.modals - config")}).run(function(){console.debug("impakt.team.modals - run")}),impakt.team.modals.controller("team.modals.createTeamDuplicateError.ctrl",["$scope","$uibModalInstance","_team","team",function(a,b,c,d){a.team=d,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}]),impakt.team.modals.controller("team.modals.createTeam.ctrl",["$scope","$uibModalInstance","_associations","_team","_leagueModals","division",function(a,b,c,d,e,f){function g(){a.selectDivision(),a.selectLocation()}a.newTeamModel=new Team.Models.TeamModel,a.teamTypes=Common.Utilities.convertEnumToList(Team.Enums.TeamTypes),a.divisions=impakt.context.League.divisions,a.locations=impakt.context.League.locations,a.selectedDivision=f?f:a.divisions.first(),a.selectedLocation=a.locations.first(),a.selectDivision=function(){Common.Utilities.isNotNullOrUndefined(a.selectedDivision)&&a.newTeamModel.setDivision(a.selectedDivision)},a.selectLocation=function(){Common.Utilities.isNotNullOrUndefined(a.selectedLocation)&&a.newTeamModel.setLocation(a.selectedLocation)},a.createLocation=function(){e.createLocation().then(function(b){a.locations=impakt.context.League.locations,a.selectedLocation=b,a.setLocation()})},a.ok=function(){d.createTeam(a.newTeamModel).then(function(d){var e=[a.selectedDivision,a.selectedLocation];Common.Utilities.isNotNullOrUndefined(a.selectedDivision.conference)&&e.push(a.selectedDivision.conference),Common.Utilities.isNotNullOrUndefined(a.selectedDivision.conference.league)&&e.push(a.selectedDivision.conference.league),c.createAssociations(d,e),b.close(d)},function(a){b.close(a)})},a.cancel=function(){b.dismiss()},g()}]),impakt.team.modals.controller("team.modals.deleteTeam.ctrl",["$scope","$rootScope","$uibModalInstance","_team","_league","team",function(a,b,c,d,e,f){a.team=f,a.ok=function(){d.deleteTeam(a.team).then(function(d){b.$broadcast("delete-team",a.team),c.close(d)},function(a){c.close(a)})},a.cancel=function(){c.dismiss()}}]),impakt.team.modals.service("_teamModals",["$q","__modals",function(a,b){this.createTeam=function(c){var d=a.defer(),e=b.open("","modules/team/modals/create-team/create-team.tpl.html","team.modals.createTeam.ctrl",{division:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.createTeamDuplicate=function(c){var d=a.defer(),e=b.open("","modules/team/modals/create-team-duplicate-error/create-team-duplicate-error.tpl.html","team.modals.createTeamDuplicateError.ctrl",{team:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise},this.deleteTeam=function(c){var d=a.defer(),e=b.open("","modules/team/modals/delete-team/delete-team.tpl.html","team.modals.deleteTeam.ctrl",{team:function(){return c}});return e.result.then(function(a){console.log(a),d.resolve()},function(a){console.log("dismissed"),d.reject()}),d.promise}}]),impakt.team.personnel=angular.module("impakt.team.personnel",["impakt.team.personnel.create"]).config([function(){console.debug("impakt.team.create -- config")}]).run([function(){console.debug("impakt.team.create -- run")}]),impakt.team.personnel.create=angular.module("impakt.team.personnel.create",[]).config([function(){console.debug("impakt.team.create -- config")}]).run([function(){console.debug("impakt.team.create -- run")}]),impakt.team.personnel.create.controller("impakt.team.personnel.create.ctrl",["$scope","_team",function(a,b){console.debug("impakt.team.personnel.create.ctrl")}]),impakt.team.personnel.controller("impakt.team.personnel.ctrl",["$scope","_team",function(a,b){function c(){b.initialize(),a.personnelCollection=b.personnel,a.personnel=b.personnel.getOne()||new Team.Models.Personnel(Team.Enums.UnitTypes.Other),a.selectedPersonnel={guid:a.personnel.guid,unitType:a.personnel.unitType.toString()},a.positionOptions=d.getByUnitType(a.personnel.unitType)}console.debug("impakt.team.personnel.ctrl"),a.personnelCollection,a.personnel,a.selectedPersonnel,a.unitTypes=Team.Models.UnitType.getUnitTypes();var d=new Team.Models.PositionDefault;a.positionOptions,a.createNew=!1,a.creating=!1,a.cancelCreate=function(){a.creating=!1},a.createPersonnel=function(){a.personnel=new Team.Models.Personnel(Team.Enums.UnitTypes.Other),a.creating=!0,a.selectedPersonnel.unitType=a.personnel.unitType,a.createNew=!0},a.selectPersonnel=function(){a.createNew=!1,console.log(a.selectedPersonnel.guid),a.selectedPersonnel.guid&&(a.personnel=null,a.personnel=a.personnelCollection.get(a.selectedPersonnel.guid),a.selectedPersonnel.unitType=a.personnel.unitType.toString(),a.positionOptions=d.getByUnitType(a.personnel.unitType))},a.selectUnitType=function(){a.personnel.setUnitType(parseInt(a.selectedPersonnel.unitType)),a.positionOptions=d.getByUnitType(a.personnel.unitType)},a.update=function(b,c){var d=impakt.context.Team.positionDefaults.switchPosition(b,b.positionListValue);console.log(b,d),a.personnel.positions.replace(b.guid,d)},a.save=function(){console.log(a.personnel),b.savePersonnel(a.personnel,a.createNew).then(function(a){console.log(a)},function(a){console.error(a)})},a.deletePersonnel=function(a){console.log("deleting personnel",a),b.deletePersonnel(a).then(function(a){console.log(a)},function(a){console.error(a)})},c()}]),impakt.team.constant("TEAM",{ENDPOINT:"/playbook",CREATE_PERSONNEL:"/createPersonnel",UPDATE_PERSONNEL:"/updatePlay",GET_PERSONNEL:"/getPlay",GET_PERSONNELGROUPS:"/getPlays",DELETE_PERSONNEL:"/deletePlay",CREATE_SET:"/createSet",GET_SETS:"/getSets",UPDATE_SET:"/updateSet",DELETE_SET:"/deleteSet"}),impakt.team.controller("team.ctrl",["$scope","_team",function(a,b){a.title="Team Management",a.tabs={personnel:{title:"Personnel groups",active:!0,src:"modules/team/personnel/team-personnel.tpl.html"},teams:{title:"My teams",active:!1,src:"modules/team/main/team-main.tpl.html"},unitTypes:{title:"Unit types",active:!1,src:"modules/team/unit-types/team-unit-types.tpl.html"}},a.activate=function(b){for(var c in a.tabs){var d=a.tabs[c];d.active&&(d.active=!1)}b.active=!0}}]),impakt.team.service("_team",["$rootScope","$q","PLAYBOOK","TEAM","LEAGUE","__api","__notifications","_teamModals",function(a,b,c,d,e,f,g,h){this.personnel=null,this.initialize=function(){this.personnel=impakt.context.Team.personnel},this.getTeams=function(){var a=b.defer(),c=g.pending("Getting all league teams...");return f.get(f.path(e.ENDPOINT,e.GET_TEAMS)).then(function(b){var d=new Team.Models.TeamModelCollection;if(b&&b.data&&b.data.results)for(var e=Common.Utilities.parseData(b.data.results),f=0;f<e.length;f++){var g=e[f];if(g&&g.data&&g.data.model){var h=new Team.Models.TeamModel;g.data.model.key=g.key,h.fromJson(g.data.model),d.add(h,!1)}}c.success([d.size()," league teams successfully retreived"].join("")),a.resolve(d)},function(b){c.error("Failed to retieve league teams"),console.error(b),a.reject(b)}),a.promise},this.getTeam=function(a){var c=b.defer();return f.get(f.path(e.ENDPOINT,e.GET_TEAM,"/"+a)).then(function(a){var b=Common.Utilities.parseData(a.data.results);c.resolve(b)},function(a){c.reject(a)}),c.promise},this.createTeam=function(c){var d=b.defer();if(Common.Utilities.isNotNullOrUndefined(c)){var i=impakt.context.Team.teams.hasElementWhich(function(a,b){return a.name==c.name});if(i){g.warning('Failed to create team. Team "',c.name,'" already exists.');return void h.createTeamDuplicate(c)}}c.key=-1;var j=c.toJson(),k=g.pending('Creating playbook "',c.name,'"...');return f.post(f.path(e.ENDPOINT,e.CREATE_TEAM),{version:1,name:c.name,data:{version:1,model:j}}).then(function(b){var c=Common.Utilities.parseData(b.data.results),e=new Team.Models.TeamModel;if(!(c&&c.data&&c.data.model))throw new Error("CreateTeam did not return a valid team model");c.data.model.key=c.key,e.fromJson(c.data.model),impakt.context.Team.teams.add(e,!1),k.success('Successfully created team "',e.name,'"'),a.$broadcast("create-entity",e),d.resolve(e)},function(a){k.error('Failed to create team "',c.name,'"'),d.reject(a)}),d.promise},this.deleteTeam=function(a){var c=b.defer(),d=g.pending('Deleting team "',a.name,'"...');return f.post(f.path(e.ENDPOINT,e.DELETE_TEAM),{key:a.key}).then(function(b){impakt.context.Team.teams.remove(a.guid),d.success('Deleted team "',a.name,'"'),c.resolve(a)},function(b){d.error('Failed to delete team "',a.name,'"'),c.reject(b)}),c.promise},this.updateTeam=function(a){var c=b.defer(),d=a.toJson(),h=g.pending('Updating team "',a.name,'"...');return f.post(f.path(e.ENDPOINT,e.UPDATE_TEAM),{version:1,
name:d.name,key:d.key,data:{version:1,key:d.key,model:d}}).then(function(b){var d=Common.Utilities.parseData(b.data.results),e=new Team.Models.TeamModel;d&&d.data&&d.data.model&&(e.fromJson(d.data.model),impakt.context.Team.teams.set(e.guid,e)),h.success('Successfully updated team "',a.name,'"'),c.resolve(e)},function(b){h.error('Failed to update team "',a.name,'"'),c.reject(b)}),c.promise},this.getPersonnel=function(){var a=b.defer(),c=g.pending("Getting Personnel...");return f.get(f.path(d.ENDPOINT,d.GET_SETS)).then(function(b){for(var d=Common.Utilities.parseData(b.data.results),e=new Team.Models.PersonnelCollection(Team.Enums.UnitTypes.Mixed),f=0;f<d.length;f++){var g=d[f];if(g&&g.data&&g.data.personnel){var h=g.data.personnel;h.key=g.key;var i=new Team.Models.Personnel(Team.Enums.UnitTypes.Other);i.fromJson(h),e.add(i,!1)}}c.success(e.size()," Personnel groups successfully retrieved"),a.resolve(e)},function(b){c.error("Failed to retrieve Personnel groups"),a.reject(b)}),a.promise},this.savePersonnel=function(a,c){var d,e=b.defer(),f=g.pending('Saving personnel "',a.name,'"...');return c?(a.key=0,a.guid=Common.Utilities.guid(),d=this.createPersonnel(a)):d=this.updatePersonnel(a),d.then(function(b){f.success('Successfully saved personnel "',a.name,'"'),e.resolve(b)},function(b){f.error('Failed to save personnel "',a.name,'"'),e.reject(b)}),e.promise},this.createPersonnel=function(c){var e=b.defer(),h=c.toJson(),i=g.pending('Creating personnel group "',c.name,'"...');return f.post(f.path(d.ENDPOINT,d.CREATE_SET),{version:1,ownerRK:1,parentRK:1,name:h.name,data:{setType:Common.Enums.SetTypes.Personnel,personnel:h,name:h.name,version:1,ownerRK:1,parentRK:1}}).then(function(b){var c=Common.Utilities.parseData(b.data.results),d=new Team.Models.Personnel(Team.Enums.UnitTypes.Other);c&&c.data&&c.data.personnel&&(c.data.personnel.key=c.key,d.fromJson(c.data.personnel)),impakt.context.Team.personnel.add(d,!1),i.success('Personnel group "',d.name,'" successfully created'),a.$broadcast("create-entity",d),e.resolve(d)},function(a){e.reject(a)}),e.promise},this.updatePersonnel=function(a){var c=b.defer(),e=a.toJson(),h=g.pending('Updating personnel "',a.name,'"...');return f.post(f.path(d.ENDPOINT,d.UPDATE_SET),{version:1,name:e.name,key:e.key,data:{setType:Common.Enums.SetTypes.Personnel,personnel:e,name:e.name,key:e.key,version:1}}).then(function(a){var b=Common.Utilities.parseData(a.data.results),d=new Team.Models.Personnel(Team.Enums.UnitTypes.Other);b&&b.data&&b.data.personnel&&d.fromJson(b.data.personnel),impakt.context.Team.personnel.set(d.guid,d),h.success('Successfully updated personnel "',d.name,'"...'),c.resolve(d)},function(b){h.error('Failed to update personnel "',a.name,'"...'),c.reject(b)}),c.promise},this.deletePersonnel=function(a){var c=b.defer(),e=g.pending('Deleting personnel "',a.name,'"...');return f.post(f.path(d.ENDPOINT,d.DELETE_SET),{key:a.key}).then(function(b){impakt.context.Team.personnel.remove(a.guid),e.success('Successfully saved personnel "',a.name,'"'),c.resolve(b)},function(b){e.error('Failed to save personnel "',a.name,'"'),c.reject(b)}),c.promise},this.deleteEntityByType=function(a){if(!Common.Utilities.isNullOrUndefined(a)){var c=b.defer();switch(a.impaktDataType){case Common.Enums.ImpaktDataTypes.Team:return h.deleteTeam(a);case Common.Enums.ImpaktDataTypes.PersonnelGroup:c.reject(new Error("_team deleteEntityByType(): _teamModals.deletePersonnel() not implemented"));break;default:c.reject(new Error("_team deleteEntityByType: impaktDataType not supported"))}return c.promise()}},this.updateEntityByType=function(a){if(!Common.Utilities.isNullOrUndefined(a)){var c=b.defer();switch(a.impaktDataType){case Common.Enums.ImpaktDataTypes.Team:return h.saveTeam(a);case Common.Enums.ImpaktDataTypes.PersonnelGroup:return h.savePersonnel(a);default:c.reject(new Error("_team updateEntityByType: impaktDataType not supported"))}return c.promise()}},this.createPrimaryTeam=function(a){},this.updatePrimaryTeam=function(a){},this.deletePrimaryTeam=function(a){},this.savePrimaryTeam=function(a){}}]),impakt.team.unitTypes=angular.module("impakt.team.unitTypes",[]).config([function(){console.debug("impakt.team.unitTypes - config")}]).run([function(){console.debug("impakt.team.unitTypes - run")}]),impakt.team.unitTypes.controller("impakt.team.unitTypes.ctrl",["$scope","_team",function(a,b){a.unitTypes=impakt.context.Team.unitTypes.toArray()}]),impakt.user=angular.module("impakt.user",["impakt.user.login","impakt.user.modals"]).config(function(){console.debug("impakt.user -- config")}).run(function(){console.debug("impakt.user -- run")}),impakt.user.login=angular.module("impakt.user.login",[]).config(function(){console.debug("impakt.user.login - config")}).run(function(){console.debug("impakt.user.login - run")}),impakt.user.login.controller("user.login.ctrl",["$scope",function(a){}]),impakt.user.modals=angular.module("impakt.user.modals",[]).config(function(){console.debug("impakt.user.modals - config")}).run(function(){console.debug("impakt.user.modals - run")}),impakt.user.modals.controller("user.modals.selectOrganization.ctrl",["$scope","$uibModalInstance","_user",function(a,b,c){a.selectedOrganization=c.selectedOrganization,a.organizations=c.organizations,a.organizationSelected=function(){console.log("selected organization",a.selectedOrganization)},a.ok=function(){c.selectOrganization(a.selectedOrganization).then(function(a){b.close(a)},function(a){b.close(a)})},a.cancel=function(){b.dismiss()}}]),impakt.user.modals.service("_userModals",["__modals",function(a){this.selectOrganization=function(){var b=a.open("","modules/user/modals/select-organization/select-organization.tpl.html","user.modals.selectOrganization.ctrl",{});b.result.then(function(a){console.log(a)},function(a){console.log("dismissed")})}}]);var User;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.toJson=function(){return{Name:this.name,OrganizationKey:this.organizationKey}},b.prototype.fromJson=function(a){this.name=a.name,this.organizationKey=a.organizationKey},b}(Common.Models.Storable);a.Account=b}(b=a.Models||(a.Models={}))}(User||(User={}));var User;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.toJson=function(){return{}},b.prototype.fromJson=function(){},b}(Common.Models.Storable);a.AccountUser=b}(b=a.Models||(a.Models={}))}(User||(User={}));var User;!function(a){var b;!function(a){var b=function(a){function b(){a.call(this),this.firstName=null,this.lastName=null,this.organizationKey=0,this.organizationName=null,this.invitationType=1,this.invitationKey=0,this.email=null,this.recaptchaChallenge="",this.recaptchaResponse=""}return __extends(b,a),b.prototype.toJson=function(){return{FirstName:this.firstName,LastName:this.lastName,OrganizationName:this.organizationName,OrganizationKey:this.organizationKey,InvitationType:this.invitationType,InvitationKey:this.invitationKey,Email:this.email,RecaptchaChallenge:this.recaptchaChallenge,RecaptchaResponse:this.recaptchaResponse}},b.prototype.fromJson=function(a){this.firstName=a.FirstName,this.lastName=a.LastName,this.organizationName=a.OrganizationName,this.email=a.Email},b}(Common.Models.Storable);a.UserModel=b}(b=a.Models||(a.Models={}))}(User||(User={})),impakt.user.constant("USER",{ORG_ENDPOINT:"/accounts",GET_ORGANIZATIONS:"/getOrganizations"}),impakt.user.controller("impakt.user.ctrl",["$scope","$http","$window","__signin","_user",function(a,b,c,d,e){a.userName=e.userName,a.organizationKey=e.organizationKey,a.isOnline=e.isOnline,a.onlineStatus=e.getOnlineStatusString(),a.organizations=e.organizations,a.selectedOrganization=e.selectedOrganization,a.$watch("isOnline",function(b,c){a.onlineStatus=e.getOnlineStatusString()}),a.selectOrganization=function(){e.selectOrganization(a.selectedOrganization)},a.profileClick=function(){},a.logout=function(){confirm("Are you sure you want to logout? You will lose any unsaved data.")&&d.logout()}}]),impakt.user.service("_user",["USER","$window","$q","__context","__api","__notifications","__localStorage","_userModals",function(a,b,c,d,e,f,g,h){this.userName=g.getUserName(),this.organizationKey=g.getOrganizationKey(),this.organizations=new User.Models.OrganizationCollection,this.selectedOrganization=null,this.isOnline=navigator?navigator.onLine:void 0;var i=this;this.initialize=function(){var a=c.defer(),b=f.pending("Looking for default user organization..."),d=g.getOrganizationKey();return i.getOrganizations().then(function(c){if(c&&c.hasElements()&&d&&d>0){var e=c.filterFirst(function(a,b){return a.organizationKey==d});i.selectOrganization(e),b.success("Default user organization #",d," is set"),a.resolve(i.selectedOrganization)}else b.warning("Default organization not found. Please select 					an organization from the Profile area."),h.selectOrganization(),a.resolve(null)},function(c){b.error("Failed to set default organization #",d),a.reject(c)}),a.promise},b.addEventListener("offline",function(a){console.log("offline"),i.isOnline=!1}),b.addEventListener("online",function(a){console.log("online"),i.isOnline=!0}),this.selectOrganization=function(a){var b=c.defer(),e=f.pending("Updating application context data...");if(!a){var h="Something went wrong while attempting to select the organization";e.error(h),b.reject(h)}return this.selectedOrganization=a,impakt.context.Organization.current=a,g.setOrganizationKey(a.organizationKey),d.initialize(impakt.context).then(function(a){e.success("Successfully updated the application context data"),b.resolve(i.selectedOrganization)},function(a){e.error("Failed to update the application context data"),b.reject(a)}),b.promise},this.getOnlineStatusString=function(){return this.isOnline===!0?"online":this.isOnline===!1?"offline":"unknown"},this.getOrganizations=function(){var b=c.defer(),d=f.pending("Retrieving Organizations...");return e.get(e.path(a.ORG_ENDPOINT,a.GET_ORGANIZATIONS)).then(function(a){if(a&&a.data&&a.data.results)for(var c=a.data.results,e=0;e<c.length;e++){var f=a.data.results[e];if(f){var g=new User.Models.Organization;g.fromJson(f),i.organizations.add(g,!1)}}d.success(i.organizations.size()," Organizations successfully retrieved"),b.resolve(i.organizations)},function(a){d.error("Failed to retrieve Organizations"),b.reject(a)}),b.promise}}]);
//# sourceMappingURL=impakt.js.map